import{r as B,j as s,l as R,a8 as ge,G as Qe,D as We,f as Ze,g as ea,h as aa,i as sa,a9 as ae,aa as se,e as ia,k as ta,y as S}from"./index-B0KDE8pz.js";import{P as ra}from"./progress-BDUzr-gD.js";import{utils as i,writeFile as Ae,read as na}from"./xlsx-D_0l8YDs.js";import{F as la}from"./file-spreadsheet-CfN0RQj_.js";import{C as oa}from"./circle-alert-BColZMCl.js";import{C as ca}from"./circle-x-CYTj_F-g.js";function ga({customers:ye,bankPFRecords:E,payterProducts:fe,mccList:Se,banks:xe,epkList:be,okList:_e,salesReps:ie,jobTitles:De,partnerships:Ke,sharings:je,kartProgramlar:we,hesapKalemleri:Pe,sabitKomisyonlar:ve,ekGelirler:Me,onCustomersChange:Te,onBankPFRecordsChange:Be,onPayterProductsChange:Ee,onMCCListChange:Ce,onBanksChange:Fe,onEPKListChange:Ne,onOKListChange:$e,onSalesRepsChange:Ge,onJobTitlesChange:Oe,onPartnershipsChange:He,onSharingsChange:ze,onKartProgramlarChange:Ie,onHesapKalemleriChange:Re,onSabitKomisyonlarChange:Ve,onEkGelirlerChange:Ye}){const[Le,te]=B.useState(!1),[V,Y]=B.useState(!1),[re,x]=B.useState(0),[c,C]=B.useState(null),L=B.useRef(null),Ue=()=>{try{const r=i.book_new(),m=ye.map(e=>{var D,K,j,w,P,v,M,T,ce,me,de,ue,he,ke;const o=((D=e.linkedBankPFIds)==null?void 0:D.map(ee=>{const pe=E.find(qe=>qe.id===ee);return pe?pe.firmaUnvan:""}).filter(ee=>ee).join(", "))||"";return{"Cari Hesap Kodu":e.cariHesapKodu,SektÃ¶r:e.sektor,MCC:e.mcc,"Cari AdÄ±":e.cariAdi,"GÃ¼ncel MyPayter Domain":e.guncelMyPayterDomain,"Vergi Dairesi":e.vergiDairesi,"Vergi No":e.vergiNo,Adres:e.adres,Ä°lÃ§e:e.ilce,"Posta Kodu":e.postaKodu,Email:e.email,Yetkili:e.yetkili,Telefon:e.tel,P6X:e.p6x||"",APOLLO:e.apollo||"",Durum:e.durum,"SatÄ±ÅŸ Temsilcisi":e.salesRepName||"","BaÄŸlÄ± Banka/PF SayÄ±sÄ±":((K=e.linkedBankPFIds)==null?void 0:K.length)||0,"BaÄŸlÄ± Banka/PF AdlarÄ±":o,"Bloke Durumu":e.blokeDurumu?"Evet":"HayÄ±r","Sorumlu KiÅŸi":e.sorumluKisi||"","Cari Grubu":e.cariGrubu||"","Abonelik Tipi":((j=e.serviceFeeSettings)==null?void 0:j.paymentType)==="monthly"?"AylÄ±k":((w=e.serviceFeeSettings)==null?void 0:w.paymentType)==="yearly"?"YÄ±llÄ±k":"","Standart Ãœcret (â‚¬)":((P=e.serviceFeeSettings)==null?void 0:P.standardFeePerDevice)||"","Ã–zel Ãœcret (â‚¬)":((v=e.serviceFeeSettings)==null?void 0:v.customFeePerDevice)||"","SÃ¶zleÅŸme BaÅŸlangÄ±Ã§":((M=e.serviceFeeSettings)==null?void 0:M.contractStartDate)||"","Hizmet Aktif":(T=e.serviceFeeSettings)!=null&&T.isActive?"Evet":"HayÄ±r","Dondurma Tarihi":((ce=e.serviceFeeSettings)==null?void 0:ce.suspensionStartDate)||"","Dondurma Sebebi":((me=e.serviceFeeSettings)==null?void 0:me.suspensionReason)||"","Cihaz Abonelikleri SayÄ±sÄ±":((ue=(de=e.serviceFeeSettings)==null?void 0:de.deviceSubscriptions)==null?void 0:ue.length)||0,"Fatura SayÄ±sÄ±":((ke=(he=e.serviceFeeSettings)==null?void 0:he.invoices)==null?void 0:ke.length)||0}}),A=i.json_to_sheet(m);A["!cols"]=[{wch:18},{wch:15},{wch:8},{wch:30},{wch:30},{wch:15},{wch:12},{wch:40},{wch:15},{wch:12},{wch:25},{wch:20},{wch:15},{wch:10},{wch:10},{wch:10},{wch:20},{wch:22},{wch:50},{wch:14},{wch:20},{wch:15},{wch:15},{wch:16},{wch:14},{wch:20},{wch:12},{wch:16},{wch:20},{wch:24},{wch:14}],i.book_append_sheet(r,A,"MÃ¼ÅŸteriler");const p=E.map(e=>{var o,D,K,j,w,P,v,M,T;return{"Firma ÃœnvanÄ±":e.firmaUnvan,"Muhasebe Kodu":e.muhasebeKodu,"Banka veya PF":e.bankaOrPF,"Banka/PF AdÄ±":e.bankaPFAd,"Ã–deme KuruluÅŸu Tipi":e.odemeKurulusuTipi||"","Ã–deme KuruluÅŸu AdÄ±":e.odemeKurulusuAd||"","Vergi Dairesi":e.vergiDairesi||"","Vergi No":e.vergiNo||"",Adres:e.adres||"",Telefon:e.telefon||"",Email:e.email||"",Durum:e.durum,"Ä°letiÅŸim KiÅŸi SayÄ±sÄ±":((o=e.iletisimMatrisi)==null?void 0:o.length)||0,"DokÃ¼man SayÄ±sÄ±":((D=e.dokumanlar)==null?void 0:D.length)||0,"Ä°ÅŸbirliÄŸi SayÄ±sÄ±":((K=e.isbirlikleri)==null?void 0:K.length)||0,"TABELA SayÄ±sÄ±":((j=e.tabelaRecords)==null?void 0:j.length)||0,"TABELA Grup SayÄ±sÄ±":((w=e.tabelaGroups)==null?void 0:w.length)||0,"HakediÅŸ KayÄ±t SayÄ±sÄ±":((P=e.hakedisRecords)==null?void 0:P.length)||0,"AnlaÅŸmalÄ± Banka SayÄ±sÄ±":((v=e.agreementBanks)==null?void 0:v.length)||0,"AnlaÅŸmalÄ± EPK SayÄ±sÄ±":((M=e.agreementEPKs)==null?void 0:M.length)||0,"AnlaÅŸmalÄ± Ã–K SayÄ±sÄ±":((T=e.agreementOKs)==null?void 0:T.length)||0}}),y=i.json_to_sheet(p);y["!cols"]=[{wch:35},{wch:16},{wch:14},{wch:25},{wch:20},{wch:25},{wch:15},{wch:12},{wch:40},{wch:15},{wch:25},{wch:10},{wch:20},{wch:16},{wch:16},{wch:14},{wch:18},{wch:18},{wch:20},{wch:18},{wch:16}],i.book_append_sheet(r,y,"Banka-PF Ana Bilgiler");const g=[];if(E.forEach(e=>{e.iletisimMatrisi&&e.iletisimMatrisi.length>0&&e.iletisimMatrisi.forEach(o=>{g.push({"Firma ÃœnvanÄ±":e.firmaUnvan,"AdÄ± SoyadÄ±":o.adiSoyadi,GÃ¶revi:o.gorevi,Telefon:o.tel,GSM:o.gsm,Email:o.mail})})}),g.length>0){const e=i.json_to_sheet(g);e["!cols"]=[{wch:35},{wch:25},{wch:20},{wch:15},{wch:15},{wch:30}],i.book_append_sheet(r,e,"Ä°letiÅŸim Matrisi")}const d=[];if(E.forEach(e=>{e.isbirlikleri&&e.isbirlikleri.length>0&&e.isbirlikleri.forEach(o=>{d.push({"Firma ÃœnvanÄ±":e.firmaUnvan,"SÄ±ra No":o.siraNo,"BaÅŸlangÄ±Ã§ Tarihi":o.baslangicTarihi,"BitiÅŸ Tarihi":o.bitisTarihi||"SÃ¼resiz","Gelir Modeli":o.gelirModeli||"","Hesap Kalemi Kodu":o.hesapKalemiKod||"",Durum:o.durum})})}),d.length>0){const e=i.json_to_sheet(d);e["!cols"]=[{wch:35},{wch:10},{wch:18},{wch:18},{wch:20},{wch:20},{wch:10}],i.book_append_sheet(r,e,"Ä°ÅŸbirlikleri")}const u=fe.map(e=>({"Serial number":e.serialNumber,Name:e.name||"",TID:e.tid||"",Domain:e.domain||"",Firmware:e.firmware||"","SAM 1":e.sam1||"","SAM 2":e.sam2||"","SAM 3":e.sam3||"",SIM:e.sim||"","Terminal type":e.terminalType||"","Online status":e.onlineStatus||"","Sync status":e.syncStatus||"","Terminal model":e.terminalModel||"","MAC address":e.macAddress||"",PTID:e.ptid||""})),f=i.json_to_sheet(u);f["!cols"]=[{wch:20},{wch:25},{wch:15},{wch:30},{wch:15},{wch:15},{wch:15},{wch:15},{wch:15},{wch:18},{wch:15},{wch:15},{wch:18},{wch:18},{wch:15}],i.book_append_sheet(r,f,"Payter ÃœrÃ¼nleri");const k=Se.map(e=>({"MCC Kodu":e.kod,Kategori:e.kategori})),b=i.json_to_sheet(k);b["!cols"]=[{wch:12},{wch:40}],i.book_append_sheet(r,b,"MCC TanÄ±mlarÄ±");const l=xe.map(e=>({Kod:e.kod,"Banka AdÄ±":e.bankaAdi,AÃ§Ä±klama:e.aciklama||"",Durum:e.aktif?"Aktif":"Pasif"})),n=i.json_to_sheet(l);n["!cols"]=[{wch:12},{wch:35},{wch:40},{wch:10}],i.book_append_sheet(r,n,"Bankalar");const t=be.map(e=>({Kod:e.kod,"Kurum AdÄ±":e.kurumAdi,AÃ§Ä±klama:e.aciklama||"",Durum:e.aktif?"Aktif":"Pasif"})),a=i.json_to_sheet(t);a["!cols"]=[{wch:12},{wch:35},{wch:40},{wch:10}],i.book_append_sheet(r,a,"EPK");const h=_e.map(e=>({Kod:e.kod,"Kurum AdÄ±":e.kurumAdi,AÃ§Ä±klama:e.aciklama||"",Durum:e.aktif?"Aktif":"Pasif"})),_=i.json_to_sheet(h);_["!cols"]=[{wch:12},{wch:35},{wch:40},{wch:10}],i.book_append_sheet(r,_,"Ã–K");const U=ie.map(e=>({"Ad Soyad":e.adSoyad,Durum:e.aktif?"Aktif":"Pasif"})),F=i.json_to_sheet(U);F["!cols"]=[{wch:30},{wch:10}],i.book_append_sheet(r,F,"SatÄ±ÅŸ Temsilcileri");const X=De.map(e=>({Ãœnvan:e.unvan,Durum:e.aktif?"Aktif":"Pasif"})),N=i.json_to_sheet(X);N["!cols"]=[{wch:30},{wch:10}],i.book_append_sheet(r,N,"Ãœnvanlar");const J=Ke.map(e=>{var o;return{Kod:e.kod,"Model AdÄ±":e.modelAdi,Oran:e.oran,AÃ§Ä±klama:e.aciklama||"",Durum:e.aktif?"Aktif":"Pasif","OluÅŸturma Tarihi":e.olusturmaTarihi||"","Hesaplama SatÄ±r SayÄ±sÄ±":((o=e.calculationRows)==null?void 0:o.length)||0}}),$=i.json_to_sheet(J);$["!cols"]=[{wch:15},{wch:30},{wch:12},{wch:40},{wch:10},{wch:18},{wch:22}],i.book_append_sheet(r,$,"Partnerlik AnlaÅŸmalarÄ±");const q=Pe.map(e=>({Kod:e.kod,"Hesap Kalemi AdÄ±":e.adi,AÃ§Ä±klama:e.aciklama||"",Durum:e.aktif?"Aktif":"Pasif"})),G=i.json_to_sheet(q);G["!cols"]=[{wch:15},{wch:30},{wch:40},{wch:10}],i.book_append_sheet(r,G,"Hesap Kalemleri");const Q=ve.map(e=>({"Komisyon AdÄ±":e.adi,"Oran (%)":e.oran,AÃ§Ä±klama:e.aciklama||"",Durum:e.aktif?"Aktif":"Pasif"})),O=i.json_to_sheet(Q);O["!cols"]=[{wch:30},{wch:12},{wch:40},{wch:10}],i.book_append_sheet(r,O,"Sabit Komisyonlar");const W=Me.map(e=>({"Gelir AdÄ±":e.adi,Tutar:e.tutar,Birim:e.birim||"EUR",AÃ§Ä±klama:e.aciklama||"",Durum:e.aktif?"Aktif":"Pasif"})),H=i.json_to_sheet(W);H["!cols"]=[{wch:30},{wch:12},{wch:10},{wch:40},{wch:10}],i.book_append_sheet(r,H,"Ek Gelirler");const Z=je.map(e=>({"Gelir Modeli AdÄ±":e.ad,Durum:e.aktif?"Aktif":"Pasif"})),z=i.json_to_sheet(Z);z["!cols"]=[{wch:35},{wch:10}],i.book_append_sheet(r,z,"Gelir Modelleri");const I=we.map(e=>({"Kart ProgramÄ± AdÄ±":e.kartAdi,AÃ§Ä±klama:e.aciklama||"",Durum:e.aktif?"Aktif":"Pasif"})),le=i.json_to_sheet(I);le["!cols"]=[{wch:35},{wch:40},{wch:10}],i.book_append_sheet(r,le,"Kart ProgramlarÄ±");const oe=`Yonetim_Sistemi_Yedek_${new Date().toISOString().split("T")[0]}.xlsx`;Ae(r,oe),S.success(`TÃ¼m veriler Excel'e aktarÄ±ldÄ±: ${oe}`,{description:`${r.SheetNames.length} sayfa iÃ§eren dosya oluÅŸturuldu`,duration:5e3})}catch(r){console.error("Excel export hatasÄ±:",r),S.error("Excel dosyasÄ± oluÅŸturulurken bir hata oluÅŸtu!")}},Xe=async r=>{var A;const m=(A=r.target.files)==null?void 0:A[0];if(m){Y(!0),x(10),C(null);try{const p=await m.arrayBuffer();x(30);const y=na(p);x(50);const g={};let d=0,u=0;const f=[];y.SheetNames.forEach(k=>{const b=y.Sheets[k],l=i.sheet_to_json(b),n={success:0,failed:0,errors:[]};try{switch(k){case"MÃ¼ÅŸteriler":{const t=l.map(a=>{const h=ie.find(_=>_.adSoyad===a["SatÄ±ÅŸ Temsilcisi"]);return{id:`customer-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,cariHesapKodu:a["Cari Hesap Kodu"]||"",sektor:a.SektÃ¶r||"",mcc:a.MCC||"",cariAdi:a["Cari AdÄ±"]||"",guncelMyPayterDomain:a["GÃ¼ncel MyPayter Domain"]||"",vergiDairesi:a["Vergi Dairesi"]||"",vergiNo:a["Vergi No"]||"",adres:a.Adres||"",ilce:a.Ä°lÃ§e||"",postaKodu:a["Posta Kodu"]||"",email:a.Email||"",yetkili:a.Yetkili||"",tel:a.Telefon||"",p6x:a.P6X||"",apollo:a.APOLLO||"",durum:a.Durum||"Aktif",salesRepId:(h==null?void 0:h.id)||"",salesRepName:(h==null?void 0:h.adSoyad)||"",linkedBankPFIds:[],blokeDurumu:a["Bloke Durumu"]==="Evet",sorumluKisi:a["Sorumlu KiÅŸi"]||"",cariGrubu:a["Cari Grubu"]||"",serviceFeeSettings:{paymentType:a["Abonelik Tipi"]==="AylÄ±k"?"monthly":a["Abonelik Tipi"]==="YÄ±llÄ±k"?"yearly":"monthly",standardFeePerDevice:Number(a["Standart Ãœcret (â‚¬)"])||0,customFeePerDevice:a["Ã–zel Ãœcret (â‚¬)"]?Number(a["Ã–zel Ãœcret (â‚¬)"]):void 0,contractStartDate:a["SÃ¶zleÅŸme BaÅŸlangÄ±Ã§"]||"",isActive:a["Hizmet Aktif"]==="Evet",suspensionStartDate:a["Dondurma Tarihi"]||void 0,suspensionReason:a["Dondurma Sebebi"]||void 0,deviceSubscriptions:[],invoices:[]}}});Te(t),n.success=t.length}break;case"Banka-PF Ana Bilgiler":{const t=l.map(a=>({id:`bankpf-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,firmaUnvan:a["Firma ÃœnvanÄ±"]||"",muhasebeKodu:a["Muhasebe Kodu"]||"",bankaOrPF:a["Banka veya PF"]||"Banka",bankaPFAd:a["Banka/PF AdÄ±"]||"",odemeKurulusuTipi:a["Ã–deme KuruluÅŸu Tipi"]||"",odemeKurulusuAd:a["Ã–deme KuruluÅŸu AdÄ±"]||"",vergiDairesi:a["Vergi Dairesi"]||"",vergiNo:a["Vergi No"]||"",adres:a.Adres||"",telefon:a.Telefon||"",email:a.Email||"",durum:a.Durum||"Aktif",iletisimMatrisi:[],dokumanlar:[],isbirlikleri:[],tabelaRecords:[],tabelaGroups:[],hakedisRecords:[],agreementBanks:[],agreementEPKs:[],agreementOKs:[]}));Be(t),n.success=t.length}break;case"Payter ÃœrÃ¼nleri":{const t=l.map(a=>({id:`product-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,serialNumber:a["Serial number"]||"",name:a.Name||"",tid:a.TID||"",domain:a.Domain||"",firmware:a.Firmware||"",sam1:a["SAM 1"]||"",sam2:a["SAM 2"]||"",sam3:a["SAM 3"]||"",sim:a.SIM||"",terminalType:a["Terminal type"]||"",onlineStatus:a["Online status"]||"",syncStatus:a["Sync status"]||"",terminalModel:a["Terminal model"]||"",macAddress:a["MAC address"]||"",ptid:a.PTID||""}));Ee(t),n.success=t.length}break;case"MCC TanÄ±mlarÄ±":{const t=l.map(a=>({kod:a["MCC Kodu"]||"",kategori:a.Kategori||""}));Ce(t),n.success=t.length}break;case"Bankalar":{const t=l.map(a=>({id:`bank-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,kod:a.Kod||"",bankaAdi:a["Banka AdÄ±"]||"",aciklama:a.AÃ§Ä±klama||"",aktif:a.Durum==="Aktif"}));Fe(t),n.success=t.length}break;case"EPK":{const t=l.map(a=>({id:`epk-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,kod:a.Kod||"",kurumAdi:a["Kurum AdÄ±"]||"",aciklama:a.AÃ§Ä±klama||"",aktif:a.Durum==="Aktif"}));Ne(t),n.success=t.length}break;case"Ã–K":{const t=l.map(a=>({id:`ok-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,kod:a.Kod||"",kurumAdi:a["Kurum AdÄ±"]||"",aciklama:a.AÃ§Ä±klama||"",aktif:a.Durum==="Aktif"}));$e(t),n.success=t.length}break;case"SatÄ±ÅŸ Temsilcileri":{const t=l.map(a=>({id:`salesrep-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,adSoyad:a["Ad Soyad"]||"",aktif:a.Durum==="Aktif"}));Ge(t),n.success=t.length}break;case"Ãœnvanlar":{const t=l.map(a=>({id:`title-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,unvan:a.Ãœnvan||"",aktif:a.Durum==="Aktif"}));Oe(t),n.success=t.length}break;case"Partnerlik AnlaÅŸmalarÄ±":{const t=l.map(a=>({id:`partnership-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,kod:a.Kod||"",modelAdi:a["Model AdÄ±"]||"",oran:a.Oran||"",aciklama:a.AÃ§Ä±klama||"",aktif:a.Durum==="Aktif",olusturmaTarihi:a["OluÅŸturma Tarihi"]||new Date().toISOString().split("T")[0],calculationRows:[]}));He(t),n.success=t.length}break;case"Hesap Kalemleri":{const t=l.map(a=>({id:`hk-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,kod:a.Kod||"",adi:a["Hesap Kalemi AdÄ±"]||"",aciklama:a.AÃ§Ä±klama||"",aktif:a.Durum==="Aktif"}));Re(t),n.success=t.length}break;case"Sabit Komisyonlar":{const t=l.map(a=>({id:`sk-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,adi:a["Komisyon AdÄ±"]||"",oran:Number(a["Oran (%)"])||0,aciklama:a.AÃ§Ä±klama||"",aktif:a.Durum==="Aktif"}));Ve(t),n.success=t.length}break;case"Ek Gelirler":{const t=l.map(a=>({id:`eg-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,adi:a["Gelir AdÄ±"]||"",tutar:Number(a.Tutar)||0,birim:a.Birim||"EUR",aciklama:a.AÃ§Ä±klama||"",aktif:a.Durum==="Aktif"}));Ye(t),n.success=t.length}break;case"Gelir Modelleri":{const t=l.map(a=>({id:`sharing-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,ad:a["Gelir Modeli AdÄ±"]||"",aktif:a.Durum==="Aktif"}));ze(t),n.success=t.length}break;case"Kart ProgramlarÄ±":{const t=l.map(a=>({id:`kp-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,kartAdi:a["Kart ProgramÄ± AdÄ±"]||"",aciklama:a.AÃ§Ä±klama||"",aktif:a.Durum==="Aktif",olusturmaTarihi:new Date().toISOString()}));Ie(t),n.success=t.length}break;default:n.errors.push(`Bilinmeyen sayfa: ${k}`),n.failed=l.length}}catch(t){n.errors.push(`${k} iÅŸlenirken hata: ${t instanceof Error?t.message:"Bilinmeyen hata"}`),n.failed=l.length}g[k]=n,d+=n.success,u+=n.failed,f.push(...n.errors)}),x(90),C({success:d,failed:u,errors:f,sheetResults:g}),x(100),d>0?S.success("Import tamamlandÄ±!",{description:`${d} kayÄ±t baÅŸarÄ±yla iÃ§e aktarÄ±ldÄ±${u>0?`, ${u} hata`:""}. SayfayÄ± yenilemeden Ã¶nce deÄŸiÅŸiklikleri gÃ¶rebilirsiniz.`,duration:5e3}):u>0&&S.error("Import baÅŸarÄ±sÄ±z!",{description:`${u} kayÄ±t iÃ§e aktarÄ±lamadÄ±. Hata detaylarÄ±nÄ± kontrol edin.`,duration:5e3})}catch(p){C({success:0,failed:1,errors:[`Dosya okuma hatasÄ±: ${p instanceof Error?p.message:"Bilinmeyen hata"}`],sheetResults:{}}),S.error("Excel dosyasÄ± okunamadÄ±!")}finally{Y(!1),L.current&&(L.current.value="")}}},ne=()=>{te(!1),x(0),C(null),Y(!1)},Je=()=>{try{const r=i.book_new(),m=[{"Cari Hesap Kodu":"120.01.001",SektÃ¶r:"Teknoloji",MCC:"5411","Cari AdÄ±":"Ã–rnek Firma A.Åž.","GÃ¼ncel MyPayter Domain":"ornek-firma.mypayter.com","Vergi Dairesi":"Maslak","Vergi No":"1234567890",Adres:"Ã–rnek Mahallesi, No:123",Ä°lÃ§e:"SarÄ±yer","Posta Kodu":"34398",Email:"info@ornekfirma.com",Yetkili:"Ahmet YÄ±lmaz",Telefon:"0532 111 2233",P6X:"10",APOLLO:"5",Durum:"Aktif","SatÄ±ÅŸ Temsilcisi":"Ali Veli","BaÄŸlÄ± Banka/PF SayÄ±sÄ±":"0","BaÄŸlÄ± Banka/PF AdlarÄ±":"","Bloke Durumu":"HayÄ±r","Sorumlu KiÅŸi":"Mehmet Demir","Cari Grubu":"A Grubu","Abonelik Tipi":"AylÄ±k","Standart Ãœcret (â‚¬)":"10","Ã–zel Ãœcret (â‚¬)":"","SÃ¶zleÅŸme BaÅŸlangÄ±Ã§":"2025-01-01","Hizmet Aktif":"Evet","Dondurma Tarihi":"","Dondurma Sebebi":"","Cihaz Abonelikleri SayÄ±sÄ±":"0","Fatura SayÄ±sÄ±":"0"}],A=i.json_to_sheet(m);i.book_append_sheet(r,A,"MÃ¼ÅŸteriler");const p=[{"Firma ÃœnvanÄ±":"Ã–rnek Banka A.Åž.","Muhasebe Kodu":"320.01.001","Banka veya PF":"Banka","Banka/PF AdÄ±":"TÃ¼rkiye Ä°ÅŸ BankasÄ± A.Åž.","Ã–deme KuruluÅŸu Tipi":"EPK","Ã–deme KuruluÅŸu AdÄ±":"Ä°Åž BANKAS","Vergi Dairesi":"Esentepe","Vergi No":"9876543210",Adres:"Ä°stanbul",Telefon:"0212 111 2233",Email:"info@ornekbanka.com",Durum:"Aktif","Ä°letiÅŸim KiÅŸi SayÄ±sÄ±":"0","DokÃ¼man SayÄ±sÄ±":"0","Ä°ÅŸbirliÄŸi SayÄ±sÄ±":"0","TABELA SayÄ±sÄ±":"0","TABELA Grup SayÄ±sÄ±":"0","HakediÅŸ KayÄ±t SayÄ±sÄ±":"0","AnlaÅŸmalÄ± Banka SayÄ±sÄ±":"0","AnlaÅŸmalÄ± EPK SayÄ±sÄ±":"0","AnlaÅŸmalÄ± Ã–K SayÄ±sÄ±":"0"}],y=i.json_to_sheet(p);i.book_append_sheet(r,y,"Banka-PF Ana Bilgiler");const g=[{"Serial Number":"SN001",Domain:"ornek.mypayter.com",Durum:"Aktif"}],d=i.json_to_sheet(g);i.book_append_sheet(r,d,"Payter ÃœrÃ¼nleri");const u=[{"Komisyon AdÄ±":"Ã–rnek Komisyon","Oran (%)":"2.5",AÃ§Ä±klama:"Ã–rnek aÃ§Ä±klama",Durum:"Aktif"}],f=i.json_to_sheet(u);i.book_append_sheet(r,f,"Sabit Komisyonlar");const k=[{"Gelir AdÄ±":"Ã–rnek Ek Gelir",Tutar:"100",Birim:"EUR",AÃ§Ä±klama:"Ã–rnek aÃ§Ä±klama",Durum:"Aktif"}],b=i.json_to_sheet(k);i.book_append_sheet(r,b,"Ek Gelirler");const l=[{"MCC Kodu":"5411",Kategori:"Market ve GÄ±da"}],n=i.json_to_sheet(l);i.book_append_sheet(r,n,"MCC TanÄ±mlarÄ±");const t=[{Kod:"B001","Banka AdÄ±":"Ã–rnek Banka A.Åž.",AÃ§Ä±klama:"Ã–rnek aÃ§Ä±klama",Durum:"Aktif"}],a=i.json_to_sheet(t);i.book_append_sheet(r,a,"Bankalar");const h=[{Kod:"EPK001","Kurum AdÄ±":"Ã–rnek EPK",AÃ§Ä±klama:"Ã–rnek aÃ§Ä±klama",Durum:"Aktif"}],_=i.json_to_sheet(h);i.book_append_sheet(r,_,"EPK");const U=[{Kod:"OK001","Kurum AdÄ±":"Ã–rnek Ã–K",AÃ§Ä±klama:"Ã–rnek aÃ§Ä±klama",Durum:"Aktif"}],F=i.json_to_sheet(U);i.book_append_sheet(r,F,"Ã–K");const X=[{"Ad Soyad":"Ahmet YÄ±lmaz",Durum:"Aktif"}],N=i.json_to_sheet(X);i.book_append_sheet(r,N,"SatÄ±ÅŸ Temsilcileri");const J=[{Ãœnvan:"Genel MÃ¼dÃ¼r",Durum:"Aktif"}],$=i.json_to_sheet(J);i.book_append_sheet(r,$,"Ãœnvanlar");const q=[{Kod:"P001","Model AdÄ±":"Ã–rnek Partnerlik Modeli",Oran:"60/40",AÃ§Ä±klama:"Ã–rnek aÃ§Ä±klama",Durum:"Aktif","OluÅŸturma Tarihi":"2025-01-01","Hesaplama SatÄ±r SayÄ±sÄ±":"0"}],G=i.json_to_sheet(q);i.book_append_sheet(r,G,"Partnerlik AnlaÅŸmalarÄ±");const Q=[{Kod:"HK001","Hesap Kalemi AdÄ±":"Ã–rnek Hesap Kalemi",AÃ§Ä±klama:"Ã–rnek aÃ§Ä±klama",Durum:"Aktif"}],O=i.json_to_sheet(Q);i.book_append_sheet(r,O,"Hesap Kalemleri");const W=[{"Gelir Modeli AdÄ±":"Ã–rnek Gelir Modeli",Durum:"Aktif"}],H=i.json_to_sheet(W);i.book_append_sheet(r,H,"Gelir Modelleri");const Z=[{"Kart ProgramÄ± AdÄ±":"Visa",AÃ§Ä±klama:"Visa kart programÄ±",Durum:"Aktif"}],z=i.json_to_sheet(Z);i.book_append_sheet(r,z,"Kart ProgramlarÄ±");const I="Yonetim_Sistemi_Sablon.xlsx";Ae(r,I),S.success(`Åžablon indirildi: ${I}`)}catch(r){console.error("Åžablon indirme hatasÄ±:",r),S.error("Åžablon oluÅŸturulurken bir hata oluÅŸtu!")}};return s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(R,{onClick:Ue,variant:"outline",className:"flex items-center gap-2 bg-[rgb(255,41,41)]",children:[s.jsx(ge,{size:18}),s.jsx("span",{children:"Excel"})]}),s.jsxs(R,{onClick:()=>te(!0),variant:"outline",className:"flex items-center gap-2 bg-[rgb(61,229,43)]",children:[s.jsx(Qe,{size:18}),s.jsx("span",{children:"Excel"})]}),s.jsx(We,{open:Le,onOpenChange:ne,children:s.jsxs(Ze,{className:"max-w-3xl",children:[s.jsxs(ea,{children:[s.jsx(aa,{children:"Excel'den Toplu Veri YÃ¼kleme"}),s.jsx(sa,{children:"TÃ¼m sistem verilerini iÃ§eren Excel dosyasÄ±nÄ± yÃ¼kleyebilirsiniz."})]}),s.jsxs("div",{className:"space-y-4 py-4",children:[s.jsxs(ae,{children:[s.jsx(la,{className:"h-4 w-4"}),s.jsxs(se,{children:["Excel ÅŸablonunu indirmek iÃ§in:",s.jsx(R,{variant:"link",onClick:Je,className:"h-auto p-0 ml-2",children:"Åžablonu Ä°ndir"})]})]}),s.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg space-y-2",children:[s.jsx("p",{className:"text-sm",children:s.jsx("strong",{children:"Excel DosyasÄ± SayfalarÄ± (17 sayfa):"})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[s.jsxs("ul",{className:"text-sm space-y-1 ml-4 list-disc",children:[s.jsxs("li",{children:[s.jsx("strong",{children:"MÃ¼ÅŸteriler"})," - TÃ¼m alanlar"]}),s.jsx("li",{children:s.jsx("strong",{children:"Banka-PF Ana Bilgiler"})}),s.jsx("li",{children:s.jsx("strong",{children:"Ä°letiÅŸim Matrisi"})}),s.jsx("li",{children:s.jsx("strong",{children:"Ä°ÅŸbirlikleri"})}),s.jsx("li",{children:s.jsx("strong",{children:"Payter ÃœrÃ¼nleri"})}),s.jsx("li",{children:s.jsx("strong",{children:"MCC TanÄ±mlarÄ±"})}),s.jsx("li",{children:s.jsx("strong",{children:"Bankalar"})}),s.jsx("li",{children:s.jsx("strong",{children:"EPK"})})]}),s.jsxs("ul",{className:"text-sm space-y-1 ml-4 list-disc",children:[s.jsx("li",{children:s.jsx("strong",{children:"Ã–K"})}),s.jsx("li",{children:s.jsx("strong",{children:"SatÄ±ÅŸ Temsilcileri"})}),s.jsx("li",{children:s.jsx("strong",{children:"Ãœnvanlar"})}),s.jsx("li",{children:s.jsx("strong",{children:"Partnerlik AnlaÅŸmalarÄ±"})}),s.jsx("li",{children:s.jsx("strong",{children:"Hesap Kalemleri"})}),s.jsx("li",{children:s.jsx("strong",{children:"Sabit Komisyonlar"})}),s.jsx("li",{children:s.jsx("strong",{children:"Ek Gelirler"})}),s.jsx("li",{children:s.jsx("strong",{children:"Gelir Modelleri"})}),s.jsx("li",{children:s.jsx("strong",{children:"Kart ProgramlarÄ±"})})]})]})]}),s.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center",children:[s.jsx("input",{ref:L,type:"file",accept:".xlsx,.xls",onChange:Xe,className:"hidden",id:"excel-data-upload",disabled:V}),s.jsxs("label",{htmlFor:"excel-data-upload",className:`cursor-pointer ${V?"opacity-50 cursor-not-allowed":""}`,children:[s.jsx(ge,{size:48,className:"mx-auto mb-4 text-gray-400"}),s.jsx("p",{className:"mb-2",children:"Excel dosyasÄ±nÄ± sÃ¼rÃ¼kleyin veya tÄ±klayarak seÃ§in"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Desteklenen formatlar: .xlsx, .xls"})]})]}),V&&s.jsxs("div",{className:"space-y-2",children:[s.jsx(ra,{value:re}),s.jsxs("p",{className:"text-sm text-center text-gray-600",children:["Ä°ÅŸleniyor... ",re,"%"]})]}),c&&s.jsxs("div",{className:"space-y-3",children:[s.jsxs(ae,{className:c.failed>0?"bg-yellow-50 border-yellow-300":"bg-green-50 border-green-200",children:[c.failed>0?s.jsx(oa,{className:"h-4 w-4 text-yellow-600"}):s.jsx(ia,{className:"h-4 w-4 text-green-600"}),s.jsx(se,{children:s.jsxs("div",{className:"space-y-2",children:[s.jsx("div",{children:s.jsx("strong",{children:"Ä°mport Ã–zeti:"})}),s.jsxs("div",{children:["âœ… Toplam BaÅŸarÄ±lÄ±: ",c.success," kayÄ±t"]}),c.failed>0&&s.jsxs("div",{children:["âš ï¸ Toplam Hata: ",c.failed," kayÄ±t"]}),Object.keys(c.sheetResults).length>0&&s.jsxs("div",{className:"mt-3 space-y-1",children:[s.jsx("strong",{children:"Sayfa BazlÄ± SonuÃ§lar:"}),Object.entries(c.sheetResults).map(([r,m])=>s.jsxs("div",{className:"text-sm ml-2",children:["ðŸ“„ ",r,": âœ… ",m.success," ",m.failed>0&&`| âš ï¸ ${m.failed} hata`]},r))]})]})})]}),c.errors.length>0&&s.jsxs(ae,{variant:"destructive",children:[s.jsx(ca,{className:"h-4 w-4"}),s.jsxs(se,{children:[s.jsx("strong",{children:"Hatalar:"}),s.jsxs("ul",{className:"mt-2 ml-4 list-disc text-sm max-h-60 overflow-y-auto",children:[c.errors.slice(0,10).map((r,m)=>s.jsx("li",{children:r},m)),c.errors.length>10&&s.jsxs("li",{className:"text-gray-500",children:["... ve ",c.errors.length-10," hata daha"]})]})]})]})]})]}),s.jsx(ta,{children:s.jsx(R,{onClick:ne,variant:"outline",children:"Kapat"})})]})})]})}export{ga as ExcelDataManager};
