import{c as Ra,r as x,j as e,B as c,S as La,t as V,H as sa,J as la,K as ie,M as g,N as ia,O as n,C as se,a as De,b as Oe,l as y,Q as Xa,d as le,ab as rs,s as ua,D as Da,f as Oa,g as wa,h as Sa,i as Ca,L as U,k as Ea,a7 as xs,ac as Ss,a8 as es,G as Ns,x as ms,F as Vs,y as P,a2 as ks,a3 as vs,a4 as bs,ad as Za,P as Bs,R as as,I as oa,V as fs,W as Ts,X as As,Y as Fs,Z as Ks,_ as zs,$ as Ps,a0 as Ls,a5 as Ys,m as Us,n as Xs,o as xa,p as ma,v as Rs}from"./index-B0KDE8pz.js";import{a as Is,P as Ds,b as Os,c as ws,C as ae}from"./ColumnVisibilityDropdown-ByH42Kf_.js";import{F as ns,C as ts}from"./FilterDropdown-bMbRwlaQ.js";import{u as qs,P as Js,A as Ws,a as Qs,b as _s}from"./usePagination-Mp5X40TE.js";import{E as $s}from"./eye-yIxuUw_s.js";import{A as Zs}from"./arrow-up-down-Bmlmjhnz.js";import{S as el}from"./scroll-area-BWfeK-bJ.js";import{C as ss}from"./chevron-down-BiFBo6-a.js";import{S as $a,a as Va,b as Ya,c as Ua,d as ya}from"./select-B7kGhMx-.js";import{C as ds}from"./circle-alert-BColZMCl.js";import{S as cs}from"./save-2XSCaFh2.js";import{C as al}from"./credit-card-B7gn-3C-.js";import{C as js}from"./calculator-DiLoS-ef.js";import{C as Gs}from"./calendar-C6HWCdHQ.js";/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ms=Ra("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sl=Ra("Banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ll=Ra("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hs=Ra("Columns3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const il=Ra("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tl=Ra("Wallet",[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]]),rl=[{key:"muhasebeKodu",label:"Muhasebe Kodu",defaultVisible:!0},{key:"firmaUnvan",label:"Firma Ãœnvan",defaultVisible:!0},{key:"bankaPFAd",label:"Banka/PF AdÄ±",defaultVisible:!0},{key:"tip",label:"Tip",defaultVisible:!0},{key:"kategoriler",label:"Kategoriler",defaultVisible:!0},{key:"odemeKurulusuAd",label:"Ã–deme KuruluÅŸu",defaultVisible:!0},{key:"epkNo",label:"EPK No",defaultVisible:!1},{key:"okNo",label:"Ã–K No",defaultVisible:!1},{key:"durum",label:"Durum",defaultVisible:!0}];function nl({records:w,onSelectRecord:L,banks:oe=[],epkList:Y=[],okList:M=[]}){const[D,A]=x.useState(""),[b,H]=x.useState("all"),[j,v]=x.useState("all"),[T,he]=x.useState("firmaUnvan"),[r,p]=x.useState("asc"),[K,N]=x.useState({}),W=u=>{T===u?p(r==="asc"?"desc":"asc"):(he(u),p("asc"))},X=({field:u})=>T!==u?e.jsx(Zs,{size:14,className:"text-gray-400"}):r==="asc"?e.jsx(Ws,{size:14,className:"text-blue-600"}):e.jsx(Qs,{size:14,className:"text-blue-600"}),C=x.useMemo(()=>w.filter(u=>{const xe=u.firmaUnvan.toLowerCase().includes(D.toLowerCase())||u.muhasebeKodu.toLowerCase().includes(D.toLowerCase())||u.bankaPFAd.toLowerCase().includes(D.toLowerCase())||u.odemeKurulusuAd.toLowerCase().includes(D.toLowerCase()),m=b==="all"||u.bankaOrPF===b,F=j==="all"||u.durum===j;return xe&&m&&F}).sort((u,xe)=>{const m=u[T],F=xe[T];return typeof m=="string"&&typeof F=="string"?r==="asc"?m.localeCompare(F,"tr"):F.localeCompare(m,"tr"):0}),[w,D,b,j,T,r]),{paginatedItems:Z,currentPage:ve,totalPages:J,itemsPerPage:Te,startIndex:ge,endIndex:E,goToPage:O,setItemsPerPage:f}=qs(C,50),l=x.useMemo(()=>[{value:"Banka",label:"Banka",count:w.filter(u=>u.bankaOrPF==="Banka").length},{value:"PF",label:"PF",count:w.filter(u=>u.bankaOrPF==="PF").length}],[w]),d=x.useMemo(()=>[{value:"Aktif",label:"Aktif",count:w.filter(u=>u.durum==="Aktif").length},{value:"Pasif",label:"Pasif",count:w.filter(u=>u.durum==="Pasif").length}],[w]),z=x.useCallback(u=>{N(u)},[]);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[e.jsxs(c,{variant:"secondary",className:"text-sm px-3 py-1",children:["Toplam: ",w.length," kayÄ±t"]}),e.jsxs(c,{variant:"default",className:"text-sm px-3 py-1 bg-blue-600 hover:bg-blue-700",children:["Banka: ",w.filter(u=>u.bankaOrPF==="Banka").length]}),e.jsxs(c,{variant:"default",className:"text-sm px-3 py-1 bg-purple-600 hover:bg-purple-700",children:["PF: ",w.filter(u=>u.bankaOrPF==="PF").length]}),e.jsxs(c,{variant:"default",className:"text-sm px-3 py-1 bg-green-600 hover:bg-green-700",children:["Aktif: ",w.filter(u=>u.durum==="Aktif").length]}),e.jsxs(c,{variant:"outline",className:"text-sm px-3 py-1 border-orange-300 text-orange-700",children:["Pasif: ",w.filter(u=>u.durum==="Pasif").length]}),e.jsxs(c,{variant:"outline",className:"text-sm px-3 py-1 border-indigo-300 text-indigo-700",children:["TABELA: ",w.reduce((u,xe)=>{var m;return u+(((m=xe.tabelaRecords)==null?void 0:m.length)||0)},0)]}),C.length!==w.length&&e.jsxs(c,{variant:"outline",className:"text-sm px-3 py-1 border-blue-300 text-blue-700",children:["FiltrelenmiÅŸ: ",C.length," kayÄ±t"]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(La,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),e.jsx(V,{id:"bankpf-search",type:"text",placeholder:"Ara (Ã¼nvan, banka/PF adÄ±)...",value:D,onChange:u=>A(u.target.value),className:"pl-10"})]}),e.jsx(Is,{columns:rl,storageKey:"bankPFList",onVisibilityChange:z}),e.jsx(ns,{label:"Tip",options:l,value:b,onChange:H,allLabel:"TÃ¼m Tipler",showCount:!0}),e.jsx(ns,{label:"Durum",options:d,value:j,onChange:v,allLabel:"TÃ¼m Durumlar",showCount:!0})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(sa,{children:[e.jsx(la,{children:e.jsxs(ie,{children:[K.muhasebeKodu!==!1&&K.firmaUnvan!==!1&&e.jsx(g,{className:`cursor-pointer hover:bg-gray-100 transition-colors w-[35%] ${T==="firmaUnvan"?"bg-blue-50":""}`,onClick:()=>W("firmaUnvan"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:T==="firmaUnvan"?"text-blue-600":"",children:"Firma ÃœnvanÄ±"}),e.jsx(X,{field:"firmaUnvan"})]})}),K.tip!==!1&&e.jsx(g,{className:`cursor-pointer hover:bg-gray-100 transition-colors w-[15%] ${T==="bankaOrPF"?"bg-blue-50":""}`,onClick:()=>W("bankaOrPF"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:T==="bankaOrPF"?"text-blue-600":"",children:"Banka/PF"}),e.jsx(X,{field:"bankaOrPF"})]})}),K.bankaPFAd!==!1&&e.jsx(g,{className:`cursor-pointer hover:bg-gray-100 transition-colors w-[35%] ${T==="bankaPFAd"?"bg-blue-50":""}`,onClick:()=>W("bankaPFAd"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:T==="bankaPFAd"?"text-blue-600":"",children:"Banka/PF AdÄ±"}),e.jsx(X,{field:"bankaPFAd"})]})}),K.kategoriler!==!1&&e.jsx(g,{className:"w-[30%]",children:"ðŸ·ï¸ Kategoriler"}),K.odemeKurulusuAd!==!1&&e.jsx(g,{className:`cursor-pointer hover:bg-gray-100 transition-colors ${T==="odemeKurulusuAd"?"bg-blue-50":""}`,onClick:()=>W("odemeKurulusuAd"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:T==="odemeKurulusuAd"?"text-blue-600":"",children:"Ã–deme KuruluÅŸu"}),e.jsx(X,{field:"odemeKurulusuAd"})]})}),K.epkNo!==!1&&e.jsx(g,{className:`cursor-pointer hover:bg-gray-100 transition-colors ${T==="epkNo"?"bg-blue-50":""}`,onClick:()=>W("epkNo"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:T==="epkNo"?"text-blue-600":"",children:"EPK No"}),e.jsx(X,{field:"epkNo"})]})}),K.okNo!==!1&&e.jsx(g,{className:`cursor-pointer hover:bg-gray-100 transition-colors ${T==="okNo"?"bg-blue-50":""}`,onClick:()=>W("okNo"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:T==="okNo"?"text-blue-600":"",children:"Ã–K No"}),e.jsx(X,{field:"okNo"})]})}),K.durum!==!1&&e.jsx(g,{className:`cursor-pointer hover:bg-gray-100 transition-colors w-[10%] ${T==="durum"?"bg-blue-50":""}`,onClick:()=>W("durum"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:T==="durum"?"text-blue-600":"",children:"Durum"}),e.jsx(X,{field:"durum"})]})}),e.jsx(g,{className:"text-right w-[5%]",children:"Ä°ÅŸlemler"})]})}),e.jsx(ia,{children:C.length===0?e.jsx(ie,{children:e.jsx(n,{colSpan:5,className:"text-center text-gray-500 py-8",children:"KayÄ±t bulunamadÄ±"})}):Z.map(u=>e.jsxs(ie,{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>L(u),children:[K.muhasebeKodu!==!1&&K.firmaUnvan!==!1&&e.jsx(n,{children:e.jsxs("div",{children:[e.jsx("div",{children:u.firmaUnvan}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Kod: ",u.muhasebeKodu]})]})}),K.tip!==!1&&e.jsx(n,{children:e.jsx(c,{variant:u.bankaOrPF==="Banka"?"default":"outline",children:u.bankaOrPF})}),K.bankaPFAd!==!1&&e.jsx(n,{children:u.bankaPFAd}),K.kategoriler!==!1&&e.jsx(n,{children:e.jsx("div",{className:"flex flex-wrap gap-1",children:(()=>{const xe=[];if(u.linkedBankIds&&u.linkedBankIds.length>0){const m=u.linkedBankIds.length;xe.push(e.jsxs(c,{variant:"outline",className:"text-xs bg-blue-50 border-blue-300 text-blue-700",children:["ðŸ¦ ",m]},"banks"))}if(u.linkedEPKIds&&u.linkedEPKIds.length>0){const m=u.linkedEPKIds.length;xe.push(e.jsxs(c,{variant:"outline",className:"text-xs bg-green-50 border-green-300 text-green-700",children:["EPK ",m]},"epks"))}if(u.linkedOKIds&&u.linkedOKIds.length>0){const m=u.linkedOKIds.length;xe.push(e.jsxs(c,{variant:"outline",className:"text-xs bg-purple-50 border-purple-300 text-purple-700",children:["Ã–K ",m]},"oks"))}return xe.length>0?xe:e.jsx("span",{className:"text-xs text-gray-400",children:"-"})})()})}),K.odemeKurulusuAd!==!1&&e.jsx(n,{children:e.jsx("span",{className:"text-sm",children:u.odemeKurulusuAd||"-"})}),K.epkNo!==!1&&e.jsx(n,{children:e.jsx("span",{className:"text-sm",children:u.epkNo||"-"})}),K.okNo!==!1&&e.jsx(n,{children:e.jsx("span",{className:"text-sm",children:u.okNo||"-"})}),K.durum!==!1&&e.jsx(n,{children:e.jsx(c,{variant:u.durum==="Aktif"?"default":"secondary",children:u.durum})}),e.jsx(n,{className:"text-right",children:e.jsxs("button",{onClick:xe=>{xe.stopPropagation(),L(u)},className:"inline-flex items-center space-x-1 px-3 py-1 rounded hover:bg-gray-100 transition-colors",children:[e.jsx($s,{size:16}),e.jsx("span",{children:"Detay"})]})})]},u.id))})]})}),C.length>0&&e.jsx("div",{className:"p-4 border-t border-gray-200",children:e.jsx(Js,{currentPage:ve,totalPages:J,itemsPerPage:Te,totalItems:C.length,onPageChange:O,onItemsPerPageChange:f,startIndex:ge,endIndex:E})}),e.jsx("div",{className:"p-4 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-600",children:["GÃ¶sterilen: ",e.jsx("strong",{children:C.length})," kayÄ±t"]}),e.jsxs("div",{className:"flex items-center space-x-4 text-gray-600",children:[e.jsxs("span",{children:["Banka: ",e.jsx("strong",{children:C.filter(u=>u.bankaOrPF==="Banka").length})]}),e.jsxs("span",{children:["PF: ",e.jsx("strong",{children:C.filter(u=>u.bankaOrPF==="PF").length})]}),e.jsxs("span",{children:["Aktif: ",e.jsx("strong",{children:C.filter(u=>u.durum==="Aktif").length})]})]})]})})]})]})}const dl=[{key:"adiSoyadi",label:"AdÄ± SoyadÄ±",defaultVisible:!0},{key:"gorevi",label:"GÃ¶revi",defaultVisible:!0},{key:"tel",label:"Telefon",defaultVisible:!0},{key:"gsm",label:"GSM",defaultVisible:!0},{key:"mail",label:"E-posta",defaultVisible:!0}];function cl({contacts:w,onContactsChange:L,gorevListesi:oe}){const[Y,M]=x.useState(!1),[D,A]=x.useState(null),[b,H]=x.useState({}),[j,v]=x.useState({id:"",adiSoyadi:"",gorevi:"",tel:"",gsm:"",mail:""}),T=()=>{A(null),v({id:"",adiSoyadi:"",gorevi:"",tel:"",gsm:"",mail:""}),M(!0)},he=N=>{A(N),v(N),M(!0)},r=N=>{L(w.filter(W=>W.id!==N))},p=()=>{L(D?w.map(N=>N.id===D.id?j:N):[...w,{...j,id:Date.now().toString()}]),M(!1)},K=x.useCallback(N=>{H(N)},[]);return e.jsxs(se,{children:[e.jsx(De,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Oe,{children:"Ä°letiÅŸim Matrisi"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Is,{columns:dl,storageKey:"contactMatrix",onVisibilityChange:K}),e.jsxs(y,{onClick:T,className:"flex items-center space-x-2",children:[e.jsx(Xa,{size:18}),e.jsx("span",{children:"KiÅŸi Ekle"})]})]})]})}),e.jsxs(le,{children:[w.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx("p",{children:"HenÃ¼z yetkili kiÅŸi eklenmemiÅŸ."}),e.jsxs(y,{onClick:T,variant:"outline",className:"mt-4",children:[e.jsx(Xa,{size:18,className:"mr-2"}),"Ä°lk KiÅŸiyi Ekle"]})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(sa,{children:[e.jsx(la,{children:e.jsxs(ie,{children:[b.adiSoyadi!==!1&&e.jsx(g,{children:"AdÄ± SoyadÄ±"}),b.gorevi!==!1&&e.jsx(g,{children:"GÃ¶revi"}),b.tel!==!1&&e.jsx(g,{children:"Tel"}),b.gsm!==!1&&e.jsx(g,{children:"GSM"}),b.mail!==!1&&e.jsx(g,{children:"E-posta"}),e.jsx(g,{className:"text-right",children:"Ä°ÅŸlemler"})]})}),e.jsx(ia,{children:w.map(N=>e.jsxs(ie,{children:[b.adiSoyadi!==!1&&e.jsx(n,{children:N.adiSoyadi}),b.gorevi!==!1&&e.jsx(n,{children:e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-sm bg-blue-100 text-blue-800",children:N.gorevi})}),b.tel!==!1&&e.jsx(n,{children:N.tel||"-"}),b.gsm!==!1&&e.jsx(n,{children:N.gsm||"-"}),b.mail!==!1&&e.jsx(n,{children:N.mail}),e.jsx(n,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[e.jsx(y,{variant:"ghost",size:"sm",onClick:()=>he(N),children:e.jsx(rs,{size:16})}),e.jsx(y,{variant:"ghost",size:"sm",onClick:()=>r(N.id),children:e.jsx(ua,{size:16,className:"text-red-600"})})]})})]},N.id))})]})}),e.jsx(Da,{open:Y,onOpenChange:M,children:e.jsxs(Oa,{className:"max-w-2xl",children:[e.jsxs(wa,{children:[e.jsx(Sa,{children:D?"KiÅŸiyi DÃ¼zenle":"Yeni KiÅŸi Ekle"}),e.jsx(Ca,{children:"Ä°letiÅŸim matrisine yetkili kiÅŸi bilgilerini ekleyin."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 py-4",children:[e.jsxs("div",{className:"col-span-2 space-y-2",children:[e.jsx(U,{htmlFor:"adiSoyadi",children:"AdÄ± SoyadÄ± *"}),e.jsx(V,{id:"adiSoyadi",value:j.adiSoyadi,onChange:N=>v({...j,adiSoyadi:N.target.value}),placeholder:"Ã–rn: Ahmet YÄ±lmaz"})]}),e.jsxs("div",{className:"col-span-2 space-y-2",children:[e.jsx(U,{htmlFor:"gorevi",children:"GÃ¶revi *"}),e.jsxs($a,{value:j.gorevi,onValueChange:N=>v({...j,gorevi:N}),children:[e.jsx(Va,{id:"gorevi",children:e.jsx(Ya,{placeholder:"GÃ¶rev seÃ§iniz..."})}),e.jsx(Ua,{children:oe.map(N=>e.jsx(ya,{value:N,children:N},N))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"tel",children:"Telefon"}),e.jsx(V,{id:"tel",value:j.tel,onChange:N=>v({...j,tel:N.target.value}),placeholder:"0212 123 4567"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"gsm",children:"GSM"}),e.jsx(V,{id:"gsm",value:j.gsm,onChange:N=>v({...j,gsm:N.target.value}),placeholder:"0532 111 2233"})]}),e.jsxs("div",{className:"col-span-2 space-y-2",children:[e.jsx(U,{htmlFor:"mail",children:"E-posta *"}),e.jsx(V,{id:"mail",type:"email",value:j.mail,onChange:N=>v({...j,mail:N.target.value}),placeholder:"ornek@firma.com"})]})]}),e.jsxs(Ea,{children:[e.jsxs(y,{variant:"outline",onClick:()=>M(!1),children:[e.jsx(xs,{size:18,className:"mr-2"}),"Ä°ptal"]}),e.jsxs(y,{onClick:p,disabled:!j.adiSoyadi||!j.gorevi||!j.mail,children:[e.jsx(Ss,{size:18,className:"mr-2"}),D?"GÃ¼ncelle":"Ekle"]})]})]})})]})]})}function xl({documents:w,onDocumentsChange:L}){const[oe,Y]=x.useState(!1),[M,D]=x.useState(null),[A,b]=x.useState({id:"",dosyaAdi:"",dosyaTipi:"",yuklemeTarihi:"",boyut:"",aciklama:""}),H=()=>{D(null);const p=new Date().toISOString().split("T")[0];b({id:"",dosyaAdi:"",dosyaTipi:"PDF",yuklemeTarihi:p,boyut:"",aciklama:""}),Y(!0)},j=p=>{D(p),b(p),Y(!0)},v=p=>{L(w.filter(K=>K.id!==p))},T=()=>{L(M?w.map(p=>p.id===M.id?A:p):[...w,{...A,id:Date.now().toString()}]),Y(!1)},he=p=>e.jsx(Vs,{size:20,className:"text-blue-600"}),r=p=>new Date(p).toLocaleDateString("tr-TR");return e.jsxs(se,{children:[e.jsx(De,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Oe,{children:"DokÃ¼man YÃ¶netimi"}),e.jsxs(y,{onClick:H,className:"flex items-center space-x-2",children:[e.jsx(es,{size:18}),e.jsx("span",{children:"DokÃ¼man Ekle"})]})]})}),e.jsxs(le,{children:[w.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(es,{size:48,className:"mx-auto mb-4 text-gray-400"}),e.jsx("p",{children:"HenÃ¼z dokÃ¼man eklenmemiÅŸ."}),e.jsxs(y,{onClick:H,variant:"outline",className:"mt-4",children:[e.jsx(es,{size:18,className:"mr-2"}),"Ä°lk DokÃ¼manÄ± Ekle"]})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(sa,{children:[e.jsx(la,{children:e.jsxs(ie,{children:[e.jsx(g,{children:"Dosya AdÄ±"}),e.jsx(g,{children:"Tip"}),e.jsx(g,{children:"YÃ¼kleme Tarihi"}),e.jsx(g,{children:"Boyut"}),e.jsx(g,{children:"AÃ§Ä±klama"}),e.jsx(g,{className:"text-right",children:"Ä°ÅŸlemler"})]})}),e.jsx(ia,{children:w.map(p=>e.jsxs(ie,{children:[e.jsx(n,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[he(p.dosyaTipi),e.jsx("span",{children:p.dosyaAdi})]})}),e.jsx(n,{children:e.jsx(c,{variant:"outline",children:p.dosyaTipi})}),e.jsx(n,{children:r(p.yuklemeTarihi)}),e.jsx(n,{children:p.boyut}),e.jsx(n,{className:"max-w-xs truncate",children:p.aciklama||"-"}),e.jsx(n,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[e.jsx(y,{variant:"ghost",size:"sm",title:"Ä°ndir",children:e.jsx(Ns,{size:16})}),e.jsx(y,{variant:"ghost",size:"sm",onClick:()=>j(p),children:e.jsx(rs,{size:16})}),e.jsx(y,{variant:"ghost",size:"sm",onClick:()=>v(p.id),children:e.jsx(ua,{size:16,className:"text-red-600"})})]})})]},p.id))})]})}),e.jsx(Da,{open:oe,onOpenChange:Y,children:e.jsxs(Oa,{className:"max-w-2xl",children:[e.jsxs(wa,{children:[e.jsx(Sa,{children:M?"DokÃ¼manÄ± DÃ¼zenle":"Yeni DokÃ¼man Ekle"}),e.jsx(Ca,{children:"DokÃ¼man bilgilerini girin. GerÃ§ek dosya yÃ¼kleme Ã¶zelliÄŸi simÃ¼le edilmiÅŸtir."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"dosyaAdi",children:"Dosya AdÄ± *"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(V,{id:"dosyaAdi",value:A.dosyaAdi,onChange:p=>b({...A,dosyaAdi:p.target.value}),placeholder:"Ã–rn: Faaliyet Belgesi.pdf",className:"flex-1"}),e.jsxs(y,{variant:"outline",type:"button",children:[e.jsx(es,{size:18,className:"mr-2"}),"Dosya SeÃ§"]})]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Not: Bu demo versiyonunda dosya yÃ¼kleme simÃ¼le edilmektedir."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"dosyaTipi",children:"Dosya Tipi *"}),e.jsx(V,{id:"dosyaTipi",value:A.dosyaTipi,onChange:p=>b({...A,dosyaTipi:p.target.value}),placeholder:"PDF, DOCX, XLSX, vb."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"boyut",children:"Boyut"}),e.jsx(V,{id:"boyut",value:A.boyut,onChange:p=>b({...A,boyut:p.target.value}),placeholder:"Ã–rn: 2.5 MB"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"yuklemeTarihi",children:"YÃ¼kleme Tarihi"}),e.jsx(V,{id:"yuklemeTarihi",type:"date",value:A.yuklemeTarihi,onChange:p=>b({...A,yuklemeTarihi:p.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"aciklama",children:"AÃ§Ä±klama"}),e.jsx(ms,{id:"aciklama",value:A.aciklama,onChange:p=>b({...A,aciklama:p.target.value}),placeholder:"DokÃ¼man hakkÄ±nda kÄ±sa aÃ§Ä±klama",rows:3})]})]}),e.jsxs(Ea,{children:[e.jsxs(y,{variant:"outline",onClick:()=>Y(!1),children:[e.jsx(xs,{size:18,className:"mr-2"}),"Ä°ptal"]}),e.jsxs(y,{onClick:T,disabled:!A.dosyaAdi||!A.dosyaTipi,children:[e.jsx(Ss,{size:18,className:"mr-2"}),M?"GÃ¼ncelle":"Ekle"]})]})]})})]})]})}function Pa({label:w,options:L,value:oe,onChange:Y,placeholder:M="SeÃ§iniz...",disabled:D=!1,error:A,required:b=!1,className:H=""}){const[j,v]=x.useState(!1),T=L.find(p=>p.value===oe),he=(T==null?void 0:T.label)||M,r=p=>{Y(p),v(!1)};return e.jsxs("div",{className:`space-y-2 ${H}`,children:[w&&e.jsxs("label",{className:"text-sm text-gray-700",children:[w,b&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsxs(Ds,{open:j,onOpenChange:v,children:[e.jsx(Os,{asChild:!0,children:e.jsxs(y,{type:"button",variant:"outline",role:"combobox","aria-expanded":j,disabled:D,className:["w-full flex items-center justify-between h-10 px-3",D?"bg-gray-100 cursor-not-allowed":"bg-white hover:bg-gray-50",A?"border-red-500 focus:ring-red-500":"border-gray-300",T?"text-gray-900":"text-gray-500"].join(" "),children:[e.jsx("span",{className:"truncate",children:he}),e.jsx(ss,{className:`ml-2 h-4 w-4 shrink-0 opacity-50 transition-transform ${j?"rotate-180":""}`})]})}),e.jsx(ws,{className:"p-0 rounded-xl shadow-lg border-gray-200",align:"start",sideOffset:4,style:{width:"var(--radix-popover-trigger-width)"},children:e.jsx(el,{className:"max-h-[280px]",children:e.jsx("div",{className:"p-1",children:L.length===0?e.jsx("div",{className:"px-3 py-6 text-center text-sm text-gray-500",children:"SeÃ§enek bulunamadÄ±"}):L.map(p=>e.jsxs("button",{type:"button",onClick:()=>!p.disabled&&r(p.value),disabled:p.disabled,className:`
                      w-full flex items-center justify-between px-3 py-2.5 rounded-lg text-sm
                      transition-colors
                      ${p.disabled?"opacity-50 cursor-not-allowed":"hover:bg-gray-100 cursor-pointer"}
                      ${oe===p.value?"bg-blue-50 text-blue-700":"text-gray-700"}
                    `,children:[e.jsxs("div",{className:"flex flex-col items-start flex-1 min-w-0",children:[e.jsx("span",{className:"truncate w-full text-left",children:p.label}),p.description&&e.jsx("span",{className:"text-xs text-gray-500 mt-0.5 truncate w-full text-left",children:p.description})]}),oe===p.value&&e.jsx(Ss,{className:"h-4 w-4 ml-2 shrink-0 text-blue-600"})]},p.value))})})})]}),A&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:A})]})}const ba=w=>{switch(w){case"UnattendedPOS":return"UnattPOS";case"AttendedPOS":return"AttndPOS";case"SoftPOS":return"SoftPOS";case"SanalPOS":return"SanalPOS";default:return w}},ys=["D+1","D+7","D+14","D+31"];function ml({firmaId:w,firmaAdi:L,firmaTipi:oe,odemeKurulusuTipi:Y="",gelirModelleri:M=[],ekGelirler:D=[],banks:A=[],kartProgramlar:b=[],tabelaRecords:H=[],tabelaGroups:j=[],onTabelaRecordsChange:v,onTabelaGroupsChange:T}){var Le,Ze;const he=x.useRef(null),r=x.useRef(0),[p,K]=x.useState(!1),[N,W]=x.useState(null),[X,C]=x.useState(1),[Z,ve]=x.useState(null),[J,Te]=x.useState("all"),[ge,E]=x.useState(!1),[O,f]=x.useState([]),[l,d]=x.useState(""),[z,u]=x.useState(""),[xe,m]=x.useState(""),[F,Ee]=x.useState(!0),[pe,We]=x.useState(null),[fa,Cs]=x.useState(new Set),[Es,I]=x.useState(!1),[Ta,Ie]=x.useState(""),[ee,Aa]=x.useState(""),[$e,ea]=x.useState(""),[Xe,ta]=x.useState(""),[Re,ra]=x.useState("NONE"),[be,ca]=x.useState([]),[ha,qa]=x.useState(""),[Qe,Na]=x.useState(ys.map(a=>({vade:a,oran:"",alisTL:"",satisTL:"",karTL:"",aktif:!0}))),[ka,Ja]=x.useState(""),[ga,Ba]=x.useState(""),[ls,Wa]=x.useState(""),[aa,va]=x.useState(""),[os,is]=x.useState({tutarTL:"",oxivoYuzde:"",kazancTL:""}),pa=M.filter(a=>a.aktif),Fa=D.filter(a=>a.aktif);A.filter(a=>a.aktif);const Qa=b.filter(a=>a.aktif),Ve=M.find(a=>a.id===Xe),Be=((Le=Ve==null?void 0:Ve.ad)==null?void 0:Le.toLowerCase().includes("paÃ§al"))||!1,Ae=()=>{he.current&&(r.current=he.current.scrollTop)},Fe=()=>{requestAnimationFrame(()=>{he.current&&r.current>0&&(he.current.scrollTop=r.current)})},te=a=>j.find(o=>{var i;return(i=o.recordIds)==null?void 0:i.includes(a)}),Ka=a=>!!te(a),re=N?Ka(N.id):!1;x.useEffect(()=>{Be&&$e!=="PaÃ§al"&&(console.log("ðŸ”’ PaÃ§al gelir modeli algÄ±landÄ±:",Ve==null?void 0:Ve.ad),console.log('ðŸŽ¯ Kart tipi otomatik "PaÃ§al" olarak ayarlandÄ±'),ea("PaÃ§al"),P.info('Kart tipi otomatik olarak "PaÃ§al" olarak ayarlandÄ±'))},[Be]),x.useEffect(()=>{Fe()},[H]);const Ga=()=>{Ie(""),Aa(""),ea(""),ta(""),ra("NONE"),ca([]),qa(""),Na(ys.map(a=>({vade:a,oran:"",alisTL:"",satisTL:"",karTL:"",aktif:!0}))),Ja(""),Ba(""),Wa(""),va(""),is({tutarTL:"",oxivoYuzde:"",kazancTL:""}),C(0),W(null)},ja=a=>{if(a){W(a),Ie(a.kisaAciklama||""),Aa(a.urun||""),ea(a.kartTipi),ta(a.gelirModeli.id),ca(a.kartProgramIds||a.bankIds||[]),qa(a.yurtIciDisi);const o=ys.map(i=>a.komisyonOranlarÄ±.find(R=>R.vade===i)||{vade:i,oran:"",alisTL:"",satisTL:"",karTL:"",aktif:!1});Na(o),Ja(a.paylaÅŸÄ±mOranlarÄ±.kurulusOrani),Ba(a.paylaÅŸÄ±mOranlarÄ±.oxivoOrani),Wa(a.aciklama||""),va(a.fotograf||""),is(a.hazineGeliri||{tutarTL:"",oxivoYuzde:"",kazancTL:""}),C(0)}else Ga();K(!0)},s=()=>{K(!1),Ga()},h=()=>{if(X===1){if(!ee){P.error("âŒ LÃ¼tfen Ã¼rÃ¼n seÃ§iniz");return}if(!Xe){P.error("âŒ LÃ¼tfen gelir modeli seÃ§iniz");return}const a=pa.find(o=>o.id===Xe);if(!a){P.error("âŒ SeÃ§ilen gelir modeli bulunamadÄ±");return}if(P.success(`âœ… ÃœrÃ¼n: ${ee}, Gelir Modeli: ${a.ad}`),Re&&Re!=="NONE"){const o=Fa.find(i=>i.id===Re);if(o&&o.gelirTuru==="Hazine Geliri"){k(o);return}}}if(X===2){if(be.length===0){P.error("âŒ LÃ¼tfen en az bir kart programÄ± seÃ§iniz");return}P.success(`âœ… ${be.includes("ALL")?"TÃ¼m kart programlarÄ±":be.length+" kart programÄ±"} seÃ§ildi`)}if(X===3){if(!ha){P.error("âŒ LÃ¼tfen yurt iÃ§i veya yurt dÄ±ÅŸÄ± seÃ§iniz");return}P.success(`âœ… ${ha} seÃ§ildi`)}if(X===4){if(!$e){P.error("âŒ LÃ¼tfen kart tipi seÃ§iniz");return}P.success(`âœ… Kart Tipi: ${$e}`)}C(a=>a+1)},k=a=>{const o=M.find(ce=>ce.id===Xe);if(!o)return;const i=oe==="Banka"?"EPK":Y,t={id:Date.now().toString(),kurulus:{tip:i,id:w,ad:L},urun:ee,kartTipi:a.kartTipi,gelirModeli:{id:o.id,ad:o.ad},kartProgramIds:["ALL"],yurtIciDisi:a.kullanim,komisyonOranlarÄ±:[],ekGelirDetay:{id:a.id,kodNo:a.kodNo,gelirTuru:a.gelirTuru,kullanim:a.kullanim,kartTipi:a.kartTipi,tutar:a.tutar||"0.00",pfYuzde:a.pfYuzde||"0.00",pfTL:a.pfTL||"0.00",oxYuzde:a.oxYuzde||"0.00",oxTL:a.oxTL||"0.00"},paylaÅŸÄ±mOranlarÄ±:{kurulusOrani:a.pfYuzde||"0",oxivoOrani:a.oxYuzde||"0"},olusturmaTarihi:new Date().toISOString().split("T")[0],aktif:!0},R=[...H,t];v==null||v(R),P.success(`âœ“ TABELA kaydÄ± oluÅŸturuldu: ${a.gelirTuru} + ${a.kullanim}`),K(!1),Ga()},S=()=>{C(a=>a-1)},Q=a=>{var i;const o=(i=a.target.files)==null?void 0:i[0];if(o){if(o.size>2*1024*1024){P.error("FotoÄŸraf boyutu 2MB'dan kÃ¼Ã§Ã¼k olmalÄ±dÄ±r");return}if(!o.type.startsWith("image/")){P.error("LÃ¼tfen geÃ§erli bir resim dosyasÄ± seÃ§iniz");return}const t=new FileReader;t.onload=()=>{va(t.result),P.success("FotoÄŸraf yÃ¼klendi")},t.onerror=()=>{P.error("FotoÄŸraf yÃ¼klenirken hata oluÅŸtu")},t.readAsDataURL(o)}},de=()=>{if(!ee){P.error("ÃœrÃ¼n seÃ§melisiniz");return}if(!Xe){P.error("Gelir modeli seÃ§melisiniz");return}if(be.length===0){P.error("En az bir kart programÄ± seÃ§melisiniz");return}if(!ha){P.error("Yurt iÃ§i/dÄ±ÅŸÄ± seÃ§melisiniz");return}if(!$e){P.error("LÃ¼tfen kart tipi seÃ§iniz");return}const a=M.find(t=>t.id===Xe);if(!a)return;const o=oe==="Banka"?"EPK":Y,i={id:(N==null?void 0:N.id)||Date.now().toString(),kurulus:{tip:o,id:w,ad:L},urun:ee,kartTipi:$e,gelirModeli:{id:a.id,ad:a.ad},kartProgramIds:be,yurtIciDisi:ha,komisyonOranlarÄ±:Qe.filter(t=>t.aktif),paylaÅŸÄ±mOranlarÄ±:{kurulusOrani:ka||"50",oxivoOrani:ga||"50"},kisaAciklama:Ta||void 0,aciklama:ls||void 0,fotograf:aa||void 0,olusturmaTarihi:(N==null?void 0:N.olusturmaTarihi)||new Date().toLocaleDateString("tr-TR"),kapanmaTarihi:N==null?void 0:N.kapanmaTarihi,aktif:(N==null?void 0:N.aktif)??!0};if(Ae(),N){const t=H.map(R=>R.id===N.id?i:R);v==null||v(t),P.success("TABELA kaydÄ± gÃ¼ncellendi")}else v==null||v([...H,i]),P.success("TABELA kaydÄ± eklendi");s(),Fe()},ne=a=>{if(confirm("Bu TABELA kaydÄ±nÄ± silmek istediÄŸinizden emin misiniz?")){Ae();const o=H.filter(i=>i.id!==a);v==null||v(o),P.success("TABELA kaydÄ± silindi"),Fe()}},ye=a=>{Ae();const o=H.map(i=>i.id===a?{...i,aktif:!i.aktif}:i);v==null||v(o),Fe()},me=()=>{if(!Z)return;Ae();const a=H.map(o=>o.id===Z.id?{...o,aktif:!1,kapanmaTarihi:new Date().toLocaleDateString("tr-TR")}:o);v==null||v(a),P.success("TABELA anlaÅŸmasÄ± kapatÄ±ldÄ±"),Fe(),ve(null)},_e=()=>{f([]),d(""),u(""),m(""),Ee(!0),We(null),E(!0)},qe=()=>{if(O.length===0){P.error("LÃ¼tfen en az bir TABELA kaydÄ± seÃ§iniz");return}if(!l.trim()){P.error("LÃ¼tfen grup ismi giriniz");return}if(!z){P.error("LÃ¼tfen geÃ§erlilik baÅŸlangÄ±Ã§ tarihi giriniz");return}Ae();const a={id:(pe==null?void 0:pe.id)||Date.now().toString(),name:l,gecerlilikBaslangic:z,gecerlilikBitis:xe||void 0,recordIds:O,pinned:(pe==null?void 0:pe.pinned)||!1,aktif:F};if(pe){const o=j.map(i=>i.id===pe.id?a:i);T==null||T(o),P.success("Grup gÃ¼ncellendi")}else T==null||T([...j,a]),P.success("Grup oluÅŸturuldu");E(!1),f([]),d(""),u(""),m(""),Ee(!0),We(null),Fe()},Pe=a=>{We(a),f(a.recordIds||[]),d(a.name),u(a.gecerlilikBaslangic),m(a.gecerlilikBitis||""),Ee(a.aktif!==void 0?a.aktif:!0),E(!0)},Je=a=>{if(confirm("Bu grubu silmek istediÄŸinizden emin misiniz?")){Ae();const o=j.filter(i=>i.id!==a);T==null||T(o),P.success("Grup silindi"),Fe()}},ue=a=>{Ae();const o=j.map(i=>i.id===a?{...i,pinned:!i.pinned}:i);T==null||T(o),Fe()},_=a=>{Ae();const o=j.map(t=>t.id===a?{...t,aktif:!t.aktif}:t);T==null||T(o);const i=j.find(t=>t.id===a);P.success(`Grup "${i==null?void 0:i.name}" ${i!=null&&i.aktif?"pasif":"aktif"} edildi`),Fe()};if(oe==="Banka")return e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(ds,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-gray-600 mb-2",children:"TABELA UyarÄ±sÄ±"}),e.jsx("p",{className:"text-gray-500",children:"TABELA kayÄ±tlarÄ± sadece Ã–deme KuruluÅŸlarÄ± (PF) iÃ§in tanÄ±mlanabilir."})]});if(!Y||Y!=="EPK"&&Y!=="Ã–K")return e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(ds,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-gray-600 mb-2",children:"KuruluÅŸ Tipi BelirtilmemiÅŸ"}),e.jsx("p",{className:"text-gray-500",children:"TABELA kayÄ±tlarÄ± iÃ§in lÃ¼tfen Ã¶nce Ã¶deme kuruluÅŸu tipini (EPK/Ã–K) belirleyin."})]});const $=H.filter(a=>J==="active"?a.aktif:J==="closed"?!a.aktif:!0),q=H.filter(a=>a.aktif?pe&&pe.recordIds.includes(a.id)?!0:!te(a.id):!1);x.useEffect(()=>{H.length>0&&(console.log("ðŸ“Š TABELA KayÄ±tlarÄ±:",H.length),H.forEach((a,o)=>{console.log(`
ðŸ“ TABELA ${o+1}:`,{id:a.id,gelirModeli:a.gelirModeli.ad,kurulusAd:a.kurulus.ad,komisyonOranlarÄ±:a.komisyonOranlarÄ±,paylaÅŸÄ±mOranlarÄ±:a.paylaÅŸÄ±mOranlarÄ±,aktif:a.aktif})}))},[H]);const Ge=H.filter(a=>a.aktif).length,ze=H.filter(a=>!a.aktif).length,we=a=>a.trim().split(/\s+/)[0]||"",Se=a=>{Cs(o=>{const i=new Set(o);return i.has(a)?i.delete(a):i.add(a),i})};return e.jsxs("div",{className:"space-y-6",ref:he,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{children:"TABELA KayÄ±tlarÄ±"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[L," iÃ§in komisyon ve paylaÅŸÄ±m oranlarÄ±"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(y,{onClick:()=>I(!0),variant:"outline",size:"sm",className:"flex items-center gap-2",children:[e.jsx(ll,{size:16}),e.jsx("span",{children:"HiyerarÅŸi"})]}),e.jsx(y,{onClick:()=>{console.log(`
ðŸ” TABELA Debug - Firma:`,L),console.log("ðŸ“Š Toplam kayÄ±t:",H.length),console.log("âœ… GÃ¶sterilen kayÄ±t:",$.length),H.forEach((a,o)=>{console.log(`
ðŸ“ TABELA ${o+1}:`,{gelirModeli:a.gelirModeli.ad,kurulusAd:a.kurulus.ad,kurulusTip:a.kurulus.tip,komisyonlar:a.komisyonOranlarÄ±.map(i=>`${i.vade}: %${i.oran}`),paylaÅŸÄ±m:`KuruluÅŸ: %${a.paylaÅŸÄ±mOranlarÄ±.kurulusOrani}, OXÄ°VO: %${a.paylaÅŸÄ±mOranlarÄ±.oxivoOrani}`,bankalar:a.bankIds,aktif:a.aktif?"âœ“ Aktif":"ðŸ”’ KapalÄ±"})}),P.success(`${$.length} kayÄ±t gÃ¶rÃ¼ntÃ¼leniyor`,{description:"Detaylar konsolda (F12)"})},variant:"outline",size:"sm",children:"ðŸ” Verileri Kontrol Et"}),$.length>0&&e.jsxs(ks,{children:[e.jsx(vs,{asChild:!0,children:e.jsx("div",{children:e.jsxs(y,{onClick:()=>{if(q.length===0){P.error("Gruplanabilir kayÄ±t yok",{description:"TÃ¼m aktif TABELA kayÄ±tlarÄ± zaten bir gruba atanmÄ±ÅŸ. Ã–nce yeni TABELA kaydÄ± oluÅŸturun veya mevcut kayÄ±tlarÄ± gruplardan Ã§Ä±karÄ±n."});return}_e()},variant:"outline",className:"flex items-center gap-2",disabled:q.length===0,children:[e.jsx(Xa,{size:20}),e.jsx("span",{children:"Grup OluÅŸtur"}),q.length>0&&e.jsx(c,{variant:"secondary",className:"ml-1",children:q.length})]})})}),q.length===0&&e.jsx(bs,{children:e.jsx("p",{children:"TÃ¼m aktif TABELA kayÄ±tlarÄ± zaten bir gruba atanmÄ±ÅŸ"})})]}),e.jsxs(y,{onClick:()=>ja(),className:"flex items-center gap-2",children:[e.jsx(Xa,{size:20}),e.jsx("span",{children:"Yeni TABELA KaydÄ±"})]})]})]}),j.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"flex items-center gap-2",children:["ðŸ“ TABELA GruplarÄ±",e.jsx(c,{variant:"secondary",children:j.length})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:j.map(a=>{var o;return e.jsxs("div",{className:`border rounded-lg p-4 bg-white hover:shadow-md transition-shadow ${a.pinned?"border-blue-500 border-2":"border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("h5",{className:"text-sm",children:a.name}),a.pinned&&e.jsx(c,{variant:"default",className:"text-xs bg-blue-600",children:"ðŸ“Œ"}),e.jsx(c,{variant:a.aktif!==!1?"default":"secondary",className:`text-xs ${a.aktif!==!1?"bg-green-600":"bg-gray-400"}`,children:a.aktif!==!1?"Aktif":"Pasif"})]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[e.jsxs("div",{children:["BaÅŸlangÄ±Ã§: ",a.gecerlilikBaslangic]}),a.gecerlilikBitis&&e.jsxs("div",{children:["BitiÅŸ: ",a.gecerlilikBitis]}),!a.gecerlilikBitis&&e.jsx("div",{className:"text-green-600",children:"SÃ¼resiz"})]})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(y,{size:"sm",variant:"ghost",onClick:()=>ue(a.id),title:a.pinned?"Sabitlemeyi KaldÄ±r":"Sabitle",children:a.pinned?"ðŸ“Œ":"ðŸ“"}),e.jsx(y,{size:"sm",variant:"ghost",onClick:()=>Pe(a),title:"DÃ¼zenle",children:e.jsx(Za,{size:14})}),e.jsx(y,{size:"sm",variant:"ghost",onClick:()=>Je(a.id),title:"Sil",className:"text-red-600 hover:text-red-700",children:e.jsx(ua,{size:14})})]})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-100 space-y-2",children:[e.jsx("div",{className:"text-xs text-gray-600",children:e.jsxs(c,{variant:"outline",className:"text-xs",children:[((o=a.recordIds)==null?void 0:o.length)||0," TABELA kaydÄ±"]})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-gray-600",children:a.aktif!==!1?"âœ“ HakediÅŸ iÃ§in aktif":"âš ï¸ HakediÅŸ iÃ§in pasif"}),e.jsx(Bs,{checked:a.aktif!==!1,onCheckedChange:()=>_(a.id),className:"scale-75"})]})]})]},a.id)})})]}),H.length>0&&e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-gray-50 rounded-lg border",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Filtre:"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(y,{size:"sm",variant:J==="all"?"default":"outline",onClick:()=>Te("all"),children:["TÃ¼mÃ¼ (",H.length,")"]}),e.jsxs(y,{size:"sm",variant:J==="active"?"default":"outline",onClick:()=>Te("active"),className:J==="active"?"bg-green-600":"",children:["âœ“ Aktif (",Ge,")"]}),e.jsxs(y,{size:"sm",variant:J==="closed"?"default":"outline",onClick:()=>Te("closed"),className:J==="closed"?"bg-orange-600":"",children:["ðŸ”’ KapalÄ± (",ze,")"]})]})]}),$.length===0?e.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300",children:[e.jsx("p",{className:"text-gray-500",children:H.length===0?"HenÃ¼z TABELA kaydÄ± bulunmamaktadÄ±r.":`${J==="active"?"Aktif":"KapalÄ±"} TABELA kaydÄ± bulunmamaktadÄ±r.`}),H.length===0&&e.jsx(y,{onClick:()=>ja(),className:"mt-4",children:"Ä°lk KaydÄ± OluÅŸtur"})]}):e.jsxs(sa,{children:[e.jsx(la,{children:e.jsxs(ie,{children:[e.jsx(g,{className:"w-12",children:e.jsx(ae,{checked:$.length>0&&$.filter(a=>!Ka(a.id)).length>0&&$.filter(a=>!Ka(a.id)).every(a=>O.includes(a.id)),onCheckedChange:a=>{if(Ae(),a){const o=$.filter(i=>!Ka(i.id));f(o.map(i=>i.id))}else f([]);Fe()}})}),e.jsx(g,{children:"KLM"}),e.jsx(g,{children:"Grup"}),e.jsx(g,{children:"KÄ±sa AÃ§Ä±klama"}),e.jsx(g,{children:"ÃœrÃ¼n"}),e.jsx(g,{children:"Gelir Modeli"}),e.jsx(g,{children:"Kart ProgramlarÄ±"}),e.jsx(g,{children:"Yurt Ä°Ã§i/DÄ±ÅŸÄ±"}),e.jsx(g,{children:"Kart Tipi"}),e.jsx(g,{children:"Vade"}),e.jsx(g,{children:"KazanÃ§"}),e.jsx(g,{children:"PaylaÅŸÄ±m OranlarÄ±"}),e.jsx(g,{children:"OluÅŸturma"}),e.jsx(g,{children:"Ä°ÅŸlemler"})]})}),e.jsxs(ia,{children:[j.map(a=>{const o=$.filter(t=>{var R;return!t.ekGelirDetay&&((R=te(t.id))==null?void 0:R.id)===a.id});if(o.length===0)return null;const i=fa.has(a.id);return e.jsxs(as.Fragment,{children:[e.jsx(ie,{className:"bg-gradient-to-r from-blue-100 to-blue-50 border-t-2 border-blue-300 hover:from-blue-200 hover:to-blue-100 cursor-pointer",onClick:()=>Se(a.id),children:e.jsx(n,{colSpan:13,className:"py-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[i?e.jsx(ts,{size:20,className:"text-blue-700"}):e.jsx(ss,{size:20,className:"text-blue-700"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{variant:"default",className:"bg-blue-600 text-white",children:a.name}),e.jsxs("span",{className:"text-sm text-blue-800",children:[o.length," kayÄ±t"]}),!a.aktif&&e.jsx(c,{variant:"secondary",className:"bg-gray-400 text-white text-xs",children:"Pasif"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-700",children:[e.jsxs("span",{children:["GeÃ§erlilik: ",new Date(a.gecerlilikBaslangic).toLocaleDateString("tr-TR")]}),a.gecerlilikBitis&&e.jsxs("span",{children:["- ",new Date(a.gecerlilikBitis).toLocaleDateString("tr-TR")]})]})]})})},`group-header-${a.id}`),!i&&a.aktif!==!1&&o.map((t,R)=>{var Ye,He,B,je;const ce=t.kartProgramIds||t.bankIds||[],Ce=te(t.id),Me=!!Ce;return e.jsxs(ie,{className:"hover:bg-gray-50 bg-blue-50/20",children:[e.jsx(n,{className:"py-4",children:e.jsx(ae,{checked:O.includes(t.id),disabled:Me,onCheckedChange:G=>{Ae(),f(G?[...O,t.id]:O.filter(Ne=>Ne!==t.id)),Fe()},title:Me?`Bu kayÄ±t "${Ce==null?void 0:Ce.name}" grubuna aittir`:""})}),e.jsx(n,{className:"py-4",children:e.jsx(c,{variant:"outline",className:"bg-slate-50 text-slate-700 border-slate-300 font-mono text-xs",children:String(R+1).padStart(2,"0")})}),e.jsx(n,{className:"py-4",children:Me&&Ce?e.jsx(c,{variant:"default",className:"bg-blue-600 text-white",children:we(Ce.name)}):e.jsx("span",{className:"text-xs text-gray-400",children:"-"})}),e.jsx(n,{className:"py-4",children:t.kisaAciklama?e.jsx(c,{variant:"outline",className:"bg-amber-50 text-amber-700 border-amber-300 text-xs",children:t.kisaAciklama}):e.jsx("span",{className:"text-xs text-gray-400",children:"-"})}),e.jsx(n,{className:"py-4",children:t.urun?e.jsx(c,{variant:"outline",className:"bg-indigo-50 text-indigo-700 border-indigo-300",children:ba(t.urun)}):e.jsx("span",{className:"text-xs text-gray-400",children:"-"})}),e.jsx(n,{className:"py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:t.gelirModeli.ad}),((Ye=t.gelirModeli.ad)==null?void 0:Ye.toLowerCase().includes("paÃ§al"))&&e.jsx(c,{variant:"outline",className:"bg-purple-50 text-purple-700 border-purple-300 text-xs",children:"Auto"}),t.ekGelirDetay&&e.jsx(c,{variant:"outline",className:"bg-green-50 text-green-700 border-green-300 text-xs",children:t.ekGelirDetay.gelirTuru})]})}),e.jsx(n,{className:"py-4",children:ce.includes("ALL")?e.jsx(c,{variant:"default",className:"bg-blue-600",children:"Hepsi"}):ce.length>0?e.jsxs("div",{className:"flex flex-wrap gap-1",children:[ce.slice(0,2).map(G=>{const Ne=b.find(fe=>fe.id===G),Ke=A.find(fe=>fe.id===G);return Ne?e.jsx(c,{variant:"outline",className:"text-xs",children:Ne.kartAdi},G):Ke?e.jsx(c,{variant:"outline",className:"text-xs bg-yellow-50",children:Ke.kod},G):null}),ce.length>2&&e.jsxs(c,{variant:"secondary",className:"text-xs",children:["+",ce.length-2]})]}):e.jsx("span",{className:"text-xs text-gray-400",children:"-"})}),e.jsx(n,{className:"py-4",children:e.jsx(c,{variant:t.yurtIciDisi==="Yurt Ä°Ã§i"?"default":"secondary",children:t.yurtIciDisi})}),e.jsx(n,{className:"py-4",children:e.jsx(c,{variant:t.kartTipi==="Credit"?"default":t.kartTipi==="Debit"?"secondary":"outline",className:(He=t.kartTipi)!=null&&He.includes("PaÃ§al")?"bg-purple-100 text-purple-700 border-purple-300":"",children:((B=t.kartTipi)==null?void 0:B.replace(" (TÃ¼m Kart Tipleri)",""))||t.kartTipi})}),e.jsx(n,{className:"py-4",children:e.jsx("div",{className:"space-y-1.5",children:t.komisyonOranlarÄ±.filter(G=>G.aktif!==!1).length>0?e.jsx("div",{className:"flex flex-col gap-0.5",children:t.komisyonOranlarÄ±.filter(G=>G.aktif!==!1).map((G,Ne)=>e.jsx("div",{className:"text-xs text-blue-700",children:G.vade.replace(" (PeÅŸin)","")},Ne))}):e.jsx("span",{className:"text-xs text-gray-400",children:"-"})})}),e.jsx(n,{className:"py-4",children:e.jsx("div",{className:"text-xs space-y-1.5",children:t.gelirModeli.ad==="Hazine Geliri"?e.jsxs("div",{className:"flex items-center justify-between gap-2 bg-blue-50 px-2 py-1.5 rounded",children:[e.jsx("span",{className:"text-gray-700",children:"KazanÃ§:"}),e.jsxs("span",{className:"text-blue-700",children:[parseFloat(((je=t.hazineGeliri)==null?void 0:je.kazancTL)||"0").toFixed(2),"â‚º"]})]}):t.gelirModeli.ad==="Gelir OrtaklÄ±ÄŸÄ±"?e.jsx("div",{className:"flex flex-col gap-1.5",children:t.komisyonOranlarÄ±.filter(G=>G.aktif!==!1).map((G,Ne)=>{const Ke=fe=>!fe||fe===""?"0,00":parseFloat(fe).toFixed(2).replace(".",",");return e.jsxs("div",{className:"flex flex-col gap-0.5 px-2 py-1.5 rounded bg-gray-50",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("span",{className:"text-gray-600",children:"AlÄ±ÅŸ:"}),e.jsxs("span",{className:"text-red-600",children:["%",Ke(G.alisTL)]})]}),e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("span",{className:"text-gray-600",children:"SatÄ±ÅŸ:"}),e.jsxs("span",{className:"text-green-600",children:["%",Ke(G.satisTL)]})]}),e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("span",{className:"text-gray-600",children:"KazanÃ§:"}),e.jsxs("span",{className:"text-blue-600",children:["%",Ke(G.karTL)]})]})]},Ne)})}):e.jsx("div",{className:"flex flex-col gap-0.5",children:t.komisyonOranlarÄ±.filter(G=>G.aktif!==!1).map((G,Ne)=>{const Ke=G.vade.replace(" (PeÅŸin)","");return e.jsxs("div",{className:"text-blue-700",children:[Ke,":%",G.oran]},Ne)})})})}),e.jsx(n,{className:"py-4",children:e.jsxs("div",{className:"text-xs space-y-1.5",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 bg-green-50 px-2 py-1.5 rounded",children:[e.jsx("span",{className:"text-gray-700",children:t.kurulus.ad}),e.jsxs("span",{className:"text-green-700",children:["%",t.paylaÅŸÄ±mOranlarÄ±.kurulusOrani]})]}),e.jsxs("div",{className:"flex items-center justify-between gap-2 bg-blue-50 px-2 py-1.5 rounded",children:[e.jsx("span",{className:"text-gray-700",children:"OXÄ°VO"}),e.jsxs("span",{className:"text-blue-700",children:["%",t.paylaÅŸÄ±mOranlarÄ±.oxivoOrani]})]})]})}),e.jsx(n,{className:"py-4",children:e.jsxs("div",{className:"text-xs text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-green-600",children:"ðŸ“…"}),e.jsx("span",{children:t.olusturmaTarihi})]}),t.kapanmaTarihi&&e.jsxs("div",{className:"flex items-center gap-1 mt-1 text-orange-600",children:[e.jsx("span",{children:"ðŸ”’"}),e.jsx("span",{children:t.kapanmaTarihi})]}),e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[t.aciklama&&e.jsx(c,{variant:"outline",className:"text-xs",children:"ðŸ“"}),t.fotograf&&e.jsx(c,{variant:"outline",className:"text-xs",children:"ðŸ“·"})]})]})}),e.jsx(n,{className:"py-4",onClick:G=>G.stopPropagation(),children:e.jsxs("div",{className:"flex flex-col gap-1.5",children:[t.aktif?e.jsx(y,{size:"sm",variant:"default",className:"bg-green-600 hover:bg-green-700 h-8 px-3",onClick:G=>{G.stopPropagation(),ye(t.id)},title:"Aktif - Kapat",children:"âœ“ Aktif"}):e.jsx(y,{size:"sm",variant:"secondary",className:"bg-orange-100 text-orange-700 hover:bg-orange-200 h-8 px-3",onClick:G=>{G.stopPropagation(),ye(t.id)},title:"KapalÄ± - AÃ§",children:"ðŸ”’ Kapa"}),e.jsx(y,{size:"sm",variant:"outline",onClick:G=>{G.stopPropagation(),ja(t)},title:"GÃ¼ncelle",className:"h-8 px-2",children:e.jsx(Za,{size:14})}),t.aktif?e.jsx(y,{size:"sm",variant:"outline",onClick:G=>{G.stopPropagation(),ve(t)},className:"text-orange-600 border-orange-300 hover:bg-orange-50 h-8 px-3",title:"AnlaÅŸmayÄ± Kapat",children:"Kapa"}):e.jsx(y,{size:"sm",variant:"outline",onClick:G=>{G.stopPropagation(),ne(t.id)},className:"text-red-600 border-red-300 hover:bg-red-50 h-8 px-2",title:"Sil",children:e.jsx(ua,{size:14})})]})})]},t.id)})]},`group-${a.id}`)}),(()=>{const a=$.filter(i=>!i.ekGelirDetay&&!te(i.id));if(a.length===0)return null;const o=fa.has("UNGROUPED");return e.jsxs(as.Fragment,{children:[e.jsx(ie,{className:"bg-gradient-to-r from-gray-100 to-gray-50 border-t-2 border-gray-300 hover:from-gray-200 hover:to-gray-100 cursor-pointer",onClick:()=>Se("UNGROUPED"),children:e.jsx(n,{colSpan:13,className:"py-3",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[o?e.jsx(ts,{size:20,className:"text-gray-700"}):e.jsx(ss,{size:20,className:"text-gray-700"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{variant:"outline",className:"bg-gray-200 text-gray-700 border-gray-400",children:"GruplanmamÄ±ÅŸ KayÄ±tlar"}),e.jsxs("span",{className:"text-sm text-gray-600",children:[a.length," kayÄ±t"]})]})]})})})},"ungrouped-header"),!o&&a.map(i=>{var Ce,Me,Ye,He;const t=i.kartProgramIds||i.bankIds||[],R=te(i.id),ce=!!R;return e.jsxs(ie,{className:"hover:bg-gray-50",children:[e.jsx(n,{className:"py-4",children:e.jsx(ae,{checked:O.includes(i.id),disabled:ce,onCheckedChange:B=>{Ae(),f(B?[...O,i.id]:O.filter(je=>je!==i.id)),Fe()},title:ce?`Bu kayÄ±t "${R==null?void 0:R.name}" grubuna aittir`:""})}),e.jsx(n,{className:"py-4",children:e.jsx("span",{className:"text-xs text-gray-400",children:"-"})}),e.jsx(n,{className:"py-4",children:e.jsx("span",{className:"text-xs text-gray-400",children:"-"})}),e.jsx(n,{className:"py-4",children:i.kisaAciklama?e.jsx(c,{variant:"outline",className:"bg-amber-50 text-amber-700 border-amber-300 text-xs",children:i.kisaAciklama}):e.jsx("span",{className:"text-xs text-gray-400",children:"-"})}),e.jsx(n,{className:"py-4",children:i.urun?e.jsx(c,{variant:"outline",className:"bg-indigo-50 text-indigo-700 border-indigo-300",children:ba(i.urun)}):e.jsx("span",{className:"text-xs text-gray-400",children:"-"})}),e.jsx(n,{className:"py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:i.gelirModeli.ad}),((Ce=i.gelirModeli.ad)==null?void 0:Ce.toLowerCase().includes("paÃ§al"))&&e.jsx(c,{variant:"outline",className:"bg-purple-50 text-purple-700 border-purple-300 text-xs",children:"Auto"}),i.ekGelirDetay&&e.jsx(c,{variant:"outline",className:"bg-green-50 text-green-700 border-green-300 text-xs",children:i.ekGelirDetay.gelirTuru})]})}),e.jsx(n,{className:"py-4",children:t.includes("ALL")?e.jsx(c,{variant:"default",className:"bg-blue-600",children:"Hepsi"}):t.length>0?e.jsxs("div",{className:"flex flex-wrap gap-1",children:[t.slice(0,2).map(B=>{const je=b.find(Ne=>Ne.id===B),G=A.find(Ne=>Ne.id===B);return je?e.jsx(c,{variant:"outline",className:"text-xs",children:je.kartAdi},B):G?e.jsx(c,{variant:"outline",className:"text-xs bg-yellow-50",children:G.kod},B):null}),t.length>2&&e.jsxs(c,{variant:"secondary",className:"text-xs",children:["+",t.length-2]})]}):e.jsx("span",{className:"text-xs text-gray-400",children:"-"})}),e.jsx(n,{className:"py-4",children:e.jsx(c,{variant:i.yurtIciDisi==="Yurt Ä°Ã§i"?"default":"secondary",children:i.yurtIciDisi})}),e.jsx(n,{className:"py-4",children:e.jsx(c,{variant:i.kartTipi==="Credit"?"default":i.kartTipi==="Debit"?"secondary":"outline",className:(Me=i.kartTipi)!=null&&Me.includes("PaÃ§al")?"bg-purple-100 text-purple-700 border-purple-300":"",children:((Ye=i.kartTipi)==null?void 0:Ye.replace(" (TÃ¼m Kart Tipleri)",""))||i.kartTipi})}),e.jsx(n,{className:"py-4",children:e.jsx("div",{className:"space-y-1.5",children:i.komisyonOranlarÄ±.filter(B=>B.aktif!==!1).length>0?e.jsx("div",{className:"flex flex-col gap-0.5",children:i.komisyonOranlarÄ±.filter(B=>B.aktif!==!1).map((B,je)=>e.jsx("div",{className:"text-xs text-blue-700",children:B.vade.replace(" (PeÅŸin)","")},je))}):e.jsx("span",{className:"text-xs text-gray-400",children:"-"})})}),e.jsx(n,{className:"py-4",children:e.jsx("div",{className:"text-xs space-y-1.5",children:i.gelirModeli.ad==="Hazine Geliri"?e.jsxs("div",{className:"flex items-center justify-between gap-2 bg-blue-50 px-2 py-1.5 rounded",children:[e.jsx("span",{className:"text-gray-700",children:"KazanÃ§:"}),e.jsxs("span",{className:"text-blue-700",children:[parseFloat(((He=i.hazineGeliri)==null?void 0:He.kazancTL)||"0").toFixed(2),"â‚º"]})]}):i.gelirModeli.ad==="Gelir OrtaklÄ±ÄŸÄ±"?e.jsx("div",{className:"flex flex-col gap-1.5",children:i.komisyonOranlarÄ±.filter(B=>B.aktif!==!1).map((B,je)=>{const G=Ne=>!Ne||Ne===""?"0,00":parseFloat(Ne).toFixed(2).replace(".",",");return e.jsxs("div",{className:"flex flex-col gap-0.5 px-2 py-1.5 rounded bg-gray-50",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("span",{className:"text-gray-600",children:"AlÄ±ÅŸ:"}),e.jsxs("span",{className:"text-red-600",children:["%",G(B.alisTL)]})]}),e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("span",{className:"text-gray-600",children:"SatÄ±ÅŸ:"}),e.jsxs("span",{className:"text-green-600",children:["%",G(B.satisTL)]})]}),e.jsxs("div",{className:"flex items-center justify-between gap-2 border-t pt-0.5",children:[e.jsx("span",{className:"text-gray-600",children:"KazanÃ§:"}),e.jsxs("span",{className:"text-blue-600",children:["%",G(B.karTL)]})]})]},je)})}):e.jsx("div",{className:"flex flex-col gap-0.5",children:i.komisyonOranlarÄ±.filter(B=>B.aktif!==!1).map((B,je)=>{const G=B.vade.replace(" (PeÅŸin)","");return e.jsxs("div",{className:"text-blue-700",children:[G,":%",B.oran]},je)})})})}),e.jsx(n,{className:"py-4",children:e.jsxs("div",{className:"text-xs space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("span",{className:"text-gray-600",children:[L,":"]}),e.jsxs("span",{className:"text-blue-700",children:["%",i.paylaÅŸÄ±mOranlarÄ±.kurulusOrani]})]}),e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("span",{className:"text-gray-600",children:"OXÄ°VO:"}),e.jsxs("span",{className:"text-indigo-700",children:["%",i.paylaÅŸÄ±mOranlarÄ±.oxivoOrani]})]})]})}),e.jsx(n,{className:"py-4",children:e.jsxs("div",{className:"text-xs space-y-1",children:[e.jsx("div",{className:"text-gray-600",children:new Date(i.olusturmaTarihi).toLocaleDateString("tr-TR")}),i.kapanmaTarihi&&e.jsx("div",{children:e.jsxs(c,{variant:"outline",className:"bg-orange-50 text-orange-700 border-orange-300 text-xs",children:["KapanÄ±ÅŸ: ",new Date(i.kapanmaTarihi).toLocaleDateString("tr-TR")]})})]})}),e.jsx(n,{className:"py-4",onClick:B=>B.stopPropagation(),children:e.jsxs("div",{className:"flex flex-col gap-1.5",children:[i.aktif?e.jsx(y,{size:"sm",variant:"default",className:"bg-green-600 hover:bg-green-700 h-8 px-3",onClick:B=>{B.stopPropagation(),ye(i.id)},title:"Aktif - Kapat",children:"âœ“ Aktif"}):e.jsx(y,{size:"sm",variant:"secondary",className:"bg-orange-100 text-orange-700 hover:bg-orange-200 h-8 px-3",onClick:B=>{B.stopPropagation(),ye(i.id)},title:"KapalÄ± - AÃ§",children:"ðŸ”’ Kapa"}),e.jsx(y,{size:"sm",variant:"outline",onClick:B=>{B.stopPropagation(),ja(i)},title:"GÃ¼ncelle",className:"h-8 px-2",children:e.jsx(Za,{size:14})}),i.aktif?e.jsx(y,{size:"sm",variant:"outline",onClick:B=>{B.stopPropagation(),ve(i)},className:"text-orange-600 border-orange-300 hover:bg-orange-50 h-8 px-3",title:"AnlaÅŸmayÄ± Kapat",children:"Kapa"}):e.jsx(y,{size:"sm",variant:"outline",onClick:B=>{B.stopPropagation(),ne(i.id)},className:"text-red-600 border-red-300 hover:bg-red-50 h-8 px-2",title:"Sil",children:e.jsx(ua,{size:14})})]})})]},i.id)})]},"ungrouped-section")})()]})]}),$.filter(a=>a.ekGelirDetay).length>0&&e.jsxs("div",{className:"mt-8 space-y-4",children:[e.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-blue-50 border border-purple-200 rounded-lg p-4",children:[e.jsxs("h3",{className:"text-purple-900 flex items-center gap-2",children:[e.jsx("span",{className:"text-xl",children:"ðŸ’°"}),"Ek Gelir DetaylarÄ±"]}),e.jsx("p",{className:"text-sm text-purple-700 mt-1",children:"AÅŸaÄŸÄ±daki tabloda ek geliri olan TABELA kayÄ±tlarÄ± gÃ¶sterilmektedir"})]}),e.jsx("div",{className:"border rounded-lg overflow-hidden bg-white",children:e.jsxs(sa,{children:[e.jsx(la,{children:e.jsxs(ie,{className:"bg-gray-50",children:[e.jsx(g,{className:"w-12",children:"SeÃ§im"}),e.jsx(g,{children:"KLM"}),e.jsx(g,{children:"Grup"}),e.jsx(g,{children:"KÄ±sa AÃ§Ä±klama"}),e.jsx(g,{children:"ÃœrÃ¼n"}),e.jsx(g,{children:"Gelir Modeli"}),e.jsx(g,{children:"Gelir TÃ¼rÃ¼"}),e.jsx(g,{children:"KullanÄ±m"}),e.jsx(g,{children:"Kart Tipi"}),e.jsx(g,{className:"text-right",children:"Tutar"}),e.jsx(g,{className:"text-right",children:"PF%"}),e.jsx(g,{className:"text-right",children:"PF-TL"}),e.jsx(g,{className:"text-right",children:"OX %"}),e.jsx(g,{className:"text-right",children:"OX TL"}),e.jsx(g,{className:"text-center",children:"Ä°ÅŸlemler"})]})}),e.jsxs(ia,{children:[j.map(a=>{const o=$.filter(t=>{var R;return t.ekGelirDetay&&((R=te(t.id))==null?void 0:R.id)===a.id});if(o.length===0)return null;const i=fa.has(a.id);return e.jsxs(as.Fragment,{children:[e.jsx(ie,{className:"bg-gradient-to-r from-purple-100 to-purple-50 border-t-2 border-purple-300 hover:from-purple-200 hover:to-purple-100 cursor-pointer",onClick:()=>Se(a.id),children:e.jsx(n,{colSpan:15,className:"py-3",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[i?e.jsx(ts,{size:20,className:"text-purple-700"}):e.jsx(ss,{size:20,className:"text-purple-700"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{variant:"default",className:"bg-purple-600 text-white",children:a.name}),e.jsxs("span",{className:"text-sm text-purple-800",children:[o.length," ek gelir kaydÄ±"]}),!a.aktif&&e.jsx(c,{variant:"secondary",className:"bg-gray-400 text-white text-xs",children:"Pasif"})]})]})})})},`ekgelir-group-header-${a.id}`),!i&&a.aktif!==!1&&o.map((t,R)=>{var Ce,Me,Ye,He,B,je,G,Ne,Ke,fe,Ma,Ha,Ia,za,na;const ce=te(t.id);return e.jsxs(ie,{className:"hover:bg-gray-50 bg-purple-50/20",children:[e.jsx(n,{className:"py-4",children:e.jsx(ae,{checked:O.includes(t.id),disabled:!!ce,onCheckedChange:ke=>{Ae(),f(ke?[...O,t.id]:O.filter(Ue=>Ue!==t.id)),Fe()},title:ce?`Bu kayÄ±t "${ce==null?void 0:ce.name}" grubuna aittir`:""})}),e.jsx(n,{className:"py-4",children:e.jsx(c,{variant:"outline",className:"bg-slate-50 text-slate-700 border-slate-300 font-mono text-xs",children:String(R+10).padStart(2,"0")})}),e.jsx(n,{className:"py-4",children:ce?e.jsx(c,{variant:"default",className:"bg-blue-600 text-white",children:we(ce.name)}):e.jsx("span",{className:"text-xs text-gray-400",children:"-"})}),e.jsx(n,{className:"py-4",children:t.kisaAciklama?e.jsx(c,{variant:"outline",className:"bg-amber-50 text-amber-700 border-amber-300 text-xs",children:t.kisaAciklama}):e.jsx("span",{className:"text-xs text-gray-400",children:"-"})}),e.jsx(n,{className:"py-4",children:e.jsx(c,{variant:"outline",className:"bg-indigo-50 text-indigo-700 border-indigo-300",children:ba(t.urun||"")})}),e.jsx(n,{className:"py-4",children:e.jsx("span",{children:t.gelirModeli.ad})}),e.jsx(n,{className:"py-4",children:e.jsx(c,{variant:"outline",className:"bg-purple-50 text-purple-700 border-purple-300",children:(Ce=t.ekGelirDetay)==null?void 0:Ce.gelirTuru})}),e.jsx(n,{className:"py-4",children:e.jsx(c,{variant:((Me=t.ekGelirDetay)==null?void 0:Me.kullanim)==="Yurt Ä°Ã§i"?"default":"secondary",children:(Ye=t.ekGelirDetay)==null?void 0:Ye.kullanim})}),e.jsx(n,{className:"py-4",children:e.jsx(c,{variant:((He=t.ekGelirDetay)==null?void 0:He.kartTipi)==="Credit"?"default":((B=t.ekGelirDetay)==null?void 0:B.kartTipi)==="Debit"?"secondary":"outline",className:(G=(je=t.ekGelirDetay)==null?void 0:je.kartTipi)!=null&&G.includes("PaÃ§al")?"bg-purple-100 text-purple-700 border-purple-300":"",children:((Ke=(Ne=t.ekGelirDetay)==null?void 0:Ne.kartTipi)==null?void 0:Ke.replace(" (TÃ¼m Kart Tipleri)",""))||((fe=t.ekGelirDetay)==null?void 0:fe.kartTipi)})}),e.jsx(n,{className:"text-right",children:e.jsxs("span",{className:"text-sm bg-purple-50 px-2 py-1 rounded",children:[parseFloat(((Ma=t.ekGelirDetay)==null?void 0:Ma.tutar)||"0").toFixed(2),"â‚º"]})}),e.jsx(n,{className:"text-right",onClick:ke=>ke.stopPropagation(),children:e.jsx(V,{type:"number",step:"0.01",value:((Ha=t.ekGelirDetay)==null?void 0:Ha.pfYuzde)||"0",onClick:ke=>ke.stopPropagation(),onFocus:ke=>{ke.stopPropagation(),Ae()},onMouseDown:ke=>ke.stopPropagation(),onChange:ke=>{var _a;ke.stopPropagation(),Ae();const Ue=ke.target.value,us=parseFloat(((_a=t.ekGelirDetay)==null?void 0:_a.tutar)||"0"),hs=parseFloat(Ue)||0,gs=(us*hs/100).toFixed(2),ps=H.map(da=>da.id===t.id?{...da,ekGelirDetay:{...da.ekGelirDetay,pfYuzde:Ue,pfTL:gs},paylaÅŸÄ±mOranlarÄ±:{...da.paylaÅŸÄ±mOranlarÄ±,kurulusOrani:Ue}}:da);v&&v(ps),Fe()},className:"w-24 text-right"})}),e.jsx(n,{className:"text-right",children:e.jsxs("span",{className:"text-sm bg-green-50 px-2 py-1 rounded",children:[parseFloat(((Ia=t.ekGelirDetay)==null?void 0:Ia.pfTL)||"0").toFixed(2),"â‚º"]})}),e.jsx(n,{className:"text-right",onClick:ke=>ke.stopPropagation(),children:e.jsx(V,{type:"number",step:"0.01",value:((za=t.ekGelirDetay)==null?void 0:za.oxYuzde)||"0",onClick:ke=>ke.stopPropagation(),onFocus:ke=>{ke.stopPropagation(),Ae()},onMouseDown:ke=>ke.stopPropagation(),onChange:ke=>{var _a;ke.stopPropagation(),Ae();const Ue=ke.target.value,us=parseFloat(((_a=t.ekGelirDetay)==null?void 0:_a.tutar)||"0"),hs=parseFloat(Ue)||0,gs=(us*hs/100).toFixed(2),ps=H.map(da=>da.id===t.id?{...da,ekGelirDetay:{...da.ekGelirDetay,oxYuzde:Ue,oxTL:gs},paylaÅŸÄ±mOranlarÄ±:{...da.paylaÅŸÄ±mOranlarÄ±,oxivoOrani:Ue}}:da);v&&v(ps),Fe()},className:"w-24 text-right"})}),e.jsx(n,{className:"text-right",children:e.jsxs("span",{className:"text-sm bg-blue-50 px-2 py-1 rounded",children:[parseFloat(((na=t.ekGelirDetay)==null?void 0:na.oxTL)||"0").toFixed(2),"â‚º"]})}),e.jsx(n,{children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(y,{size:"sm",variant:"ghost",onClick:()=>ja(t),title:"DÃ¼zenle",className:"text-blue-600",children:e.jsx(Za,{size:14})}),e.jsx(y,{size:"sm",variant:"ghost",onClick:()=>ne(t.id),title:"Sil",className:"text-red-600",children:e.jsx(ua,{size:14})})]})})]},t.id)})]},`ekgelir-group-${a.id}`)}),(()=>{const a=$.filter(i=>i.ekGelirDetay&&!te(i.id));if(a.length===0)return null;const o=fa.has("UNGROUPED");return e.jsxs(as.Fragment,{children:[e.jsx(ie,{className:"bg-gradient-to-r from-gray-100 to-gray-50 border-t-2 border-gray-300 hover:from-gray-200 hover:to-gray-100 cursor-pointer",onClick:()=>Se("UNGROUPED"),children:e.jsx(n,{colSpan:15,className:"py-3",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[o?e.jsx(ts,{size:20,className:"text-gray-700"}):e.jsx(ss,{size:20,className:"text-gray-700"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{variant:"outline",className:"bg-gray-200 text-gray-700 border-gray-400",children:"GruplanmamÄ±ÅŸ Ek Gelir KayÄ±tlarÄ±"}),e.jsxs("span",{className:"text-sm text-gray-600",children:[a.length," kayÄ±t"]})]})]})})})},"ungrouped-ekgelir-header"),!o&&a.map(i=>{var R,ce,Ce,Me,Ye,He,B,je,G,Ne;const t=te(i.id);return e.jsxs(ie,{className:"hover:bg-gray-50",children:[e.jsx(n,{className:"py-4",children:e.jsx(ae,{checked:O.includes(i.id),disabled:!!t,onCheckedChange:Ke=>{Ae(),f(Ke?[...O,i.id]:O.filter(fe=>fe!==i.id)),Fe()},title:t?`Bu kayÄ±t "${t==null?void 0:t.name}" grubuna aittir`:""})}),e.jsx(n,{className:"py-4",children:e.jsx("span",{className:"text-xs text-gray-400",children:"-"})}),e.jsx(n,{className:"py-4",children:e.jsx("span",{className:"text-xs text-gray-400",children:"-"})}),e.jsx(n,{className:"py-4",children:i.kisaAciklama?e.jsx(c,{variant:"outline",className:"bg-amber-50 text-amber-700 border-amber-300 text-xs",children:i.kisaAciklama}):e.jsx("span",{className:"text-xs text-gray-400",children:"-"})}),e.jsx(n,{className:"py-4",children:i.urun?e.jsx(c,{variant:"outline",className:"bg-indigo-50 text-indigo-700 border-indigo-300",children:ba(i.urun)}):e.jsx("span",{className:"text-xs text-gray-400",children:"-"})}),e.jsx(n,{className:"py-4",children:e.jsx(c,{variant:"outline",className:"bg-green-50 text-green-700 border-green-300",children:i.gelirModeli.ad})}),e.jsx(n,{className:"py-4",children:e.jsx(c,{variant:"outline",className:"bg-purple-50 text-purple-700 border-purple-300",children:((R=i.ekGelirDetay)==null?void 0:R.gelirTuru)||"-"})}),e.jsx(n,{className:"py-4",children:e.jsx(c,{variant:((ce=i.ekGelirDetay)==null?void 0:ce.kullanim)==="Yurt Ä°Ã§i"?"default":"secondary",children:((Ce=i.ekGelirDetay)==null?void 0:Ce.kullanim)||"-"})}),e.jsx(n,{className:"py-4",children:e.jsx(c,{variant:"outline",className:"bg-purple-100 text-purple-700 border-purple-300",children:(Me=i.ekGelirDetay)!=null&&Me.kartTipi?i.ekGelirDetay.kartTipi.split(" (")[0]:"-"})}),e.jsx(n,{className:"text-right",children:e.jsxs("span",{className:"text-sm bg-purple-50 px-2 py-1 rounded",children:[parseFloat(((Ye=i.ekGelirDetay)==null?void 0:Ye.tutar)||"0").toFixed(2),"â‚º"]})}),e.jsx(n,{className:"text-right",children:e.jsxs("span",{className:"text-xs",children:[parseFloat(((He=i.ekGelirDetay)==null?void 0:He.pfYuzde)||"0").toFixed(2),"%"]})}),e.jsx(n,{className:"text-right",children:e.jsx(V,{type:"number",step:"0.01",min:"0",max:"100",value:parseFloat(((B=i.ekGelirDetay)==null?void 0:B.pfYuzde)||"0").toFixed(2),onChange:Ke=>{var na,ke;Ae();const fe=Ke.target.value,Ma=parseFloat(((na=i.ekGelirDetay)==null?void 0:na.tutar)||"0"),Ha=(Ma*parseFloat(fe)/100).toFixed(2),Ia=parseFloat(((ke=i.ekGelirDetay)==null?void 0:ke.oxYuzde)||"0");(Ma*Ia/100).toFixed(2);const za=H.map(Ue=>Ue.id===i.id?{...Ue,ekGelirDetay:{...Ue.ekGelirDetay,pfYuzde:fe,pfTL:Ha},paylaÅŸÄ±mOranlarÄ±:{...Ue.paylaÅŸÄ±mOranlarÄ±,kurulusOrani:fe}}:Ue);v&&v(za),Fe()},className:"w-24 text-right"})}),e.jsx(n,{className:"text-right",children:e.jsxs("span",{className:"text-sm bg-green-50 px-2 py-1 rounded",children:[parseFloat(((je=i.ekGelirDetay)==null?void 0:je.pfTL)||"0").toFixed(2),"â‚º"]})}),e.jsx(n,{className:"text-right",children:e.jsx(V,{type:"number",step:"0.01",min:"0",max:"100",value:parseFloat(((G=i.ekGelirDetay)==null?void 0:G.oxYuzde)||"0").toFixed(2),onChange:Ke=>{var za;Ae();const fe=Ke.target.value,Ha=(parseFloat(((za=i.ekGelirDetay)==null?void 0:za.tutar)||"0")*parseFloat(fe)/100).toFixed(2),Ia=H.map(na=>na.id===i.id?{...na,ekGelirDetay:{...na.ekGelirDetay,oxYuzde:fe,oxTL:Ha},paylaÅŸÄ±mOranlarÄ±:{...na.paylaÅŸÄ±mOranlarÄ±,oxivoOrani:fe}}:na);v&&v(Ia),Fe()},className:"w-24 text-right"})}),e.jsx(n,{className:"text-right",children:e.jsxs("span",{className:"text-sm bg-blue-50 px-2 py-1 rounded",children:[parseFloat(((Ne=i.ekGelirDetay)==null?void 0:Ne.oxTL)||"0").toFixed(2),"â‚º"]})}),e.jsx(n,{children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(y,{size:"sm",variant:"ghost",onClick:()=>ja(i),title:"DÃ¼zenle",className:"text-blue-600",children:e.jsx(Za,{size:14})}),e.jsx(y,{size:"sm",variant:"ghost",onClick:()=>ne(i.id),title:"Sil",className:"text-red-600",children:e.jsx(ua,{size:14})})]})})]},i.id)})]},"ungrouped-ekgelir-section")})()]})]})})]}),e.jsx(Da,{open:p,onOpenChange:K,children:e.jsxs(Oa,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(wa,{children:[e.jsx(Sa,{children:N?"TABELA KaydÄ±nÄ± DÃ¼zenle":"Yeni TABELA KaydÄ±"}),e.jsxs(Ca,{children:[L," iÃ§in TABELA bilgilerini giriniz (AdÄ±m ",X,"/9)"]})]}),e.jsxs("div",{className:"space-y-6 py-4",children:[re&&N&&(()=>{const a=te(N.id);return a?e.jsx("div",{className:"bg-orange-50 border-2 border-orange-300 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"text-2xl",children:"ðŸ”’"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm text-orange-900 mb-1",children:[e.jsx("strong",{children:"GruplanmÄ±ÅŸ KayÄ±t:"}),' Bu TABELA kaydÄ± "',a.name,'" grubuna aittir']}),e.jsx("p",{className:"text-xs text-orange-700",children:"GruplanmÄ±ÅŸ kayÄ±tlarÄ±n temel ayarlarÄ± (ÃœrÃ¼n, Gelir Modeli, Kart ProgramlarÄ±, Yurt Ä°Ã§i/DÄ±ÅŸÄ±, Kart Tipi) deÄŸiÅŸtirilemez. Sadece komisyon oranlarÄ±, paylaÅŸÄ±m oranlarÄ± ve aÃ§Ä±klama gÃ¼ncellenebilir."})]})]})}):null})(),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"KuruluÅŸ:"}),e.jsx("span",{className:"ml-2 font-medium",children:L}),e.jsx("span",{className:"ml-4 text-xs bg-blue-600 text-white px-2 py-1 rounded",children:Y})]})}),X===0&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-lg font-semibold",children:"AdÄ±m 1/10: KÄ±sa AÃ§Ä±klama (Opsiyonel)"}),e.jsx("p",{className:"text-sm text-gray-600",children:"TABELA kaydÄ± iÃ§in kÄ±sa bir aÃ§Ä±klama girebilirsiniz (maksimum 15 karakter)"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{children:"AÃ§Ä±klama (Opsiyonel - Maksimum 15 karakter)"}),e.jsx(V,{value:Ta,onChange:a=>{const o=a.target.value;o.length<=15&&Ie(o)},placeholder:"aÃ§Ä±klamanÄ±z varsa",maxLength:15}),e.jsxs("p",{className:"text-xs text-gray-500",children:[Ta.length,"/15 karakter"]})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:e.jsx("p",{className:"text-sm text-blue-800",children:"ðŸ’¡ Bu alan opsiyoneldir. TABELA kaydÄ±nÄ±z iÃ§in kÄ±sa bir aï¿½ï¿½Ä±klama girebilirsiniz."})})]}),X===1&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h4",{className:"text-lg font-semibold",children:["AdÄ±m 2/10: ÃœrÃ¼n ve Gelir Modeli ",re&&e.jsx("span",{className:"text-orange-600",children:"(Kilitli)"})]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[L," iÃ§in Ã¼rÃ¼n tipi ve gelir modelini seÃ§iniz"]}),e.jsx(Pa,{label:"ÃœrÃ¼n",options:[{value:"UnattendedPOS",label:"UnattendedPOS"},{value:"AttendedPOS",label:"AttendedPOS"},{value:"SoftPOS",label:"SoftPOS"},{value:"SanalPOS",label:"SanalPOS"}],value:ee,onChange:a=>Aa(a),placeholder:"ÃœrÃ¼n seÃ§iniz",disabled:re,error:re?"ðŸ”’ Bu alan gruplanmÄ±ÅŸ kayÄ±t olduÄŸu iÃ§in deÄŸiÅŸtirilemez":void 0}),e.jsxs("div",{className:"space-y-2",children:[!re&&e.jsx("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-3",children:e.jsxs("p",{className:"text-sm text-purple-800",children:["ðŸ’¡ ",e.jsx("strong",{children:"Ã–nemli:"}),' "PaÃ§al" iÃ§eren gelir modelleri seÃ§ildiÄŸinde, kart tipi otomatik olarak ',e.jsx("strong",{children:'"PaÃ§al"'})," olarak ayarlanÄ±r."]})}),M.length===0?e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-red-700 font-medium",children:"âš ï¸ Gelir Modeli BulunamadÄ±"}),e.jsx("p",{className:"text-sm text-red-600 mt-2",children:"HenÃ¼z hiÃ§ gelir modeli tanÄ±mlanmamÄ±ÅŸ. LÃ¼tfen Ã¶nce TanÄ±mlar modÃ¼lÃ¼nden gelir modeli ekleyiniz."}),e.jsx(y,{size:"sm",variant:"outline",className:"mt-3",onClick:()=>{P.info("TanÄ±mlar > Gelir Modelleri bÃ¶lÃ¼mÃ¼ne gidiniz")},children:"NasÄ±l Eklerim?"})]}):pa.length===0?e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-yellow-700 font-medium",children:"âš ï¸ Aktif Gelir Modeli BulunamadÄ±"}),e.jsxs("p",{className:"text-sm text-yellow-600 mt-2",children:["Toplam ",M.length," gelir modeli var ama hiÃ§biri aktif deÄŸil. Pasif modeller:"]}),e.jsx("ul",{className:"list-disc list-inside text-sm text-yellow-600 mt-2",children:M.map(a=>e.jsx("li",{children:a.ad},a.id))})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx(Pa,{label:"Gelir Modeli",options:pa.map(a=>{var o,i,t,R;return{value:a.id,label:(a.ad||"")+((o=a.ad)!=null&&o.toLowerCase().includes("paÃ§al")?" ðŸ”’":""),description:(i=a.ad)!=null&&i.toLowerCase().includes("paÃ§al")?'Kart tipi otomatik "PaÃ§al" olarak ayarlanÄ±r':(t=a.ad)!=null&&t.toLowerCase().includes("hazine")?"Sabit tutar bazlÄ± gelir modeli":(R=a.ad)!=null&&R.toLowerCase().includes("ortaklÄ±")?"AlÄ±ÅŸ-satÄ±ÅŸ farkÄ± bazlÄ± gelir modeli":"Komisyon oranÄ± bazlÄ± gelir modeli"}}),value:Xe,onChange:ta,placeholder:"Gelir modeli seÃ§iniz",disabled:re,error:re?"ðŸ”’ Bu alan gruplanmÄ±ÅŸ kayÄ±t olduÄŸu iÃ§in deÄŸiÅŸtirilemez":void 0,required:!0}),Xe&&!re&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 text-sm text-blue-700",children:["ðŸ’¡ SeÃ§ilen: ",e.jsx("strong",{children:(Ze=pa.find(a=>a.id===Xe))==null?void 0:Ze.ad})]})]}),Be&&!re&&e.jsx("p",{className:"text-xs text-purple-600 mt-1",children:'âœ“ PaÃ§al gelir modeli seÃ§ildi - Kart tipi otomatik "PaÃ§al" olacaktÄ±r'})]}),Xe&&ee&&(()=>{const a=pa.find(i=>i.id===Xe);if(!a)return null;const o=Fa.filter(i=>i.gelirModeli===a.ad&&i.urun===ee);return o.length===0?null:e.jsxs("div",{className:"space-y-2",children:[e.jsx(Pa,{label:"Ä°lgili Ek Gelirler (Opsiyonel)",options:[{value:"NONE",label:"SeÃ§im yapma (yok)"},...o.map(i=>({value:i.id,label:`${i.gelirTuru} + ${i.kullanim}`}))],value:Re,onChange:ra,placeholder:"Ek gelir seÃ§mek isterseniz buradan seÃ§in",disabled:re,error:re?"ðŸ”’ Bu alan gruplanmÄ±ÅŸ kayÄ±t olduÄŸu iÃ§in deÄŸiÅŸtirilemez":void 0}),Re&&Re!=="NONE"&&e.jsx("p",{className:"text-xs text-green-600 mt-1",children:"âœ“ Ek gelir seÃ§ildi"})]})})()]}),X===2&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h4",{className:"text-lg font-semibold",children:["AdÄ±m 3/10: Kart Program SeÃ§imi ",re&&e.jsx("span",{className:"text-orange-600",children:"(Kilitli)"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Bu TABELA'nÄ±n geÃ§erli olacaÄŸÄ± kart programlarÄ±nÄ± seÃ§iniz"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{children:"Bu TABELA'nÄ±n geÃ§erli olduÄŸu kart programlarÄ±nÄ± seÃ§iniz"}),e.jsxs("div",{className:`flex items-center gap-2 p-3 border rounded-lg ${re?"bg-orange-50 border-orange-300":"bg-blue-50 border-blue-200"}`,children:[e.jsx(ae,{id:"all-kart-programs",checked:be.includes("ALL"),disabled:re,onCheckedChange:a=>{ca(a?["ALL"]:[])}}),e.jsxs(U,{htmlFor:"all-kart-programs",className:`flex-1 ${re?"cursor-not-allowed":"cursor-pointer"}`,children:[e.jsx("span",{className:"font-medium",children:"Hepsi"}),e.jsx("span",{className:"text-xs text-gray-600 ml-2",children:"(TÃ¼m kart programlarÄ± iÃ§in geÃ§erli)"})]})]}),Qa.length===0?e.jsx("div",{className:"text-sm text-gray-500 p-4 text-center border rounded-lg",children:"TanÄ±mlar modÃ¼lÃ¼nde aktif kart programÄ± bulunamadÄ±"}):e.jsx("div",{className:"border rounded-lg divide-y",style:{maxHeight:"60vh",overflowY:"auto"},children:Qa.map(a=>e.jsxs("div",{className:`flex items-center gap-2 p-3 ${re?"bg-orange-50/50":"hover:bg-gray-50"}`,children:[e.jsx(ae,{id:`kart-program-${a.id}`,checked:be.includes(a.id)&&!be.includes("ALL"),disabled:be.includes("ALL")||re,onCheckedChange:o=>{ca(o?[...be.filter(i=>i!=="ALL"),a.id]:be.filter(i=>i!==a.id))}}),e.jsx(U,{htmlFor:`kart-program-${a.id}`,className:`flex-1 ${re?"cursor-not-allowed":"cursor-pointer"}`,children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:"font-medium",children:a.kartAdi})})})]},a.id))}),be.length>0&&e.jsxs("div",{className:`text-sm p-2 rounded ${re?"text-orange-600 bg-orange-50":"text-green-600 bg-green-50"}`,children:[re?"ðŸ”’":"âœ“"," ",be.includes("ALL")?"TÃ¼m kart programlarÄ±":`${be.length} kart programÄ±`," seÃ§ildi",re&&" (deÄŸiÅŸtirilemez)"]})]})]}),X===3&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h4",{children:["AdÄ±m 4/10: Yurt Ä°Ã§i / Yurt DÄ±ÅŸÄ± ",re&&e.jsx("span",{className:"text-orange-600",children:"(Kilitli)"})]}),e.jsx(Pa,{label:"Yurt Ä°Ã§i / Yurt DÄ±ÅŸÄ±",options:[{value:"Yurt Ä°Ã§i",label:"Yurt Ä°Ã§i"},{value:"Yurt DÄ±ÅŸÄ±",label:"Yurt DÄ±ÅŸÄ±"}],value:ha,onChange:a=>qa(a),placeholder:"SeÃ§iniz",disabled:re,error:re?"ðŸ”’ Bu alan gruplanmÄ±ÅŸ kayÄ±t olduÄŸu iÃ§in deÄŸiÅŸtirilemez":void 0})]}),X===4&&(pa.find(a=>a.id===Xe),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h4",{children:["AdÄ±m 5/10: Kart Tipi SeÃ§imi ",re&&e.jsx("span",{className:"text-orange-600",children:"(Kilitli)"})]}),Be&&!re&&e.jsx("div",{className:"bg-purple-50 border-2 border-purple-300 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"text-2xl",children:"ðŸ”’"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm text-purple-900 mb-1",children:[e.jsx("strong",{children:"Otomatik Ayar:"})," PaÃ§al gelir modeli seÃ§ildi"]}),e.jsxs("p",{className:"text-xs text-purple-700",children:["Kart tipi otomatik olarak ",e.jsx("strong",{children:'"PaÃ§al"'})," olarak ayarlanmÄ±ÅŸtÄ±r ve deÄŸiÅŸtirilemez."]})]})]})}),e.jsx(Pa,{label:e.jsxs("span",{children:["Kart Tipi",Be&&!re&&e.jsx("span",{className:"text-purple-600",children:" (Otomatik)"}),re&&e.jsx("span",{className:"text-orange-600",children:" (Kilitli)"})]}),options:[{value:"Credit",label:"Credit"},{value:"Debit",label:"Debit"},{value:"PaÃ§al",label:"PaÃ§al"}],value:$e,onChange:a=>ea(a),placeholder:"Kart tipi seÃ§iniz",disabled:Be||re,error:Be&&!re?"âœ“ Bu alan otomatik olarak ayarlanmÄ±ÅŸtÄ±r ve deÄŸiÅŸtirilemez":re?"ðŸ”’ Bu alan gruplanmÄ±ÅŸ kayÄ±t olduÄŸu iÃ§in deÄŸiÅŸtirilemez":void 0})]})),X===5&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{children:"AdÄ±m 6/10: Vade SeÃ§imi"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(U,{children:"Kullanmak istediÄŸiniz vadeleri seÃ§iniz"}),e.jsx("div",{className:"border rounded-lg overflow-hidden",children:e.jsxs(sa,{children:[e.jsx(la,{children:e.jsxs(ie,{className:"bg-gray-50",children:[e.jsx(g,{className:"w-12 text-center",children:"Aktif"}),e.jsx(g,{children:"Vade"})]})}),e.jsx(ia,{children:Qe.map((a,o)=>e.jsxs(ie,{className:a.aktif?"":"bg-gray-50",children:[e.jsx(n,{className:"text-center",children:e.jsx(ae,{checked:a.aktif,onCheckedChange:i=>{const t=[...Qe];t[o].aktif=i===!0,Na(t)}})}),e.jsx(n,{className:a.aktif?"":"line-through text-gray-400",children:a.vade.replace(" (PeÅŸin)","")})]},o))})]})}),e.jsx("p",{className:"text-xs text-gray-500",children:"ðŸ’¡ KullanÄ±lmayacak vadelerin iÅŸaretini kaldÄ±rabilirsiniz"})]})]}),X===6&&(()=>{var o,i;const a=((o=Ve==null?void 0:Ve.ad)==null?void 0:o.toLowerCase().includes("sabit komisyon"))||((i=Ve==null?void 0:Ve.ad)==null?void 0:i.toLowerCase())==="sabit komisyon"||!1;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h4",{children:["AdÄ±m 7/10: ",a?"Kar (Komisyon OranlarÄ±)":"AlÄ±ÅŸ, SatÄ±ÅŸ ve Kar (Komisyon OranlarÄ±)"]}),e.jsx("div",{className:"space-y-3",children:a?e.jsxs(e.Fragment,{children:[e.jsx(U,{children:"Her vade iÃ§in Kar (Komisyon) oranÄ±nÄ± giriniz"}),e.jsx("div",{className:"border rounded-lg overflow-hidden",children:e.jsxs(sa,{children:[e.jsx(la,{children:e.jsxs(ie,{className:"bg-gray-50",children:[e.jsx(g,{children:"Vade"}),e.jsx(g,{className:"text-right bg-green-50",children:"Kar (Komisyon %)"})]})}),e.jsx(ia,{children:Qe.filter(t=>t.aktif).map((t,R)=>e.jsxs(ie,{children:[e.jsx(n,{children:t.vade.replace(" (PeÅŸin)","")}),e.jsx(n,{children:e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-green-700",children:"%"}),e.jsx(V,{type:"number",step:"0.01",placeholder:"0,00",value:t.oran||"",onChange:ce=>{const Ce=[...Qe],Me=Qe.findIndex(Ye=>Ye.vade===t.vade);Ce[Me].oran=ce.target.value,Na(Ce)},className:"text-right pl-8 bg-green-50"})]})})]},R))})]})}),e.jsx("p",{className:"text-xs text-green-600",children:"ðŸ’¡ Sabit komisyon oranÄ±nÄ± her vade iÃ§in doÄŸrudan girebilirsiniz"})]}):e.jsxs(e.Fragment,{children:[e.jsx(U,{children:"Her vade iÃ§in AlÄ±ÅŸ ve SatÄ±ÅŸ oranlarÄ±nÄ± giriniz - Kar (Komisyon) otomatik hesaplanÄ±r"}),e.jsx("div",{className:"border rounded-lg overflow-hidden",children:e.jsxs(sa,{children:[e.jsx(la,{children:e.jsxs(ie,{className:"bg-gray-50",children:[e.jsx(g,{children:"Vade"}),e.jsx(g,{className:"text-right",children:"AlÄ±ÅŸ (%)"}),e.jsx(g,{className:"text-right",children:"SatÄ±ÅŸ (%)"}),e.jsx(g,{className:"text-right bg-green-50",children:"Kar (Komisyon %)"})]})}),e.jsx(ia,{children:Qe.filter(t=>t.aktif).map((t,R)=>{const ce=parseFloat(t.alisTL||"0"),Me=parseFloat(t.satisTL||"0")-ce,Ye=Me>0?Me.toFixed(2):"0.00";return e.jsxs(ie,{children:[e.jsx(n,{children:t.vade.replace(" (PeÅŸin)","")}),e.jsx(n,{children:e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500",children:"%"}),e.jsx(V,{type:"number",step:"0.01",placeholder:"0,00",value:t.alisTL||"",onChange:He=>{const B=[...Qe],je=Qe.findIndex(fe=>fe.vade===t.vade);B[je].alisTL=He.target.value;const G=parseFloat(He.target.value||"0"),Ke=parseFloat(B[je].satisTL||"0")-G;B[je].karTL=Ke>0?Ke.toFixed(2):"0.00",Na(B)},className:"text-right pl-8"})]})}),e.jsx(n,{children:e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500",children:"%"}),e.jsx(V,{type:"number",step:"0.01",placeholder:"0,00",value:t.satisTL||"",onChange:He=>{const B=[...Qe],je=Qe.findIndex(fe=>fe.vade===t.vade);B[je].satisTL=He.target.value;const G=parseFloat(B[je].alisTL||"0"),Ke=parseFloat(He.target.value||"0")-G;B[je].karTL=Ke>0?Ke.toFixed(2):"0.00",Na(B)},className:"text-right pl-8"})]})}),e.jsx(n,{children:e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-green-700",children:"%"}),e.jsx(V,{type:"text",value:Ye,readOnly:!0,disabled:!0,className:"text-right pl-8 bg-green-50 text-green-700"})]})})]},R)})})]})}),e.jsx("p",{className:"text-xs text-green-600",children:"ðŸ’¡ Kar (Komisyon) = SatÄ±ÅŸ - AlÄ±ÅŸ olarak otomatik hesaplanÄ±r ve bu deÄŸer komisyon oranÄ± olarak kullanÄ±lÄ±r"})]})})]})})(),X===7&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{children:"AdÄ±m 8/10: PaylaÅŸÄ±m OranlarÄ±"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(U,{children:[oe==="Banka"?"EPK":"PF"," PaylaÅŸÄ±m OranÄ± (%)"]}),e.jsx(V,{type:"number",step:"0.01",placeholder:"50.00",value:ka,onChange:a=>Ja(a.target.value)}),e.jsx("p",{className:"text-xs text-gray-500",children:"KuruluÅŸa ait gelir paylaÅŸÄ±m yÃ¼zdesi"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{children:"OXÄ°VO PaylaÅŸÄ±m OranÄ± (%)"}),e.jsx(V,{type:"number",step:"0.01",placeholder:"50.00",value:ga,onChange:a=>Ba(a.target.value)}),e.jsx("p",{className:"text-xs text-gray-500",children:"OXÄ°VO'ya ait gelir paylaÅŸÄ±m yÃ¼zdesi"})]})]}),ka&&ga&&e.jsx("div",{className:`p-3 rounded text-sm ${parseFloat(ka)+parseFloat(ga)===100?"bg-green-50 text-green-700 border border-green-200":"bg-orange-50 text-orange-700 border border-orange-200"}`,children:parseFloat(ka)+parseFloat(ga)===100?"âœ“ Toplam: 100% - DoÄŸru!":`âš ï¸ Toplam: ${(parseFloat(ka)+parseFloat(ga)).toFixed(2)}% - ToplamÄ±n 100% olmasÄ± Ã¶nerilir`})]}),X===8&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{children:"AdÄ±m 9/10: AÃ§Ä±klama (Opsiyonel)"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{children:"AÃ§Ä±klama / Not"}),e.jsx(ms,{placeholder:"Bu TABELA kaydÄ± ile ilgili notlarÄ±nÄ±zÄ± buraya ekleyebilirsiniz...",value:ls,onChange:a=>Wa(a.target.value),rows:5,className:"resize-none"}),e.jsx("p",{className:"text-xs text-gray-500",children:"ðŸ’¡ Bu alan isteÄŸe baÄŸlÄ±dÄ±r"})]})]}),X===9&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{children:"AdÄ±m 10/10: FotoÄŸraf YÃ¼kleme (Opsiyonel)"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{children:"TABELA FotoÄŸrafÄ±"}),e.jsx("div",{className:"border-2 border-dashed rounded-lg p-6 text-center",children:aa?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative inline-block",children:[e.jsx("img",{src:aa,alt:"TABELA FotoÄŸraf",className:"max-h-64 rounded border"}),e.jsx(y,{size:"sm",variant:"destructive",onClick:()=>va(""),className:"absolute top-2 right-2",children:e.jsx(xs,{size:16})})]}),e.jsx("p",{className:"text-sm text-green-600",children:"âœ“ FotoÄŸraf yÃ¼klendi"})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsx(il,{size:48,className:"mx-auto text-gray-300"}),e.jsxs("div",{children:[e.jsxs(U,{htmlFor:"fotograf-upload",className:"cursor-pointer inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(es,{size:18}),e.jsx("span",{children:"FotoÄŸraf SeÃ§"})]}),e.jsx(V,{id:"fotograf-upload",type:"file",accept:"image/*",onChange:Q,className:"hidden"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Maksimum 2MB, JPG/PNG formatÄ±nda"})]})})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"ðŸ’¡ Bu alan isteÄŸe baÄŸlÄ±dÄ±r"})]})]})]}),e.jsxs(Ea,{children:[e.jsx(y,{variant:"outline",onClick:s,children:"Ä°ptal"}),X>0&&e.jsx(y,{variant:"outline",onClick:S,children:"Geri"}),X<9?e.jsx(y,{onClick:h,children:"Ä°leri"}):e.jsx(y,{onClick:de,children:N?"GÃ¼ncelle":"Kaydet"})]})]})}),e.jsx(Da,{open:ge,onOpenChange:E,children:e.jsxs(Oa,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(wa,{children:[e.jsx(Sa,{children:pe?"TABELA Grubunu DÃ¼zenle":"Yeni TABELA Grubu OluÅŸtur"}),e.jsx(Ca,{children:"Birden fazla TABELA kaydÄ±nÄ± gruplandÄ±rarak yÃ¶netimi kolaylaÅŸtÄ±rÄ±n"})]}),e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{children:"Grup Bilgileri"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{children:"Grup Ä°smi *"}),e.jsx(V,{placeholder:"Ã–rn: 2024 Q1 TABELA KayÄ±tlarÄ±",value:l,onChange:a=>d(a.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{children:"GeÃ§erlilik BaÅŸlangÄ±Ã§ *"}),e.jsx(V,{type:"date",value:z,onChange:a=>u(a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{children:"GeÃ§erlilik BitiÅŸ"}),e.jsx(V,{type:"date",value:xe,onChange:a=>m(a.target.value),placeholder:"SÃ¼resiz iÃ§in boÅŸ bÄ±rakÄ±n"}),e.jsx("p",{className:"text-xs text-gray-500",children:"BoÅŸ bÄ±rakÄ±lÄ±rsa sÃ¼resiz olarak kabul edilir"})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg border border-gray-200",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(U,{htmlFor:"group-aktif",className:"cursor-pointer",children:"Grup Durumu"}),e.jsx("p",{className:"text-xs text-gray-500",children:F?"Grup aktif - HakediÅŸ iÃ§in kullanÄ±labilir":"Grup pasif - HakediÅŸ iÃ§in kullanÄ±lamaz"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`text-sm ${F?"text-green-600":"text-gray-400"}`,children:F?"Aktif":"Pasif"}),e.jsx(Bs,{id:"group-aktif",checked:F,onCheckedChange:Ee})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{children:"TABELA KayÄ±tlarÄ± SeÃ§imi *"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{type:"button",variant:"outline",size:"sm",onClick:()=>{if(q.length===0)return;const a={};q.forEach(t=>{const ce=(t.kartProgramIds||t.bankIds||[]).sort().join(",");a[ce]||(a[ce]=[]),a[ce].push(t.id)});let o=0,i=[];Object.entries(a).forEach(([t,R])=>{R.length>o&&(o=R.length,i=R)}),i.length>1?(f(i),P.success(`${i.length} adet benzer TABELA kaydÄ± Ã¶nerildi`)):P.info("Otomatik gruplama iÃ§in yeterli benzer kayÄ±t bulunamadÄ±")},children:"âœ¨ Otomatik Ã–ner"}),e.jsxs(c,{variant:"secondary",children:[O.length," kayÄ±t seÃ§ildi"]})]})]}),q.length>0&&e.jsxs("div",{className:"flex items-start gap-2 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx(oa,{size:16,className:"text-blue-600 mt-0.5 flex-shrink-0"}),e.jsxs("p",{className:"text-xs text-blue-700",children:["Sadece ",e.jsx("strong",{children:"baÅŸka gruplara atanmamÄ±ÅŸ ve aktif"})," olan TABELA kayÄ±tlarÄ± gÃ¶steriliyor. Toplam ",q.length," kayÄ±t seÃ§ilebilir.",H.filter(a=>a.aktif).length-q.length>0&&e.jsxs("span",{className:"block mt-1",children:["(",H.filter(a=>a.aktif).length-q.length," kayÄ±t zaten baÅŸka gruplarda)"]})]})]}),q.length===0?e.jsx("div",{className:"text-sm text-gray-500 p-4 text-center border rounded-lg",children:pe?"Gruba eklenebilecek aktif TABELA kaydÄ± bulunamadÄ± (tÃ¼m kayÄ±tlar baÅŸka gruplarda)":"Gruplama iÃ§in mÃ¼sait aktif TABELA kaydÄ± bulunamadÄ± (tÃ¼m kayÄ±tlar baÅŸka gruplarda veya pasif)"}):e.jsxs("div",{className:"border rounded-lg divide-y",style:{maxHeight:"60vh",overflowY:"auto"},children:[e.jsx("div",{className:"p-3 bg-gray-50 sticky top-0 z-10",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{checked:q.length>0&&q.every(a=>O.includes(a.id)),onCheckedChange:a=>{Ae(),f(a?q.map(o=>o.id):[]),Fe()}}),e.jsxs(U,{className:"cursor-pointer flex-1",children:["TÃ¼mÃ¼nÃ¼ SeÃ§ (",q.length," kayÄ±t)"]})]})}),q.map(a=>{const o=a.kartProgramIds||a.bankIds||[];return e.jsxs("div",{className:"flex items-start gap-3 p-3 hover:bg-gray-50",children:[e.jsx(ae,{id:`group-record-${a.id}`,checked:O.includes(a.id),onCheckedChange:i=>{Ae(),f(i?[...O,a.id]:O.filter(t=>t!==a.id)),Fe()}}),e.jsx(U,{htmlFor:`group-record-${a.id}`,className:"cursor-pointer flex-1",children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.urun&&e.jsx(c,{variant:"outline",className:"text-xs bg-indigo-50",children:a.urun}),e.jsx(c,{variant:"outline",className:"text-xs",children:a.gelirModeli.ad}),e.jsx(c,{variant:a.kartTipi==="Credit"?"default":a.kartTipi==="Debit"?"secondary":"outline",className:"text-xs",children:a.kartTipi}),e.jsx(c,{variant:"outline",className:"text-xs",children:a.yurtIciDisi})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[o.includes("ALL")?e.jsx("span",{children:"TÃ¼m kart programlarÄ±"}):o.length>0?e.jsxs("span",{children:[o.length," kart programÄ±"]}):e.jsx("span",{children:"Kart programÄ± seÃ§ilmemiÅŸ"})," â€¢ ",e.jsxs("span",{children:["OluÅŸturma: ",a.olusturmaTarihi]})]})]})})]},a.id)})]})]})]}),e.jsxs(Ea,{children:[e.jsx(y,{variant:"outline",onClick:()=>{E(!1),f([]),d(""),u(""),m(""),Ee(!0),We(null)},children:"Ä°ptal"}),e.jsx(y,{onClick:qe,children:pe?"GÃ¼ncelle":"Grup OluÅŸtur"})]})]})}),e.jsx(Da,{open:Es,onOpenChange:I,children:e.jsxs(Oa,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(wa,{children:[e.jsx(Sa,{children:"ðŸ“Š TABELA HiyerarÅŸik YapÄ±"}),e.jsx(Ca,{children:"TABELA sayfasÄ±nÄ±n veri yapÄ±sÄ± ve iliÅŸkileri"})]}),e.jsxs("div",{className:"space-y-6 mt-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"flex items-center gap-2",children:[e.jsx(oa,{size:18,className:"text-blue-600"}),"Genel HiyerarÅŸi"]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200 font-mono text-xs space-y-1",children:[e.jsx("div",{children:"Banka/PF ModÃ¼lÃ¼"}),e.jsx("div",{className:"pl-4",children:"â””â”€â”€ Firma Detay SayfasÄ±"}),e.jsx("div",{className:"pl-8",children:"â”œâ”€â”€ TABELA Tab"}),e.jsx("div",{className:"pl-12",children:"â”‚   â”œâ”€â”€ ðŸ“‹ TABELA GruplarÄ±"}),e.jsx("div",{className:"pl-16",children:'â”‚   â”‚   â”œâ”€â”€ Grup 1 (Ã–rn: "2024 Q1 AnlaÅŸmalarÄ±")'}),e.jsx("div",{className:"pl-20",children:"â”‚   â”‚   â”‚   â”œâ”€â”€ GeÃ§erlilik: 2024-01-01 â†’ 2024-03-31"}),e.jsx("div",{className:"pl-20",children:"â”‚   â”‚   â”‚   â”œâ”€â”€ Durum: Aktif/Pasif"}),e.jsx("div",{className:"pl-20",children:"â”‚   â”‚   â”‚   â””â”€â”€ ðŸ”— TABELA KayÄ±tlarÄ± (1-N)"}),e.jsx("div",{className:"pl-12",children:"â”‚   â””â”€â”€ ðŸ“ TABELA KayÄ±tlarÄ±"}),e.jsx("div",{className:"pl-16",children:"â”‚       â”œâ”€â”€ KayÄ±t DetaylarÄ±"}),e.jsx("div",{className:"pl-20",children:"â”‚       â”‚   â”œâ”€â”€ KÄ±sa AÃ§Ä±klama"}),e.jsx("div",{className:"pl-20",children:"â”‚       â”‚   â”œâ”€â”€ ÃœrÃ¼n (UnattendedPOS, AttendedPOS...)"}),e.jsx("div",{className:"pl-20",children:"â”‚       â”‚   â”œâ”€â”€ Kart Tipi (Credit, Debit, PaÃ§al)"}),e.jsx("div",{className:"pl-20",children:"â”‚       â”‚   â”œâ”€â”€ Gelir Modeli"}),e.jsx("div",{className:"pl-20",children:"â”‚       â”‚   â””â”€â”€ Durum (Aktif/KapalÄ±)"}),e.jsx("div",{className:"pl-16",children:"â”‚       â”œâ”€â”€ Komisyon OranlarÄ± (Vade BazlÄ±)"}),e.jsx("div",{className:"pl-20",children:"â”‚       â”‚   â”œâ”€â”€ D+1, D+7, D+14, D+31"}),e.jsx("div",{className:"pl-16",children:"â”‚       â””â”€â”€ PaylaÅŸÄ±m OranlarÄ±"}),e.jsx("div",{className:"pl-20",children:"â”‚           â”œâ”€â”€ KuruluÅŸ OranÄ± (%)"}),e.jsx("div",{className:"pl-20",children:"â”‚           â””â”€â”€ OXIVO OranÄ± (%)"}),e.jsx("div",{className:"pl-8",children:"â””â”€â”€ HakediÅŸ Tab"}),e.jsx("div",{className:"pl-12",children:"â””â”€â”€ ðŸ’° HakediÅŸ KayÄ±tlarÄ±"}),e.jsx("div",{className:"pl-16",children:"â”œâ”€â”€ TABELA Grup BazlÄ±"}),e.jsx("div",{className:"pl-16",children:"â”œâ”€â”€ DÃ¶nem (Ay/YÄ±l)"}),e.jsx("div",{className:"pl-16",children:"â””â”€â”€ Durum (Taslak/KesinleÅŸmiÅŸ)"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"flex items-center gap-2",children:[e.jsx(oa,{size:18,className:"text-blue-600"}),"Ã–nemli Ä°liÅŸkiler"]}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsx("div",{className:"bg-blue-50 p-3 rounded-lg border border-blue-200",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-600",children:"â€¢"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("strong",{children:"TABELA â†’ Grup:"})," Bir TABELA kaydÄ± birden fazla gruba ait olabilir (Many-to-Many)"]})]})}),e.jsx("div",{className:"bg-green-50 p-3 rounded-lg border border-green-200",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-600",children:"â€¢"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("strong",{children:"Grup â†’ HakediÅŸ:"})," Bir grup birden fazla hakediÅŸ kaydÄ±na sahip olabilir (One-to-Many)"]})]})}),e.jsx("div",{className:"bg-purple-50 p-3 rounded-lg border border-purple-200",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-purple-600",children:"â€¢"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("strong",{children:"Firma â†’ TABELA:"})," Bir firma birden fazla TABELA kaydÄ±na sahip olabilir (One-to-Many)"]})]})})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"flex items-center gap-2",children:[e.jsx(oa,{size:18,className:"text-blue-600"}),"Temel KullanÄ±m SenaryolarÄ±"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"bg-gray-50 p-3 rounded-lg border border-gray-200",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-orange-600",children:"1."}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsx("strong",{children:"Yeni AnlaÅŸma Ekleme:"}),e.jsxs("div",{className:"text-gray-600 pl-4 space-y-0.5",children:[e.jsx("div",{children:"â€¢ TABELA tab'Ä±na git"}),e.jsx("div",{children:'â€¢ "Yeni TABELA KaydÄ±" butonuna tÄ±kla'}),e.jsx("div",{children:"â€¢ Form adÄ±mlarÄ±nÄ± doldur (10 adÄ±m)"}),e.jsx("div",{children:"â€¢ Kaydet"})]})]})]})}),e.jsx("div",{className:"bg-gray-50 p-3 rounded-lg border border-gray-200",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-orange-600",children:"2."}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsx("strong",{children:"DÃ¶nemsel Gruplama:"}),e.jsxs("div",{className:"text-gray-600 pl-4 space-y-0.5",children:[e.jsx("div",{children:"â€¢ TABELA kayÄ±tlarÄ±nÄ± seÃ§ (Checkbox)"}),e.jsx("div",{children:'â€¢ "Grup OluÅŸtur" butonuna tÄ±kla'}),e.jsx("div",{children:"â€¢ Grup bilgilerini gir (ad, geÃ§erlilik tarihleri)"}),e.jsx("div",{children:"â€¢ Kaydet"})]})]})]})}),e.jsx("div",{className:"bg-gray-50 p-3 rounded-lg border border-gray-200",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-orange-600",children:"3."}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsx("strong",{children:"AylÄ±k HakediÅŸ Hesaplama:"}),e.jsxs("div",{className:"text-gray-600 pl-4 space-y-0.5",children:[e.jsx("div",{children:"â€¢ HakediÅŸ tab'Ä±na geÃ§"}),e.jsx("div",{children:'â€¢ "Yeni HakediÅŸ OluÅŸtur" butonuna tÄ±kla'}),e.jsx("div",{children:"â€¢ TABELA grubunu seÃ§ (sadece aktif gruplar)"}),e.jsx("div",{children:"â€¢ Her kayÄ±t iÃ§in vade bazlÄ± iÅŸlem hacmi gir"}),e.jsx("div",{children:"â€¢ Sistem otomatik hesaplar (KazanÃ§, PF/OXIVO paylarÄ±)"}),e.jsx("div",{children:'â€¢ "Taslak Kaydet" veya "KesinleÅŸtir"'})]})]})]})})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"flex items-center gap-2",children:[e.jsx(oa,{size:18,className:"text-blue-600"}),"Veri Modelleri"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"bg-blue-50 p-3 rounded-lg border border-blue-200",children:e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsx("strong",{children:"TabelaRecord (TABELA KaydÄ±)"}),e.jsxs("div",{className:"text-gray-700 pl-4 text-xs space-y-0.5 font-mono",children:[e.jsx("div",{children:"â€¢ id, kurulus, urun, kartTipi"}),e.jsx("div",{children:"â€¢ gelirModeli, kartProgramIds"}),e.jsx("div",{children:"â€¢ komisyonOranlarÄ± (vade bazlÄ±)"}),e.jsx("div",{children:"â€¢ paylaÅŸÄ±mOranlarÄ±"}),e.jsx("div",{children:"â€¢ kisaAciklama, olusturmaTarihi"}),e.jsx("div",{children:"â€¢ aktif, kapanmaTarihi"})]})]})}),e.jsx("div",{className:"bg-green-50 p-3 rounded-lg border border-green-200",children:e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsx("strong",{children:"TabelaGroup (TABELA Grubu)"}),e.jsxs("div",{className:"text-gray-700 pl-4 text-xs space-y-0.5 font-mono",children:[e.jsx("div",{children:"â€¢ id, name"}),e.jsx("div",{children:"â€¢ gecerlilikBaslangic, gecerlilikBitis"}),e.jsx("div",{children:"â€¢ recordIds (kayÄ±t ID dizisi)"}),e.jsx("div",{children:"â€¢ pinned (sabitlenmiÅŸ mi?)"}),e.jsx("div",{children:"â€¢ aktif (grup aktif/pasif)"})]})]})}),e.jsx("div",{className:"bg-purple-50 p-3 rounded-lg border border-purple-200",children:e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsx("strong",{children:"HakedisRecord (HakediÅŸ KaydÄ±)"}),e.jsxs("div",{className:"text-gray-700 pl-4 text-xs space-y-0.5 font-mono",children:[e.jsx("div",{children:"â€¢ id, tabelaGroupId, tabelaGroupAd"}),e.jsx("div",{children:"â€¢ donem (YYYY-MM)"}),e.jsx("div",{children:"â€¢ islemHacmiMap (vade bazlÄ±)"}),e.jsx("div",{children:"â€¢ pfIslemHacmi, oxivoIslemHacmi"}),e.jsx("div",{children:"â€¢ durum (Taslak/KesinleÅŸmiÅŸ)"}),e.jsx("div",{children:"â€¢ olusturmaTarihi, guncellemeTarihi"})]})]})})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"flex items-center gap-2",children:[e.jsx(oa,{size:18,className:"text-blue-600"}),"Gelir Modelleri"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"bg-amber-50 p-3 rounded-lg border border-amber-200",children:e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsx("strong",{children:"Sabit Komisyon"}),e.jsx("div",{className:"text-gray-700 pl-4 text-xs",children:"KazanÃ§ = Ä°ÅŸlem Hacmi Ã— (Komisyon OranÄ± / 100)"})]})}),e.jsx("div",{className:"bg-teal-50 p-3 rounded-lg border border-teal-200",children:e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsx("strong",{children:"Gelir OrtaklÄ±ÄŸÄ±"}),e.jsx("div",{className:"text-gray-700 pl-4 text-xs",children:"KazanÃ§ = SatÄ±ÅŸ TL - AlÄ±ÅŸ TL"})]})}),e.jsx("div",{className:"bg-indigo-50 p-3 rounded-lg border border-indigo-200",children:e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsx("strong",{children:"Hazine Geliri (Ek Gelir)"}),e.jsx("div",{className:"text-gray-700 pl-4 text-xs",children:"Ã–zel hesaplama mantÄ±ÄŸÄ± ile"})]})})]})]})]}),e.jsx(Ea,{children:e.jsx(y,{onClick:()=>I(!1),children:"Kapat"})})]})}),e.jsx(fs,{open:!!Z,onOpenChange:()=>ve(null),children:e.jsxs(Ts,{children:[e.jsxs(As,{children:[e.jsx(Fs,{children:"TABELA AnlaÅŸmasÄ±nÄ± Kapat"}),e.jsx(Ks,{children:"Bu TABELA anlaÅŸmasÄ±nÄ± kapatmak istediÄŸinizden emin misiniz?"})]}),e.jsx("div",{className:"mt-4 p-4 bg-orange-50 border border-orange-200 rounded-lg",children:e.jsxs("div",{className:"space-y-2 text-sm",children:[(Z==null?void 0:Z.urun)&&e.jsxs("div",{children:[e.jsx("strong",{children:"ÃœrÃ¼n:"})," ",Z.urun]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Gelir Modeli:"})," ",Z==null?void 0:Z.gelirModeli.ad]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Kart Tipi:"})," ",Z==null?void 0:Z.kartTipi]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Yurt Ä°Ã§i/DÄ±ÅŸÄ±:"})," ",Z==null?void 0:Z.yurtIciDisi]}),e.jsxs("div",{children:[e.jsx("strong",{children:"OluÅŸturma Tarihi:"})," ",Z==null?void 0:Z.olusturmaTarihi]})]})}),e.jsx("p",{className:"mt-4 text-sm text-orange-600",children:'âš ï¸ KapatÄ±lan anlaÅŸma "KapalÄ±" durumuna alÄ±nacak ve kapanma tarihi kaydedilecektir.'}),e.jsxs(zs,{children:[e.jsx(Ps,{children:"Ä°ptal"}),e.jsx(Ls,{onClick:me,className:"bg-orange-600 hover:bg-orange-700",children:"AnlaÅŸmayÄ± Kapat"})]})]})})]})}function ol({banks:w,epkList:L=[],okList:oe=[],selectedBankIds:Y,selectedEPKIds:M=[],selectedOKIds:D=[],onSelectedBanksChange:A,onSelectedEPKsChange:b,onSelectedOKsChange:H,onSave:j}){const[v,T]=x.useState(""),[he,r]=x.useState(""),[p,K]=x.useState(""),[N,W]=x.useState(!1),X=w.filter(d=>d.aktif),C=L.filter(d=>d.aktif),Z=oe.filter(d=>d.aktif),ve=X.filter(d=>{var z,u;return((z=d.bankaAdi)==null?void 0:z.toLowerCase().includes(v.toLowerCase()))||((u=d.kod)==null?void 0:u.toLowerCase().includes(v.toLowerCase()))}),J=C.filter(d=>{var z,u;return((z=d.kurumAdi)==null?void 0:z.toLowerCase().includes(he.toLowerCase()))||((u=d.kod)==null?void 0:u.toLowerCase().includes(he.toLowerCase()))}),Te=Z.filter(d=>{var z,u;return((z=d.kurumAdi)==null?void 0:z.toLowerCase().includes(p.toLowerCase()))||((u=d.kod)==null?void 0:u.toLowerCase().includes(p.toLowerCase()))}),ge=d=>{const z=Y.includes(d)?Y.filter(u=>u!==d):[...Y,d];A(z),N||P.info("DeÄŸiÅŸikliklerinizi kaydetmeyi unutmayÄ±n!",{duration:3e3}),W(!0)},E=d=>{if(!b)return;const z=M.includes(d)?M.filter(u=>u!==d):[...M,d];b(z),N||P.info("DeÄŸiÅŸikliklerinizi kaydetmeyi unutmayÄ±n!",{duration:3e3}),W(!0)},O=d=>{if(!H)return;const z=D.includes(d)?D.filter(u=>u!==d):[...D,d];H(z),N||P.info("DeÄŸiÅŸikliklerinizi kaydetmeyi unutmayÄ±n!",{duration:3e3}),W(!0)},f=()=>{j&&(j(),W(!1),P.success("Kategoriler kaydedildi"))},l=Y.length+M.length+D.length;return X.length===0&&C.length===0&&Z.length===0?e.jsx(se,{children:e.jsxs(le,{className:"py-12 text-center",children:[e.jsx(ds,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-gray-600 mb-2",children:"Kategori TanÄ±mlanmamÄ±ÅŸ"}),e.jsx("p",{className:"text-sm text-gray-500",children:"LÃ¼tfen Ã¶nce TanÄ±mlar modÃ¼lÃ¼nden Banka, EPK veya Ã–K ekleyiniz."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(se,{children:[e.jsx(De,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(Oe,{children:"AnlaÅŸmalÄ± Bankalar & Ã–deme KuruluÅŸlarÄ±"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Firma ile anlaÅŸmalÄ± olan Banka, EPK ve Ã–K kategorilerini seÃ§iniz"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex gap-2",children:[Y.length>0&&e.jsxs(c,{variant:"default",className:"bg-blue-600",children:["ðŸ¦ ",Y.length]}),M.length>0&&e.jsxs(c,{variant:"default",className:"bg-green-600",children:["EPK ",M.length]}),D.length>0&&e.jsxs(c,{variant:"default",className:"bg-purple-600",children:["Ã–K ",D.length]}),l===0&&e.jsx(c,{variant:"secondary",children:"SeÃ§im yapÄ±lmadÄ±"})]}),N&&e.jsxs(y,{onClick:f,className:"flex items-center gap-2",children:[e.jsx(cs,{size:18}),e.jsx("span",{children:"Kaydet"})]})]})]})}),e.jsx(le,{children:e.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between pb-2 border-b-2 border-blue-500",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(sl,{className:"text-blue-600",size:20}),e.jsx("h3",{className:"font-semibold text-blue-900",children:"Bankalar"})]}),e.jsxs(c,{variant:"outline",className:"bg-blue-50 text-blue-700",children:[Y.length," seÃ§ili"]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(La,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:16}),e.jsx(V,{id:"firma-bankalar-bank-search",type:"text",placeholder:"Banka ara...",value:v,onChange:d=>T(d.target.value),className:"pl-9 h-9 text-sm"})]}),e.jsx("div",{className:"border rounded-lg divide-y",style:{maxHeight:"60vh",overflowY:"auto"},children:ve.length===0?e.jsx("div",{className:"p-6 text-center text-sm text-gray-500",children:X.length===0?"TanÄ±mlÄ± banka yok":"SonuÃ§ bulunamadÄ±"}):ve.map(d=>e.jsx("div",{className:`p-3 hover:bg-blue-50 transition-colors cursor-pointer ${Y.includes(d.id)?"bg-blue-50":""}`,onClick:()=>ge(d.id),children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ae,{id:`bank-${d.id}`,checked:Y.includes(d.id),onCheckedChange:()=>ge(d.id),onClick:z=>z.stopPropagation(),className:"mt-0.5"}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"text-sm truncate",title:d.bankaAdi,children:[e.jsx("span",{className:"text-xs text-gray-500",children:d.kod}),e.jsx("span",{className:"ml-1",children:d.bankaAdi})]})})]})},d.id))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between pb-2 border-b-2 border-green-500",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(al,{className:"text-green-600",size:20}),e.jsx("h3",{className:"font-semibold text-green-900",children:"EPK"})]}),e.jsxs(c,{variant:"outline",className:"bg-green-50 text-green-700",children:[M.length," seÃ§ili"]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(La,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:16}),e.jsx(V,{id:"firma-bankalar-epk-search",type:"text",placeholder:"EPK ara...",value:he,onChange:d=>r(d.target.value),className:"pl-9 h-9 text-sm"})]}),e.jsx("div",{className:"border rounded-lg divide-y",style:{maxHeight:"60vh",overflowY:"auto"},children:J.length===0?e.jsx("div",{className:"p-6 text-center text-sm text-gray-500",children:C.length===0?"TanÄ±mlÄ± EPK yok":"SonuÃ§ bulunamadÄ±"}):J.map(d=>e.jsx("div",{className:`p-3 hover:bg-green-50 transition-colors cursor-pointer ${M.includes(d.id)?"bg-green-50":""}`,onClick:()=>E(d.id),children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ae,{id:`epk-${d.id}`,checked:M.includes(d.id),onCheckedChange:()=>E(d.id),onClick:z=>z.stopPropagation(),className:"mt-0.5"}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"text-sm truncate",title:d.kurumAdi,children:[e.jsx("span",{className:"text-xs text-gray-500",children:d.kod}),e.jsx("span",{className:"ml-1",children:d.kurumAdi})]})})]})},d.id))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between pb-2 border-b-2 border-purple-500",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(tl,{className:"text-purple-600",size:20}),e.jsx("h3",{className:"font-semibold text-purple-900",children:"Ã–K"})]}),e.jsxs(c,{variant:"outline",className:"bg-purple-50 text-purple-700",children:[D.length," seÃ§ili"]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(La,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:16}),e.jsx(V,{id:"firma-bankalar-ok-search",type:"text",placeholder:"Ã–K ara...",value:p,onChange:d=>K(d.target.value),className:"pl-9 h-9 text-sm"})]}),e.jsx("div",{className:"border rounded-lg divide-y",style:{maxHeight:"60vh",overflowY:"auto"},children:Te.length===0?e.jsx("div",{className:"p-6 text-center text-sm text-gray-500",children:Z.length===0?"TanÄ±mlÄ± Ã–K yok":"SonuÃ§ bulunamadÄ±"}):Te.map(d=>e.jsx("div",{className:`p-3 hover:bg-purple-50 transition-colors cursor-pointer ${D.includes(d.id)?"bg-purple-50":""}`,onClick:()=>O(d.id),children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ae,{id:`ok-${d.id}`,checked:D.includes(d.id),onCheckedChange:()=>O(d.id),onClick:z=>z.stopPropagation(),className:"mt-0.5"}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"text-sm truncate",title:d.kurumAdi,children:[e.jsx("span",{className:"text-xs text-gray-500",children:d.kod}),e.jsx("span",{className:"ml-1",children:d.kurumAdi})]})})]})},d.id))})]})]})})]}),e.jsx(se,{className:"bg-blue-50 border-blue-200",children:e.jsx(le,{className:"py-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ds,{className:"text-blue-600 mt-1",size:20}),e.jsxs("div",{className:"text-sm text-blue-900",children:[e.jsx("p",{className:"font-medium mb-1",children:"Bilgilendirme:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-blue-800",children:[e.jsx("li",{children:"SeÃ§tiÄŸiniz bankalar, bu firma iÃ§in TABELA kayÄ±tlarÄ±nÄ±n geÃ§erli olacaÄŸÄ± bankalarÄ± belirtir."}),e.jsx("li",{children:"Sadece TanÄ±mlar modÃ¼lÃ¼nde aktif olarak tanÄ±mlanmÄ±ÅŸ bankalar listelenir."}),e.jsx("li",{children:"Birden fazla banka seÃ§ebilirsiniz."}),e.jsxs("li",{children:["DeÄŸiÅŸikliklerinizi kaydetmek iÃ§in yukarÄ±daki ",e.jsx("strong",{children:'"Kaydet"'})," butonuna tÄ±klayÄ±n."]})]})]})]})})})]})}function ul({tabelaRecords:w,tabelaGroups:L=[],kurumAdi:oe,hakedisRecords:Y,onHakedisRecordsChange:M}){var Ka,re,Ga,ja;const[D,A]=x.useState("list"),[b,H]=x.useState(null),[j,v]=x.useState(""),[T,he]=x.useState(new Date().toISOString().slice(0,7)),[r,p]=x.useState("TÃ¼m Vadeler"),[K,N]=x.useState({}),[W,X]=x.useState(""),[C,Z]=x.useState("Taslak"),[ve,J]=x.useState(""),[Te,ge]=x.useState(""),[E,O]=x.useState(""),[f,l]=x.useState(""),[d,z]=x.useState(""),[u,xe]=x.useState("all"),[m,F]=x.useState("all"),[Ee,pe]=x.useState(!1),[We,fa]=x.useState(null),[Cs,Es]=x.useState(!1),[I,Ta]=x.useState({klm:!0,grup:!0,kisaAciklama:!0,urun:!0,gelirModeli:!0,kartProg:!0,kullanim:!0,kartTipi:!0,islemHacmi:!0,vade:!0,kazancTL:!0,oxivoPayi:!0}),Ie=s=>{Ta(h=>({...h,[s]:!h[s]}))},[ee,Aa]=x.useState({klm:!0,grup:!0,kisaAciklama:!0,urun:!0,gelirModeli:!0,kartProg:!0,kullanim:!0,kartTipi:!0,islemHacmi:!0}),$e=s=>{Aa(h=>({...h,[s]:!h[s]}))},[ea,Xe]=x.useState(!1),ta=x.useMemo(()=>L.filter(s=>s.aktif),[L]),Re=x.useMemo(()=>{if(!j)return[];const s=L.find(h=>h.id===j);return s?w.filter(h=>s.recordIds.includes(h.id)&&!h.kapanmaTarihi):[]},[w,L,j]),ra=x.useMemo(()=>Re.filter(s=>!s.ekGelirDetay),[Re]),be=x.useMemo(()=>Re.filter(s=>s.ekGelirDetay),[Re]),ca=x.useMemo(()=>{const s=new Set(Y.map(h=>h.donem.split("-")[0]));return Array.from(s).sort().reverse()},[Y]),ha=x.useMemo(()=>{let s=[...Y];return u!=="all"&&(s=s.filter(h=>h.donem.startsWith(u))),m!=="all"&&(s=s.filter(h=>h.durum===m)),s.sort((h,k)=>k.donem.localeCompare(h.donem))},[Y,u,m]),qa=x.useMemo(()=>ca.map(s=>({value:s,label:s,count:Y.filter(h=>h.donem.startsWith(s)).length})),[ca,Y]),Qe=x.useMemo(()=>[{value:"Taslak",label:"Taslak",count:Y.filter(s=>s.durum==="Taslak").length},{value:"KesinleÅŸmiÅŸ",label:"OnaylanmÄ±ÅŸ",count:Y.filter(s=>s.durum==="KesinleÅŸmiÅŸ").length}],[Y]),Na=()=>{const s=new Date;v(""),he(s.toISOString().slice(0,7)),p("TÃ¼m Vadeler"),N({}),X(""),Z("Taslak"),J(""),ge(""),O(""),l(""),z(""),A("selectGroup")},ka=()=>{if(!j){P.error("LÃ¼tfen bir TABELA grubu seÃ§in");return}A("create")},Ja=s=>{H(s),v(s.tabelaGroupId),he(s.donem),p(s.vade),N(s.islemHacmiMap),X(s.notlar||""),Z(s.durum),J(s.pfIslemHacmi||""),ge(s.oxivoIslemHacmi||""),O(s.manualEkGelirOxivoTotal||""),l(s.manualAnaTabelaOxivoTotal||""),z(s.manualAnaTabelaIslemHacmi||""),A("view")},ga=s=>{H(s),v(s.tabelaGroupId),he(s.donem),p(s.vade),N(s.islemHacmiMap),X(s.notlar||""),Z(s.durum),J(s.pfIslemHacmi||""),ge(s.oxivoIslemHacmi||""),O(s.manualEkGelirOxivoTotal||""),l(s.manualAnaTabelaOxivoTotal||""),z(s.manualAnaTabelaIslemHacmi||""),A("edit")},Ba=(s=C)=>{if(s==="KesinleÅŸmiÅŸ"&&(d||f||E)){const k=[];d&&k.push("Ana TABELA Toplam Ä°ÅŸlem Hacmi"),f&&k.push("Ana TABELA OXÄ°VO PayÄ±"),E&&k.push("Ek Gelir OXÄ°VO PayÄ±");const S=`âš ï¸ MANUEL DEÄžER UYARISI

AÅŸaÄŸÄ±daki alanlar manuel olarak girilmiÅŸ:
${k.map(Q=>`â€¢ ${Q}`).join(`
`)}

Bu deÄŸerler Excel export'ta "(MANUEL)" etiketi ile iÅŸaretlenecektir.

KesinleÅŸtirmek istiyor musunuz?`;if(!confirm(S))return}if(D==="create"){const h=L.find(Q=>Q.id===j);if(!h){P.error("TABELA grubu bulunamadÄ±!");return}const k=Fa(r,K),S={id:`hakedis-${Date.now()}`,tabelaGroupId:j,tabelaGroupAd:h.name,donem:T,olusturmaTarihi:new Date().toISOString(),vade:r,islemHacmiMap:K,durum:s,notlar:W||void 0,pfIslemHacmi:ve||void 0,oxivoIslemHacmi:Te||void 0,manualEkGelirOxivoTotal:E||void 0,manualAnaTabelaOxivoTotal:f||void 0,manualAnaTabelaIslemHacmi:d||void 0,totalIslemHacmi:(d?parseFloat(d):k.normalTotals.totalIslemHacmi)+k.ekGelirTotals.totalIslemHacmi,totalPFPay:k.normalTotals.totalPFPay+k.ekGelirTotals.totalPFTL,totalOxivoPay:(f?parseFloat(f):k.normalTotals.totalOxivoPay)+(E?parseFloat(E):k.ekGelirTotals.totalOXTL)};M([...Y,S]),P.success(`${T} dÃ¶nemi hakediÅŸ kaydÄ± ${s==="Taslak"?"taslak olarak":""} oluÅŸturuldu`),A("list")}else if(D==="edit"&&b){const h=L.find(Q=>Q.id===j);if(!h){P.error("TABELA grubu bulunamadÄ±!");return}const k=Fa(r,K),S={...b,tabelaGroupId:j,tabelaGroupAd:h.name,donem:T,vade:r,islemHacmiMap:K,durum:s,notlar:W||void 0,pfIslemHacmi:ve||void 0,oxivoIslemHacmi:Te||void 0,manualEkGelirOxivoTotal:E||void 0,manualAnaTabelaOxivoTotal:f||void 0,manualAnaTabelaIslemHacmi:d||void 0,guncellemeTarihi:new Date().toISOString(),totalIslemHacmi:(d?parseFloat(d):k.normalTotals.totalIslemHacmi)+k.ekGelirTotals.totalIslemHacmi,totalPFPay:k.normalTotals.totalPFPay+k.ekGelirTotals.totalPFTL,totalOxivoPay:(f?parseFloat(f):k.normalTotals.totalOxivoPay)+(E?parseFloat(E):k.ekGelirTotals.totalOXTL)};M(Y.map(Q=>Q.id===b.id?S:Q)),P.success(`${T} dÃ¶nemi hakediÅŸ kaydÄ± ${s==="Taslak"?"taslak olarak":""} gÃ¼ncellendi`),A("list")}},ls=s=>{fa(s),pe(!0)},Wa=()=>{We&&(M(Y.filter(s=>s.id!==We.id)),P.success(`${We.donem} dÃ¶nemi hakediÅŸ kaydÄ± silindi`),pe(!1),fa(null))},aa=s=>{const h=typeof s=="string"?parseFloat(s.replace(",",".")):s;return isNaN(h)||h===0?"":h.toLocaleString("tr-TR",{minimumFractionDigits:2,maximumFractionDigits:2})+" â‚º"},va=s=>s.replace(/\sâ‚º/g,"").replace(/\./g,"").replace(",","."),os=(s,h)=>{if(h===""){N(Q=>({...Q,[s]:""}));return}const S=va(h).replace(/[^0-9.]/g,"");S&&!isNaN(parseFloat(S))&&N(Q=>({...Q,[s]:S}))},is=(s,h,k)=>{var Je,ue;const S=parseFloat(k[s.id]||"0");if(S===0)return{maliyet:0,satis:0,kazanc:0,pfPay:0,oxivoPay:0};const Q=s.komisyonOranlarÄ±.find(_=>_.vade===h&&_.aktif!==!1);if(!Q)return{maliyet:0,satis:0,kazanc:0,pfPay:0,oxivoPay:0};let de=0,ne=0,ye=0;if(s.gelirModeli.ad==="Hazine Geliri"){const _=parseFloat(((Je=s.hazineGeliri)==null?void 0:Je.tutarTL)||"0"),$=parseFloat(((ue=s.hazineGeliri)==null?void 0:ue.oxivoYuzde)||"0"),q=S*_;ye=q*($/100),de=q,ne=q}else if(s.gelirModeli.ad==="Gelir OrtaklÄ±ÄŸÄ±"){const _=parseFloat(Q.alisTL||"0"),$=parseFloat(Q.satisTL||"0");de=S*(_/100),ne=S*($/100),ye=ne-de}else if(s.gelirModeli.ad==="Sabit Komisyon"){const _=parseFloat(Q.oran||"0");ye=S*(_/100),de=0,ne=ye}else{const _=parseFloat(Q.oran||"0");de=S*(_/100),ne=de,ye=0}const me=parseFloat(s.paylaÅŸÄ±mOranlarÄ±.kurulusOrani||"0"),_e=parseFloat(s.paylaÅŸÄ±mOranlarÄ±.oxivoOrani||"0"),qe=ye*(me/100),Pe=ye*(_e/100);return{maliyet:de,satis:ne,kazanc:ye,pfPay:qe,oxivoPay:Pe}},pa=(s,h)=>{const k=parseFloat(h[s.id]||"0");if(k===0||!s.ekGelirDetay)return{pfTL:0,oxTL:0,toplamTutar:0};const S=parseFloat(s.ekGelirDetay.pfYuzde||"0"),Q=parseFloat(s.ekGelirDetay.oxYuzde||"0"),de=k*(S/100),ne=k*(Q/100),ye=de+ne;return{pfTL:de,oxTL:ne,toplamTutar:ye}},Fa=(s,h)=>{let k=0,S=0,Q=0,de=0,ne=0,ye=0,me=0,_e=0;ra.forEach(_=>{_.komisyonOranlarÄ±.filter(q=>q.aktif!==!1).forEach(q=>{const Ge=`${_.id}-${q.vade}`,ze=parseFloat(h[Ge]||"0");let we=0,Se=0,Le=0;if(_.gelirModeli.ad==="Sabit Komisyon"){const t=parseFloat(q.oran||"0");Le=ze*(t/100),we=0,Se=Le}else{const t=parseFloat(q.alisTL||"0"),R=parseFloat(q.satisTL||"0");we=ze*(t/100),Se=ze*(R/100),Le=Se-we}const Ze=parseFloat(_.paylaÅŸÄ±mOranlarÄ±.kurulusOrani||"0"),a=parseFloat(_.paylaÅŸÄ±mOranlarÄ±.oxivoOrani||"0"),o=Le*(Ze/100),i=Le*(a/100);k+=ze,S+=we,Q+=Se,de+=Le,ea||o>=0?ne+=o:o<0&&me++,ea||i>=0?ye+=i:i<0&&_e++})});let qe=0,Pe=0,Je=0,ue=0;return be.forEach(_=>{const $=parseFloat(h[_.id]||"0"),q=pa(_,h);qe+=$,Pe+=q.pfTL,Je+=q.oxTL,ue+=q.toplamTutar}),{normalTotals:{totalIslemHacmi:k,totalMaliyet:S,totalSatis:Q,totalKazanc:de,totalPFPay:ne,totalOxivoPay:ye,excludedPFCount:me,excludedOxivoCount:_e},ekGelirTotals:{totalIslemHacmi:qe,totalPFTL:Pe,totalOXTL:Je,totalTutar:ue},grandTotal:{totalIslemHacmi:k+qe,totalKazanc:de,totalPFPay:ne+Pe,totalOxivoPay:ye+Je}}},Qa=s=>{try{const h=Fa(s.vade,s.islemHacmiMap),k=["Tablo TÃ¼rÃ¼","ÃœrÃ¼n","Gelir Modeli","Gelir TÃ¼rÃ¼","Kart ProgramlarÄ±","Yurt Ä°Ã§i/DÄ±ÅŸÄ±","Kart Tipi","Vade","Komisyon/Oran","Ä°ÅŸlem Hacmi (TL)","Maliyet (TL)","SatÄ±ÅŸ (TL)","KazanÃ§/Tutar (TL)","PF PayÄ± (TL)","OXÄ°VO PayÄ± (TL)"],S=[];ra.forEach($=>{var Se,Le,Ze,a;const q=parseFloat(s.islemHacmiMap[$.id]||"0"),Ge=is($,s.vade,s.islemHacmiMap),ze=$.komisyonOranlarÄ±.find(o=>o.vade===s.vade&&o.aktif!==!1);let we="-";$.gelirModeli.ad==="Gelir OrtaklÄ±ÄŸÄ±"?we=`A:%${(ze==null?void 0:ze.alisTL)||"0"} S:%${(ze==null?void 0:ze.satisTL)||"0"}`:$.gelirModeli.ad==="Sabit Komisyon"?we=`%${(ze==null?void 0:ze.oran)||"0"}`:we=`${((Se=$.hazineGeliri)==null?void 0:Se.tutarTL)||"0"}â‚º (OX:%${((Le=$.hazineGeliri)==null?void 0:Le.oxivoYuzde)||"0"})`,S.push(["Ana TABELA",ba($.urun||"-"),$.gelirModeli.ad,"-",(Ze=$.kartProgramIds)!=null&&Ze.includes("ALL")?"TÃ¼mÃ¼":`${((a=$.kartProgramIds)==null?void 0:a.length)||0} program`,$.yurtIciDisi,$.kartTipi,s.vade,we,q.toFixed(2),Ge.maliyet.toFixed(2),Ge.satis.toFixed(2),Ge.kazanc.toFixed(2),Ge.pfPay.toFixed(2),Ge.oxivoPay.toFixed(2)].join(","))}),be.forEach($=>{var we,Se,Le,Ze;const q=parseFloat(s.islemHacmiMap[$.id]||"0"),Ge=pa($,s.islemHacmiMap),ze=(we=$.ekGelirDetay)!=null&&we.kartTipi?$.ekGelirDetay.kartTipi.split(" (")[0]:"-";S.push(["Ek Gelir",ba($.urun||"-"),$.gelirModeli.ad,((Se=$.ekGelirDetay)==null?void 0:Se.gelirTuru)||"-","-",((Le=$.ekGelirDetay)==null?void 0:Le.kullanim)||"-",ze,"-",`${((Ze=$.ekGelirDetay)==null?void 0:Ze.tutar)||"0"}â‚º`,q.toFixed(2),"-","-",Ge.toplamTutar.toFixed(2),Ge.pfTL.toFixed(2),Ge.oxTL.toFixed(2)].join(","))}),S.push("");const Q=s.manualAnaTabelaIslemHacmi,de=s.manualAnaTabelaOxivoTotal,ne=Q?parseFloat(Q):h.normalTotals.totalIslemHacmi,ye=de?parseFloat(de):h.normalTotals.totalOxivoPay;if(S.push(["ANA TABELA TOPLAM","","","","","","","","",`${ne.toFixed(2)}${Q?" (MANUEL)":""}`,h.normalTotals.totalMaliyet.toFixed(2),h.normalTotals.totalSatis.toFixed(2),h.normalTotals.totalKazanc.toFixed(2),h.normalTotals.totalPFPay.toFixed(2),`${ye.toFixed(2)}${de?" (MANUEL)":""}`].join(",")),be.length>0){const $=s.manualEkGelirOxivoTotal,q=$?parseFloat($):h.ekGelirTotals.totalOXTL;S.push(["EK GELÄ°R TOPLAM","","","","","","","","",h.ekGelirTotals.totalIslemHacmi.toFixed(2),"-","-",h.ekGelirTotals.totalTutar.toFixed(2),h.ekGelirTotals.totalPFTL.toFixed(2),`${q.toFixed(2)}${$?" (MANUEL)":""}`].join(","))}S.push("");const me=ne+h.ekGelirTotals.totalIslemHacmi,_e=ye+(be.length>0?manualEkGelirOxivoValue?parseFloat(manualEkGelirOxivoValue):h.ekGelirTotals.totalOXTL:0),qe=Q||de||manualEkGelirOxivoValue;S.push(["GENEL TOPLAM","","","","","","","","",`${me.toFixed(2)}${qe?" (Ä°Ã§erir: Manuel DeÄŸerler)":""}`,"-","-",h.grandTotal.totalKazanc.toFixed(2),h.grandTotal.totalPFPay.toFixed(2),`${_e.toFixed(2)}${qe?" (Ä°Ã§erir: Manuel DeÄŸerler)":""}`].join(","));const Pe=[k.join(","),...S].join(`
`),Je=new Blob(["\uFEFF"+Pe],{type:"text/csv;charset=utf-8;"}),ue=URL.createObjectURL(Je),_=document.createElement("a");_.href=ue,_.download=`hakedis-${oe}-${s.donem}.csv`,document.body.appendChild(_),_.click(),document.body.removeChild(_),URL.revokeObjectURL(ue),P.success("Excel dosyasÄ± indirildi")}catch(h){console.error("Export hatasÄ±:",h),P.error("Export sÄ±rasÄ±nda hata oluÅŸtu")}},Ve=s=>{const[h,k]=s.split("-");return`${["Ocak","Åžubat","Mart","Nisan","MayÄ±s","Haziran","Temmuz","AÄŸustos","EylÃ¼l","Ekim","KasÄ±m","AralÄ±k"][parseInt(k)-1]} ${h}`};if(D==="list")return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(se,{className:"bg-gradient-to-r from-green-50 to-blue-50 border-green-200",children:[e.jsx(De,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(Oe,{className:"flex items-center gap-2 text-green-900",children:[e.jsx(js,{className:"text-green-600",size:24}),"HakediÅŸ YÃ¶netimi - ",oe]}),e.jsx("p",{className:"text-sm text-green-700 mt-1",children:"AylÄ±k hakediÅŸ kayÄ±tlarÄ±nÄ± oluÅŸtur, gÃ¶rÃ¼ntÃ¼le ve yÃ¶net"})]}),e.jsxs(y,{onClick:Na,disabled:ta.length===0,className:"bg-green-600 hover:bg-green-700",title:ta.length===0?"Ã–nce aktif bir TABELA grubu oluÅŸturun":"",children:[e.jsx(Xa,{size:16,className:"mr-2"}),"Yeni HakediÅŸ Ekle"]})]})}),e.jsx(le,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(ns,{label:"YÄ±l",options:qa,value:u,onChange:xe,allLabel:"TÃ¼m YÄ±llar",showCount:!0}),e.jsx(ns,{label:"Durum",options:Qe,value:m,onChange:F,allLabel:"TÃ¼m Durumlar",showCount:!0}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-green-200",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Toplam HakediÅŸ"}),e.jsx("div",{className:"text-2xl text-green-700",children:ha.length}),e.jsxs("div",{className:"text-xs text-gray-500",children:[ca.length," yÄ±l"]})]})]})})]}),ta.length===0&&e.jsx(se,{className:"bg-orange-50 border-orange-200",children:e.jsx(le,{className:"pt-6",children:e.jsxs("div",{className:"flex items-start gap-3 text-sm text-orange-800",children:[e.jsx("span",{className:"text-xl",children:"âš ï¸"}),e.jsxs("div",{children:[e.jsx("p",{className:"mb-2",children:e.jsx("strong",{children:"Aktif TABELA Grubu BulunamadÄ±"})}),e.jsx("p",{className:"text-xs",children:"HakediÅŸ oluÅŸturabilmek iÃ§in Ã¶nce TABELA sekmesinden en az bir aktif grup tanÄ±mlamalÄ±sÄ±nÄ±z. TABELA gruplarÄ±, belirli bir anlaÅŸmaya veya dÃ¶neme ait gelir modellerini organize eder."})]})]})})}),e.jsxs(se,{children:[e.jsx(De,{children:e.jsx(Oe,{children:"HakediÅŸ KayÄ±tlarÄ±"})}),e.jsx(le,{children:ha.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(Ms,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("p",{className:"mb-2",children:"HenÃ¼z hakediÅŸ kaydÄ± bulunmuyor"}),e.jsx("p",{className:"text-sm",children:ta.length===0?"Ã–nce TABELA sekmesinden bir grup oluÅŸturun":'"Yeni HakediÅŸ Ekle" butonuna tÄ±klayarak baÅŸlayÄ±n'})]}):e.jsx("div",{className:"border rounded-lg overflow-hidden",children:e.jsxs(sa,{children:[e.jsx(la,{children:e.jsxs(ie,{className:"bg-gray-50",children:[e.jsx(g,{className:"w-12",children:"#"}),e.jsx(g,{children:"TABELA Grubu"}),e.jsx(g,{children:"DÃ¶nem"}),e.jsx(g,{children:"GÃ¼ncelleme Tarihi"}),e.jsx(g,{children:"Durum"}),e.jsx(g,{className:"text-right",children:"Ä°ÅŸlemler"})]})}),e.jsx(ia,{children:ha.map((s,h)=>{const k=L.find(Q=>Q.id===s.tabelaGroupId),S=(k==null?void 0:k.name)||s.tabelaGroupAd;return e.jsxs(ie,{className:"hover:bg-gray-50",children:[e.jsx(n,{className:"text-gray-500",children:h+1}),e.jsxs(n,{children:[e.jsx(c,{variant:"outline",className:"bg-indigo-50 text-indigo-700 border-indigo-300",children:S}),(k==null?void 0:k.name)!==s.tabelaGroupAd&&e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["(Eski: ",s.tabelaGroupAd,")"]})]}),e.jsx(n,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Gs,{size:16,className:"text-blue-600"}),e.jsx("span",{className:"font-medium",children:Ve(s.donem)})]})}),e.jsx(n,{className:"text-sm text-gray-600",children:s.guncellemeTarihi?new Date(s.guncellemeTarihi).toLocaleDateString("tr-TR"):new Date(s.olusturmaTarihi).toLocaleDateString("tr-TR")}),e.jsx(n,{children:e.jsxs("div",{className:"flex flex-col gap-1",children:[s.durum==="KesinleÅŸmiÅŸ"?e.jsx(c,{className:"bg-green-100 text-green-800 border-green-300",children:"OnaylanmÄ±ÅŸ"}):e.jsx(c,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-300",children:"Taslak"}),s.manualAnaTabelaIslemHacmi||s.manualAnaTabelaOxivoTotal||s.manualEkGelirOxivoTotal?e.jsxs(ks,{children:[e.jsx(vs,{asChild:!0,children:e.jsx("span",{className:"inline-block",children:e.jsxs(c,{variant:"outline",className:"bg-purple-50 text-purple-700 border-purple-300 text-xs cursor-help",children:[e.jsx(oa,{size:10,className:"mr-1"}),"Manuel DeÄŸer"]})})}),e.jsx(bs,{children:e.jsx("div",{className:"text-xs",children:"Bu hakediÅŸ manuel deÄŸerler iÃ§eriyor"})})]}):null]})}),e.jsx(n,{children:e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx(y,{variant:"ghost",size:"sm",onClick:()=>Ja(s),title:"GÃ¶rÃ¼ntÃ¼le",children:e.jsx($s,{size:16})}),e.jsx(y,{variant:"ghost",size:"sm",onClick:()=>ga(s),title:"DÃ¼zenle",children:e.jsx(rs,{size:16})}),e.jsx(y,{variant:"ghost",size:"sm",onClick:()=>Qa(s),title:"Excel Export",children:e.jsx(Ns,{size:16})}),e.jsx(y,{variant:"ghost",size:"sm",onClick:()=>ls(s),className:"text-red-600 hover:text-red-700 hover:bg-red-50",title:"Sil",children:e.jsx(ua,{size:16})})]})})]},s.id)})})]})})})]}),e.jsx(Da,{open:Ee,onOpenChange:pe,children:e.jsxs(Oa,{children:[e.jsxs(wa,{children:[e.jsx(Sa,{children:"HakediÅŸ KaydÄ±nÄ± Sil"}),e.jsx(Ca,{children:We&&e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:Ve(We.donem)})," dÃ¶nemine ait hakediÅŸ kaydÄ±nÄ± silmek istediÄŸinizden emin misiniz?",e.jsx("br",{}),e.jsx("span",{className:"text-red-600",children:"Bu iÅŸlem geri alÄ±namaz!"})]})})]}),e.jsxs(Ea,{children:[e.jsx(y,{variant:"outline",onClick:()=>pe(!1),children:"Ä°ptal"}),e.jsxs(y,{variant:"destructive",onClick:Wa,children:[e.jsx(ua,{size:16,className:"mr-2"}),"Sil"]})]})]})})]});if(D==="selectGroup")return e.jsxs("div",{className:"space-y-6",children:[e.jsx(se,{className:"bg-gradient-to-r from-green-50 to-blue-50 border-green-200",children:e.jsx(De,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(Oe,{className:"flex items-center gap-2 text-green-900",children:[e.jsx(js,{className:"text-green-600",size:24}),"TABELA Grubu SeÃ§imi - ",oe]}),e.jsx("p",{className:"text-sm text-green-700 mt-1",children:"HakediÅŸ hesaplamasÄ± iÃ§in bir TABELA grubu seÃ§in"})]}),e.jsx(y,{variant:"outline",onClick:()=>A("list"),children:"â† Ä°ptal"})]})})}),e.jsxs(se,{children:[e.jsxs(De,{children:[e.jsx(Oe,{children:"Aktif TABELA GruplarÄ±"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Bir grup seÃ§erek devam edin"})]}),e.jsx(le,{children:ta.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(Ms,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("p",{className:"mb-2",children:"Aktif TABELA grubu bulunmuyor"}),e.jsx("p",{className:"text-sm",children:"Ã–nce TABELA sekmesinden grup oluÅŸturun"})]}):e.jsx("div",{className:"space-y-3",children:ta.map(s=>{const h=w.filter(S=>s.recordIds.includes(S.id)&&!S.kapanmaTarihi),k=j===s.id;return e.jsx("div",{onClick:()=>v(s.id),className:`border rounded-lg p-4 cursor-pointer transition-all ${k?"border-green-500 bg-green-50 shadow-md":"border-gray-200 hover:border-green-300 hover:bg-gray-50"}`,children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(c,{variant:"outline",className:k?"bg-green-600 text-white border-green-600":"bg-indigo-50 text-indigo-700 border-indigo-300",children:s.name}),k&&e.jsx("span",{className:"text-green-600 text-sm",children:"âœ“ SeÃ§ildi"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"KayÄ±t SayÄ±sÄ±:"}),e.jsx("div",{className:"text-lg",children:h.length})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Normal:"}),e.jsx("div",{className:"text-lg text-blue-600",children:h.filter(S=>!S.ekGelirDetay).length})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Ek Gelir:"}),e.jsx("div",{className:"text-lg text-purple-600",children:h.filter(S=>S.ekGelirDetay).length})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Durum:"}),e.jsx("div",{children:e.jsx(c,{variant:"default",className:"bg-green-600",children:"Aktif"})})]})]}),s.aciklama&&e.jsx("div",{className:"mt-2 text-sm text-gray-600 italic",children:s.aciklama})]})})},s.id)})})}),ta.length>0&&e.jsx(le,{className:"pt-0",children:e.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[e.jsx(y,{variant:"outline",onClick:()=>A("list"),children:"Ä°ptal"}),e.jsx(y,{onClick:ka,disabled:!j,className:"bg-green-600 hover:bg-green-700",children:"Devam Et â†’"})]})})]}),e.jsx(se,{className:"bg-blue-50 border-blue-200",children:e.jsx(le,{className:"pt-6",children:e.jsxs("div",{className:"flex items-start gap-3 text-sm text-blue-800",children:[e.jsx("span",{className:"text-xl",children:"ðŸ’¡"}),e.jsxs("div",{children:[e.jsx("p",{className:"mb-2",children:e.jsx("strong",{children:"TABELA Grubu Nedir?"})}),e.jsx("p",{className:"text-xs",children:"TABELA gruplarÄ±, belirli bir anlaÅŸma veya dÃ¶nem iÃ§in tanÄ±mlanmÄ±ÅŸ gelir modellerini iÃ§erir. SeÃ§tiÄŸiniz gruba ait tÃ¼m TABELA kayÄ±tlarÄ± hakediÅŸ hesaplamasÄ±na dahil edilecektir."})]})]})})})]});const Be=D==="view",Ae=D==="edit",Fe=D==="create",te=Fa(r,K);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(se,{className:"bg-gradient-to-r from-green-50 to-blue-50 border-green-200",children:[e.jsx(De,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(Oe,{className:"flex items-center gap-2 text-green-900",children:[e.jsx(js,{className:"text-green-600",size:24}),Be&&"HakediÅŸ GÃ¶rÃ¼ntÃ¼le",Ae&&"HakediÅŸ DÃ¼zenle",Fe&&"Yeni HakediÅŸ OluÅŸtur"," - ",oe]}),Be&&b&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-green-700 mt-1",children:Ve(b.donem)}),(()=>{if(d||f||E){const h=[];return d&&h.push("Ana TABELA Toplam Ä°ÅŸlem Hacmi"),f&&h.push("Ana TABELA OXÄ°VO PayÄ±"),E&&h.push("Ek Gelir OXÄ°VO PayÄ±"),e.jsx("div",{className:"mt-2 bg-purple-50 border border-purple-300 rounded px-3 py-2 text-xs text-purple-800",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(oa,{size:14,className:"mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("strong",{children:"Manuel DeÄŸer Bildirimi:"}),e.jsx("div",{className:"mt-1 space-y-0.5",children:h.map((k,S)=>e.jsxs("div",{children:["â€¢ ",k]},S))})]})]})})}return null})()]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(y,{variant:"outline",onClick:()=>A("list"),children:"â† Listeye DÃ¶n"}),!Be&&e.jsxs(e.Fragment,{children:[e.jsxs(y,{onClick:()=>Ba("Taslak"),variant:"outline",className:"border-gray-300 hover:bg-gray-100",children:[e.jsx(cs,{size:16,className:"mr-2"}),"Taslak Kaydet"]}),e.jsxs(y,{onClick:()=>Ba("KesinleÅŸmiÅŸ"),className:"bg-green-600 hover:bg-green-700",children:[e.jsx(cs,{size:16,className:"mr-2"}),"Kaydet"]})]}),Be&&e.jsxs(e.Fragment,{children:[e.jsxs(y,{variant:"outline",onClick:()=>b&&Qa(b),children:[e.jsx(Ns,{size:16,className:"mr-2"}),"Excel Export"]}),e.jsxs(y,{onClick:()=>b&&ga(b),className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(rs,{size:16,className:"mr-2"}),"DÃ¼zenle"]})]})]})]})}),e.jsxs(le,{className:"space-y-4",children:[e.jsx("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(c,{variant:"outline",className:"bg-indigo-600 text-white border-indigo-600",children:"TABELA Grubu"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-lg",children:((Ka=L.find(s=>s.id===j))==null?void 0:Ka.name)||"SeÃ§ilmedi"}),b&&b.tabelaGroupAd!==((re=L.find(s=>s.id===j))==null?void 0:re.name)&&e.jsxs("div",{className:"text-xs text-gray-600 mt-0.5",children:["(Kaydedilen: ",b.tabelaGroupAd,")"]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[j&&e.jsxs("div",{className:"text-sm bg-white px-3 py-1.5 rounded-md border border-indigo-200",children:[e.jsxs("div",{className:"text-gray-700",children:[e.jsx("strong",{children:"TABELA KayÄ±tlarÄ±:"})," ",Re.length]}),e.jsxs("div",{className:"text-xs text-gray-600",children:[ra.length," normal + ",be.length," ek gelir"]})]}),Fe&&e.jsx(y,{variant:"outline",size:"sm",onClick:()=>A("selectGroup"),children:"Grup DeÄŸiÅŸtir"})]})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(U,{htmlFor:"donem",className:"flex items-center gap-2",children:[e.jsx(Gs,{size:16}),"DÃ¶nem"]}),e.jsx(V,{id:"donem",type:"month",value:T,onChange:s=>he(s.target.value),disabled:Be,className:"bg-white"})]}),e.jsx("div",{className:"border rounded-lg overflow-hidden bg-white",children:e.jsxs(sa,{children:[e.jsx(la,{children:e.jsxs(ie,{className:"bg-gradient-to-r from-blue-50 to-indigo-50",children:[e.jsxs(g,{className:"w-1/3 text-center",children:[e.jsx("div",{className:"text-blue-900",children:"PF Ä°ÅŸlem Hacmi/TL"}),e.jsx("div",{className:"text-xs text-blue-600 font-normal",children:"Manuel giriÅŸ"})]}),e.jsxs(g,{className:"w-1/3 text-center",children:[e.jsx("div",{className:"text-indigo-900",children:"OXÄ°VO Ä°ÅŸlem Hacmi/TL"}),e.jsx("div",{className:"text-xs text-indigo-600 font-normal",children:"Manuel giriÅŸ"})]}),e.jsxs(g,{className:"w-1/3 text-center",children:[e.jsx("div",{className:"text-green-900",children:"Fark"}),e.jsx("div",{className:"text-xs text-green-600 font-normal",children:"PF - OXÄ°VO"})]})]})}),e.jsx(ia,{children:e.jsxs(ie,{children:[e.jsx(n,{className:"p-2",children:Be?e.jsx("div",{className:"text-center py-2 px-3 bg-gray-50 rounded",children:ve?`${parseFloat(ve).toLocaleString("tr-TR",{minimumFractionDigits:2,maximumFractionDigits:2})} TL`:"-"}):e.jsx(V,{type:"number",placeholder:"Manuel giriÅŸ TL tutar",value:ve,onChange:s=>J(s.target.value),className:"bg-white text-center",step:"0.01"})}),e.jsx(n,{className:"p-2",children:Be?e.jsx("div",{className:"text-center py-2 px-3 bg-gray-50 rounded",children:Te?`${parseFloat(Te).toLocaleString("tr-TR",{minimumFractionDigits:2,maximumFractionDigits:2})} TL`:"-"}):e.jsx(V,{type:"number",placeholder:"Manuel giriÅŸ TL tutar",value:Te,onChange:s=>ge(s.target.value),className:"bg-white text-center",step:"0.01"})}),e.jsx(n,{className:"p-2",children:(()=>{const s=parseFloat(ve)||0,h=parseFloat(Te)||0,k=s-h,S=k>0?"bg-green-50":k<0?"bg-red-50":"bg-gray-50",Q=k>0?"border-green-200":k<0?"border-red-200":"border-gray-200",de=k>0?"text-green-800":k<0?"text-red-800":"text-gray-800",ne=k>0?"text-green-600":k<0?"text-red-600":"text-gray-600";return e.jsxs("div",{className:`text-center py-2 px-3 ${S} rounded border ${Q}`,children:[e.jsx("div",{className:`text-xs ${ne} mb-1`,children:"hesapla = PF Ä°ÅŸlem Hacmi/TL - OXÄ°VO Ä°ÅŸlem Hacmi/TL"}),e.jsxs("div",{className:`font-medium ${de}`,children:[k.toLocaleString("tr-TR",{minimumFractionDigits:2,maximumFractionDigits:2})," TL"]})]})})()})]})})]})}),!Be&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"notlar",children:"Notlar (Opsiyonel)"}),e.jsx(ms,{id:"notlar",value:W,onChange:s=>X(s.target.value),placeholder:"Bu hakediÅŸ dÃ¶nemi hakkÄ±nda notlar ekleyebilirsiniz...",className:"bg-white",rows:2})]}),Be&&W&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:[e.jsx("div",{className:"text-sm text-blue-900 mb-1",children:"ðŸ“ Notlar:"}),e.jsx("div",{className:"text-sm text-blue-800",children:W})]})]})]}),Re.length===0&&e.jsx(se,{className:"bg-orange-50 border-orange-200",children:e.jsx(le,{className:"pt-6",children:e.jsxs("div",{className:"flex items-start gap-3 text-sm text-orange-800",children:[e.jsx("span",{className:"text-xl",children:"âš ï¸"}),e.jsxs("div",{children:[e.jsx("p",{className:"mb-2",children:e.jsx("strong",{children:"SeÃ§ili TABELA Grubunda KayÄ±t BulunamadÄ±"})}),e.jsxs("p",{className:"text-xs",children:['"',(Ga=L.find(s=>s.id===j))==null?void 0:Ga.name,'" grubunda aktif TABELA kaydÄ± bulunmuyor. Ã–nce TABELA sekmesinden bu gruba kayÄ±t ekleyin veya baÅŸka bir grup seÃ§in.']}),e.jsx(y,{variant:"outline",size:"sm",onClick:()=>A("selectGroup"),className:"mt-3 bg-white",children:"â† FarklÄ± Grup SeÃ§"})]})]})})}),ra.length>0&&e.jsxs(se,{children:[e.jsx(De,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(Oe,{className:"text-lg",children:"Ana TABELA Tablosu"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Ek geliri olmayan normal TABELA kayÄ±tlarÄ± (",ra.length," kayÄ±t)"]}),D!=="view"&&e.jsx("div",{className:"mt-2 space-y-1",children:e.jsxs("p",{className:"text-xs text-indigo-600 bg-indigo-50 border border-indigo-200 rounded px-2 py-1 inline-block",children:["ðŸ’¡ ",e.jsx("strong",{children:"Toplam Ä°ÅŸlem Hacmi ve OXÄ°VO PayÄ±:"})," Otomatik hesaplanÄ±r, ancak manuel deÄŸer girebilirsiniz"]})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(c,{variant:"default",className:"bg-blue-600",children:[ra.length," KayÄ±t"]}),e.jsxs(ks,{children:[e.jsx(vs,{asChild:!0,children:e.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer bg-white border border-gray-300 rounded-md px-3 py-1.5 hover:bg-gray-50 transition-colors",children:[e.jsx(ae,{checked:ea,onCheckedChange:s=>Xe(s)}),e.jsx("span",{className:"text-xs whitespace-nowrap",children:"Eksi (-) deÄŸerleri toplama dahil et"}),e.jsx(oa,{size:14,className:"text-gray-400"})]})}),e.jsxs(bs,{side:"bottom",className:"max-w-xs",children:[e.jsxs("p",{className:"text-xs",children:[e.jsx("strong",{children:"PF PayÄ±"})," ve ",e.jsx("strong",{children:"OXÄ°VO PayÄ±"})," hesaplamalarÄ±nda eksi (-) deÄŸer oluÅŸan satÄ±rlarÄ±",e.jsx("strong",{children:" ANA TABELA TOPLAM"}),"'a dahil edip etmeyeceÄŸinizi seÃ§in."]}),e.jsxs("p",{className:"text-xs mt-1 text-gray-400",children:["âœ“ Ä°ÅŸaretli: TÃ¼m deÄŸerler toplama dahil edilir",e.jsx("br",{}),"âœ— Ä°ÅŸaretsiz: Sadece pozitif deÄŸerler toplama dahil edilir"]})]})]}),e.jsxs(Ds,{children:[e.jsx(Os,{asChild:!0,children:e.jsxs(y,{variant:"outline",size:"sm",className:"gap-2",children:[e.jsx(Hs,{size:16}),"SÃ¼tunlar"]})}),e.jsxs(ws,{className:"dropdown-panel w-72 p-0 max-h-[70vh]",align:"end",style:{display:"flex",flexDirection:"column"},children:[e.jsx("div",{className:"p-4 flex-shrink-0",children:e.jsxs("div",{className:"pb-2 border-b",children:[e.jsx("h4",{className:"text-sm text-gray-900",children:"SÃ¼tun GÃ¶rÃ¼nÃ¼rlÃ¼ÄŸÃ¼"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"GÃ¶rmek istediÄŸiniz sÃ¼tunlarÄ± seÃ§in"})]})}),e.jsx("div",{className:"px-4 overflow-y-auto flex-1 min-h-0",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2 pb-3",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer hover:bg-gray-50 p-1.5 rounded",children:[e.jsx(ae,{checked:I.klm,onCheckedChange:()=>Ie("klm")}),e.jsx("span",{children:"KLM"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer hover:bg-gray-50 p-1.5 rounded",children:[e.jsx(ae,{checked:I.grup,onCheckedChange:()=>Ie("grup")}),e.jsx("span",{children:"Grup"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer hover:bg-gray-50 p-1.5 rounded",children:[e.jsx(ae,{checked:I.kisaAciklama,onCheckedChange:()=>Ie("kisaAciklama")}),e.jsx("span",{children:"KÄ±sa AÃ§Ä±klama"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer hover:bg-gray-50 p-1.5 rounded",children:[e.jsx(ae,{checked:I.urun,onCheckedChange:()=>Ie("urun")}),e.jsx("span",{children:"ÃœrÃ¼n"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer hover:bg-gray-50 p-1.5 rounded",children:[e.jsx(ae,{checked:I.gelirModeli,onCheckedChange:()=>Ie("gelirModeli")}),e.jsx("span",{children:"Gelir Modeli"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer hover:bg-gray-50 p-1.5 rounded",children:[e.jsx(ae,{checked:I.kartProg,onCheckedChange:()=>Ie("kartProg")}),e.jsx("span",{children:"Kart Prog."})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer hover:bg-gray-50 p-1.5 rounded",children:[e.jsx(ae,{checked:I.kullanim,onCheckedChange:()=>Ie("kullanim")}),e.jsx("span",{children:"KullanÄ±m"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer hover:bg-gray-50 p-1.5 rounded",children:[e.jsx(ae,{checked:I.kartTipi,onCheckedChange:()=>Ie("kartTipi")}),e.jsx("span",{children:"Kart Tipi"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer hover:bg-gray-50 p-1.5 rounded",children:[e.jsx(ae,{checked:I.islemHacmi,onCheckedChange:()=>Ie("islemHacmi")}),e.jsx("span",{children:"Ä°ÅŸlem Hacmi"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer hover:bg-gray-50 p-1.5 rounded",children:[e.jsx(ae,{checked:I.vade,onCheckedChange:()=>Ie("vade")}),e.jsx("span",{children:"Vade"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer hover:bg-gray-50 p-1.5 rounded",children:[e.jsx(ae,{checked:I.kazancTL,onCheckedChange:()=>Ie("kazancTL")}),e.jsx("span",{children:"Kar"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer hover:bg-gray-50 p-1.5 rounded",children:[e.jsx(ae,{checked:I.oxivoPayi,onCheckedChange:()=>Ie("oxivoPayi")}),e.jsx("span",{children:"OXÄ°VO PayÄ±"})]})]})}),e.jsxs("div",{className:"px-4 pb-4 pt-2 border-t flex gap-2 flex-shrink-0",children:[e.jsx(y,{variant:"outline",size:"sm",onClick:()=>Ta({klm:!0,grup:!0,kisaAciklama:!0,urun:!0,gelirModeli:!0,kartProg:!0,kullanim:!0,kartTipi:!0,islemHacmi:!0,vade:!0,kazancTL:!0,oxivoPayi:!0}),className:"flex-1 text-xs",children:"TÃ¼mÃ¼nÃ¼ GÃ¶ster"}),e.jsx(y,{variant:"outline",size:"sm",onClick:()=>Ta({klm:!0,grup:!1,kisaAciklama:!1,urun:!1,gelirModeli:!1,kartProg:!1,kullanim:!1,kartTipi:!1,islemHacmi:!0,vade:!0,kazancTL:!0,oxivoPayi:!0}),className:"flex-1 text-xs",children:"Ã–zet GÃ¶rÃ¼nÃ¼m"})]})]})]})]})]})}),e.jsxs(le,{children:[!ea&&e.jsx("div",{className:"mb-4 bg-orange-50 border border-orange-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-start gap-2 text-xs text-orange-800",children:[e.jsx(oa,{size:14,className:"mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("strong",{children:"Eksi deÄŸer filtresi aktif:"})," PF PayÄ± ve OXÄ°VO PayÄ± sÃ¼tunlarÄ±nda eksi (-) deÄŸerler",e.jsx("strong",{className:"text-orange-900",children:" kÄ±rmÄ±zÄ± renkte"})," gÃ¶sterilir ve",e.jsx("strong",{className:"text-orange-900",children:" ANA TABELA TOPLAM'a dahil edilmez"}),". TÃ¼m deÄŸerleri toplama dahil etmek iÃ§in yukarÄ±daki checkbox'Ä± iÅŸaretleyin."]})]})}),e.jsx("div",{className:"border rounded-lg overflow-x-auto",children:e.jsxs(sa,{children:[e.jsx(la,{children:e.jsxs(ie,{className:"bg-gray-50",children:[I.klm&&e.jsx(g,{className:"bg-blue-100 text-blue-900 text-center",children:"KLM"}),I.grup&&e.jsx(g,{className:"bg-blue-100 text-blue-900",children:"Grup"}),I.kisaAciklama&&e.jsx(g,{className:"bg-blue-100 text-blue-900",children:"KÄ±sa AÃ§Ä±klama"}),I.urun&&e.jsx(g,{className:"bg-blue-100 text-blue-900",children:"ÃœrÃ¼n"}),I.gelirModeli&&e.jsx(g,{className:"bg-blue-100 text-blue-900",children:"Gelir Modeli"}),I.kartProg&&e.jsx(g,{className:"bg-blue-100 text-blue-900",children:"Kart Prog."}),I.kullanim&&e.jsx(g,{className:"bg-blue-100 text-blue-900",children:"KullanÄ±m"}),I.kartTipi&&e.jsx(g,{className:"bg-blue-100 text-blue-900",children:"Kart Tipi"}),I.islemHacmi&&e.jsxs(g,{className:"bg-green-100 text-green-900 text-center",children:[e.jsx("div",{children:"Ä°ÅŸlem Hacmi"}),e.jsx("div",{className:"text-xs opacity-70",children:"Manuel TL GiriÅŸ"})]}),I.vade&&e.jsx(g,{className:"bg-blue-100 text-blue-900 text-center",children:"Vade"}),I.kazancTL&&e.jsx(g,{className:"bg-white text-gray-900 text-right",children:"Kar"}),I.oxivoPayi&&e.jsx(g,{className:"bg-white text-gray-900 text-right",children:"OXÄ°VO PayÄ±"})]})}),e.jsxs(ia,{children:[(()=>{const s=ra.filter(ne=>ne.yurtIciDisi==="Yurt Ä°Ã§i"),h=ra.filter(ne=>ne.yurtIciDisi==="Yurt DÄ±ÅŸÄ±"),k=L.find(ne=>ne.id===j),S=Object.values(I).filter(Boolean).length,Q=(ne,ye)=>ne.flatMap((me,_e)=>me.komisyonOranlarÄ±.filter(Pe=>Pe.aktif!==!1).map((Pe,Je)=>{var i,t;const ue=`${me.id}-${Pe.vade}`,_=parseFloat(K[ue]||"0"),$=me.gelirModeli.ad==="Sabit Komisyon";let q=0,Ge=0,ze=0,we=0,Se=0,Le=0;$?(ze=parseFloat(Pe.oran||"0"),Le=_*(ze/100)):(q=parseFloat(Pe.alisTL||"0"),Ge=parseFloat(Pe.satisTL||"0"),ze=Ge-q,we=_*(q/100),Se=_*(Ge/100),Le=Se-we),parseFloat(me.paylaÅŸÄ±mOranlarÄ±.kurulusOrani||"0");const Ze=parseFloat(me.paylaÅŸÄ±mOranlarÄ±.oxivoOrani||"0"),a=Le*(Ze/100),o=ye+_e;return e.jsxs(ie,{className:"hover:bg-gray-50",children:[I.klm&&e.jsx(n,{className:"bg-blue-50/30 text-center",children:e.jsx(c,{variant:"outline",className:"bg-slate-50 text-slate-700 border-slate-300 font-mono text-xs",children:String(o+1).padStart(2,"0")})}),I.grup&&e.jsx(n,{className:"bg-blue-50/30",children:k?e.jsx(c,{variant:"default",className:"bg-blue-600 text-white text-xs",children:k.name}):e.jsx("span",{className:"text-xs text-gray-400",children:"-"})}),I.kisaAciklama&&e.jsx(n,{className:"bg-blue-50/30",children:me.kisaAciklama?e.jsx(c,{variant:"outline",className:"bg-amber-50 text-amber-700 border-amber-300 text-xs",children:me.kisaAciklama}):e.jsx("span",{className:"text-xs text-gray-400",children:"-"})}),I.urun&&e.jsx(n,{className:"bg-blue-50/30",children:e.jsx(c,{variant:"outline",className:"bg-indigo-50 text-indigo-700 border-indigo-300 text-xs",children:ba(me.urun||"-")})}),I.gelirModeli&&e.jsx(n,{className:"bg-blue-50/30",children:e.jsx("span",{className:"text-xs",children:me.gelirModeli.ad})}),I.kartProg&&e.jsx(n,{className:"bg-blue-50/30",children:e.jsx("span",{className:"text-xs",children:(i=me.kartProgramIds)!=null&&i.includes("ALL")?"Hepsi":`${((t=me.kartProgramIds)==null?void 0:t.length)||0} prog.`})}),I.kullanim&&e.jsx(n,{className:"bg-blue-50/30",children:e.jsx(c,{variant:me.yurtIciDisi==="Yurt Ä°Ã§i"?"default":"secondary",className:"text-xs",children:me.yurtIciDisi})}),I.kartTipi&&e.jsx(n,{className:"bg-blue-50/30",children:e.jsx(c,{variant:me.kartTipi==="Credit"?"default":me.kartTipi==="Debit"?"secondary":"outline",className:`text-xs ${me.kartTipi==="PaÃ§al"?"bg-purple-100 text-purple-700 border-purple-300":""}`,children:me.kartTipi})}),I.islemHacmi&&e.jsx(n,{className:"bg-green-50/50",children:D==="view"?e.jsx("div",{className:"text-right pr-3",children:e.jsxs("span",{className:`text-sm ${_>0?"text-gray-900":"text-gray-400"}`,children:[_.toLocaleString("tr-TR",{minimumFractionDigits:2,maximumFractionDigits:2})," â‚º"]})}):e.jsx(V,{type:"text",inputMode:"decimal",value:K[ue]?aa(K[ue]):"",onChange:R=>os(ue,R.target.value),placeholder:"0,00 â‚º",className:"w-40 text-right bg-white",onFocus:R=>{if(K[ue]){const ce=parseFloat(K[ue]);R.target.value=ce.toFixed(2).replace(".",",")}},onBlur:R=>{K[ue]&&(R.target.value=aa(K[ue]))}})}),I.vade&&e.jsx(n,{className:"bg-blue-50/30 text-center",children:e.jsx(c,{variant:"outline",className:"bg-indigo-50 text-indigo-700 border-indigo-300 text-xs",children:Pe.vade.replace(" (PeÅŸin)","")})}),I.kazancTL&&e.jsx(n,{className:"bg-white text-right",children:$?e.jsxs("div",{className:"text-sm text-blue-700",children:["%",parseFloat(Pe.oran||"0").toFixed(2)]}):e.jsxs("div",{className:"text-xs space-y-1",children:[e.jsxs("div",{className:`${_>0?"text-red-600":"text-gray-400"}`,children:["AlÄ±ÅŸ: ",we.toLocaleString("tr-TR",{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsxs("div",{className:`${_>0?"text-green-600":"text-gray-400"}`,children:["SatÄ±ÅŸ: ",Se.toLocaleString("tr-TR",{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsxs("div",{className:`${_>0?"text-blue-600":"text-gray-400"}`,children:["Kar: ",Le.toLocaleString("tr-TR",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})}),I.oxivoPayi&&e.jsxs(n,{className:"bg-white text-right",children:[e.jsxs("span",{className:`text-sm ${_===0?"text-gray-400":a<0?"text-red-600 font-bold":"text-indigo-700"}`,children:[a.toLocaleString("tr-TR",{minimumFractionDigits:2,maximumFractionDigits:2})," â‚º"]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["(",Ze.toFixed(0),"%)"]})]})]},ue)})),de=[];return s.length>0&&(de.push(e.jsx(ie,{className:"bg-gradient-to-r from-teal-100 to-teal-50 border-y border-teal-300",children:e.jsx(n,{colSpan:S,className:"py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{variant:"default",className:"bg-teal-600 text-white",children:"Yurt Ä°Ã§i"}),e.jsxs("span",{className:"text-sm text-teal-800",children:[s.length," kayÄ±t"]})]})})},"yurtici-header")),de.push(...Q(s,0))),h.length>0&&(de.push(e.jsx(ie,{className:"bg-gradient-to-r from-amber-100 to-amber-50 border-y border-amber-300",children:e.jsx(n,{colSpan:S,className:"py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{variant:"secondary",className:"bg-amber-600 text-white",children:"Yurt DÄ±ÅŸÄ±"}),e.jsxs("span",{className:"text-sm text-amber-800",children:[h.length," kayÄ±t"]})]})})},"yurtdisi-header")),de.push(...Q(h,s.length))),de})(),e.jsxs(ie,{className:"bg-gradient-to-r from-blue-100 to-blue-50 border-t-2 border-blue-300",children:[e.jsx(n,{colSpan:Object.values(I).filter(Boolean).length-(I.islemHacmi?1:0)-(I.kazanc?1:0)-(I.kazancTL?1:0)-(I.pfPayi?1:0)-(I.oxivoPayi?1:0),className:"text-right",children:e.jsx("strong",{className:"text-blue-900",children:"ANA TABELA TOPLAM"})}),I.islemHacmi&&e.jsx(n,{className:"bg-green-100 text-center",children:D==="view"?e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsxs("strong",{className:"text-green-800",children:[(d?parseFloat(d):te.normalTotals.totalIslemHacmi).toLocaleString("tr-TR",{minimumFractionDigits:2,maximumFractionDigits:2})," â‚º"]}),e.jsx("div",{className:"text-xs text-green-700",children:"Toplam Ä°ÅŸlem Hacmi"}),d&&e.jsx("span",{className:"text-xs text-purple-600 bg-purple-50 px-2 py-0.5 rounded",children:"(Manuel DeÄŸer)"})]}):e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(V,{type:"text",placeholder:te.normalTotals.totalIslemHacmi.toLocaleString("tr-TR",{minimumFractionDigits:2,maximumFractionDigits:2}),value:d,onChange:s=>{const h=s.target.value.replace(/[^0-9.,]/g,"");z(h)},className:"w-32 h-8 text-center bg-white border-2 border-purple-300 focus:border-purple-500 text-sm"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-xs text-green-700",children:d?"(Manuel)":"(Otomatik)"}),d&&e.jsx("button",{onClick:()=>z(""),className:"text-xs text-red-600 hover:text-red-800 underline",children:"SÄ±fÄ±rla"})]})]})}),I.kazanc&&e.jsx(n,{className:"bg-gray-100 text-center",children:e.jsx("strong",{className:"text-gray-700 text-xs",children:"-"})}),I.kazancTL&&e.jsx(n,{className:"bg-green-100 text-right",children:e.jsxs("strong",{className:"text-green-800",children:[te.normalTotals.totalKazanc.toLocaleString("tr-TR",{minimumFractionDigits:2,maximumFractionDigits:2})," â‚º"]})}),I.pfPayi&&e.jsxs(n,{className:"bg-blue-100 text-right",children:[e.jsxs("strong",{className:"text-blue-800",children:[te.normalTotals.totalPFPay.toLocaleString("tr-TR",{minimumFractionDigits:2,maximumFractionDigits:2})," â‚º"]}),!ea&&te.normalTotals.excludedPFCount>0&&e.jsxs("div",{className:"text-xs text-orange-600 mt-1",children:["(",te.normalTotals.excludedPFCount," eksi deÄŸer hariÃ§)"]})]}),I.oxivoPayi&&e.jsxs(n,{className:"bg-indigo-100 text-right",children:[D==="view"?e.jsxs("div",{className:"flex flex-col items-end gap-1",children:[e.jsxs("strong",{className:"text-indigo-800",children:[(f?parseFloat(f):te.normalTotals.totalOxivoPay).toLocaleString("tr-TR",{minimumFractionDigits:2,maximumFractionDigits:2})," â‚º"]}),f&&e.jsx("span",{className:"text-xs text-indigo-600",children:"(Manuel DeÄŸer)"}),!f&&!ea&&te.normalTotals.excludedOxivoCount>0&&e.jsxs("div",{className:"text-xs text-orange-600 mt-1",children:["(",te.normalTotals.excludedOxivoCount," eksi deÄŸer hariÃ§)"]})]}):e.jsx("div",{className:"flex items-center gap-2 justify-end",children:e.jsxs("div",{className:"flex flex-col gap-1 flex-1",children:[e.jsx(V,{type:"text",inputMode:"decimal",value:f?aa(f):"",onChange:s=>{const h=s.target.value;if(h===""){l("");return}const k=va(h);isNaN(k)||l(k.toString())},placeholder:te.normalTotals.totalOxivoPay.toLocaleString("tr-TR",{minimumFractionDigits:2,maximumFractionDigits:2})+" â‚º",className:"w-48 text-right bg-white border-indigo-300 focus:border-indigo-500",onFocus:s=>{if(f){const h=parseFloat(f);s.target.value=h.toFixed(2).replace(".",",")}},onBlur:s=>{f&&(s.target.value=aa(f))}}),e.jsx("div",{className:"text-xs text-indigo-600 flex items-center gap-1",children:f?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-indigo-700",children:"âœ“ Manuel"}),e.jsx("button",{onClick:()=>l(""),className:"text-orange-600 hover:text-orange-700 underline",children:"SÄ±fÄ±rla"})]}):e.jsxs("span",{children:["Otomatik: ",te.normalTotals.totalOxivoPay.toLocaleString("tr-TR",{minimumFractionDigits:2,maximumFractionDigits:2})," â‚º"]})})]})}),!f&&!ea&&te.normalTotals.excludedOxivoCount>0&&D!=="view"&&e.jsxs("div",{className:"text-xs text-orange-600 mt-1",children:["(",te.normalTotals.excludedOxivoCount," eksi deÄŸer hariÃ§)"]})]})]})]})]})})]})]}),be.length>0&&e.jsxs(se,{className:"mt-8",children:[e.jsx(De,{className:"bg-gradient-to-r from-purple-50 to-blue-50 border-b border-purple-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(Oe,{className:"text-lg text-purple-900 flex items-center gap-2",children:[e.jsx("span",{className:"text-xl",children:"ðŸ’°"}),"Ek Gelir DetaylarÄ± Tablosu"]}),e.jsxs("p",{className:"text-sm text-purple-700 mt-1",children:["Ek geliri olan TABELA kayÄ±tlarÄ± (",be.length," kayÄ±t)"]}),D!=="view"&&e.jsxs("p",{className:"text-xs text-indigo-600 mt-2 bg-indigo-50 border border-indigo-200 rounded px-2 py-1",children:["ðŸ’¡ ",e.jsx("strong",{children:"OXÄ°VO PayÄ± Toplam:"})," Otomatik hesaplanÄ±r, ancak manuel deÄŸer girebilirsiniz"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(c,{variant:"default",className:"bg-purple-600",children:[be.length," KayÄ±t"]}),e.jsxs(Ds,{children:[e.jsx(Os,{asChild:!0,children:e.jsxs(y,{variant:"outline",size:"sm",className:"gap-2",children:[e.jsx(Hs,{size:16}),"SÃ¼tunlar"]})}),e.jsxs(ws,{className:"dropdown-panel w-72 p-0 max-h-[70vh]",align:"end",style:{display:"flex",flexDirection:"column"},children:[e.jsx("div",{className:"p-4 flex-shrink-0",children:e.jsxs("div",{className:"pb-2 border-b",children:[e.jsx("h4",{className:"text-sm text-gray-900",children:"SÃ¼tun GÃ¶rÃ¼nÃ¼rlÃ¼ÄŸÃ¼"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"GÃ¶rmek istediÄŸiniz sÃ¼tunlarÄ± seÃ§in"})]})}),e.jsx("div",{className:"px-4 overflow-y-auto flex-1 min-h-0",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2 pb-3",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer hover:bg-gray-50 p-1.5 rounded",children:[e.jsx(ae,{checked:ee.klm,onCheckedChange:()=>$e("klm")}),e.jsx("span",{children:"KLM"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer hover:bg-gray-50 p-1.5 rounded",children:[e.jsx(ae,{checked:ee.grup,onCheckedChange:()=>$e("grup")}),e.jsx("span",{children:"Grup"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer hover:bg-gray-50 p-1.5 rounded",children:[e.jsx(ae,{checked:ee.kisaAciklama,onCheckedChange:()=>$e("kisaAciklama")}),e.jsx("span",{children:"KÄ±sa AÃ§Ä±klama"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer hover:bg-gray-50 p-1.5 rounded",children:[e.jsx(ae,{checked:ee.urun,onCheckedChange:()=>$e("urun")}),e.jsx("span",{children:"ÃœrÃ¼n"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer hover:bg-gray-50 p-1.5 rounded",children:[e.jsx(ae,{checked:ee.gelirModeli,onCheckedChange:()=>$e("gelirModeli")}),e.jsx("span",{children:"Gelir Modeli"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer hover:bg-gray-50 p-1.5 rounded",children:[e.jsx(ae,{checked:ee.kartProg,onCheckedChange:()=>$e("kartProg")}),e.jsx("span",{children:"Kart Prog."})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer hover:bg-gray-50 p-1.5 rounded",children:[e.jsx(ae,{checked:ee.kullanim,onCheckedChange:()=>$e("kullanim")}),e.jsx("span",{children:"KullanÄ±m"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer hover:bg-gray-50 p-1.5 rounded",children:[e.jsx(ae,{checked:ee.kartTipi,onCheckedChange:()=>$e("kartTipi")}),e.jsx("span",{children:"Kart Tipi"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer hover:bg-gray-50 p-1.5 rounded",children:[e.jsx(ae,{checked:ee.islemHacmi,onCheckedChange:()=>$e("islemHacmi")}),e.jsx("span",{children:"Ä°ÅŸlem Hacmi"})]})]})}),e.jsxs("div",{className:"px-4 pb-4 pt-2 border-t flex gap-2 flex-shrink-0",children:[e.jsx(y,{variant:"outline",size:"sm",onClick:()=>Aa({klm:!0,grup:!0,kisaAciklama:!0,urun:!0,gelirModeli:!0,kartProg:!0,kullanim:!0,kartTipi:!0,islemHacmi:!0}),className:"flex-1 text-xs",children:"TÃ¼mÃ¼nÃ¼ GÃ¶ster"}),e.jsx(y,{variant:"outline",size:"sm",onClick:()=>Aa({klm:!0,grup:!1,kisaAciklama:!1,urun:!1,gelirModeli:!1,kartProg:!1,kullanim:!1,kartTipi:!1,islemHacmi:!0}),className:"flex-1 text-xs",children:"Ã–zet GÃ¶rÃ¼nÃ¼m"})]})]})]})]})]})}),e.jsx(le,{className:"pt-6",children:e.jsx("div",{className:"border rounded-lg overflow-x-auto",children:e.jsxs(sa,{children:[e.jsx(la,{children:e.jsxs(ie,{className:"bg-gray-50",children:[ee.klm&&e.jsx(g,{className:"bg-blue-100 text-blue-900 text-center w-12",children:"KLM"}),ee.grup&&e.jsx(g,{className:"bg-blue-100 text-blue-900",children:"Grup"}),ee.kisaAciklama&&e.jsx(g,{className:"bg-blue-100 text-blue-900",children:"KÄ±sa AÃ§Ä±klama"}),ee.urun&&e.jsx(g,{className:"bg-blue-100 text-blue-900",children:"ÃœrÃ¼n"}),ee.gelirModeli&&e.jsx(g,{className:"bg-blue-100 text-blue-900",children:"Gelir Modeli"}),ee.kartProg&&e.jsx(g,{className:"bg-blue-100 text-blue-900",children:"Kart Prog."}),ee.kullanim&&e.jsx(g,{className:"bg-blue-100 text-blue-900",children:"KullanÄ±m"}),ee.kartTipi&&e.jsx(g,{className:"bg-blue-100 text-blue-900",children:"Kart Tipi"}),ee.islemHacmi&&e.jsx(g,{className:"bg-green-100 text-green-900 text-center",children:e.jsxs("div",{className:"space-y-0.5",children:[e.jsx("div",{children:"Ä°ÅŸlem Hacmi"}),e.jsx("div",{className:"text-xs opacity-70",children:"Manuel TL deÄŸer GiriÅŸi"})]})}),e.jsx(g,{className:"bg-white text-gray-900 text-right",children:e.jsxs("div",{className:"space-y-0.5",children:[e.jsx("div",{children:"PF PayÄ±"}),e.jsx("div",{className:"text-xs text-gray-500",children:"I4*J2"})]})}),e.jsx(g,{className:"bg-white text-gray-900 text-right",children:e.jsxs("div",{className:"space-y-0.5",children:[e.jsx("div",{children:"OXÄ°VO PayÄ±"}),e.jsx("div",{className:"text-xs text-gray-500",children:"I4*K2"})]})})]})}),e.jsxs(ia,{children:[be.map((s,h)=>{var me,_e,qe,Pe,Je;const k=parseFloat(K[s.id]||"0"),S=L.find(ue=>ue.id===j),Q=parseFloat(((me=s.ekGelirDetay)==null?void 0:me.pfYuzde)||"0"),de=parseFloat(((_e=s.ekGelirDetay)==null?void 0:_e.oxYuzde)||"0"),ne=k*(Q/100),ye=k*(de/100);return e.jsxs(ie,{className:"hover:bg-gray-50",children:[ee.klm&&e.jsx(n,{className:"bg-blue-50/30 text-center",children:e.jsx(c,{variant:"outline",className:"bg-slate-50 text-slate-700 border-slate-300 font-mono text-xs",children:String(h+10).padStart(2,"0")})}),ee.grup&&e.jsx(n,{className:"bg-blue-50/30",children:S?e.jsx(c,{variant:"default",className:"bg-blue-600 text-white text-xs",children:S.name}):e.jsx("span",{className:"text-xs text-gray-400",children:"-"})}),ee.kisaAciklama&&e.jsx(n,{className:"bg-blue-50/30",children:s.kisaAciklama?e.jsx(c,{variant:"outline",className:"bg-amber-50 text-amber-700 border-amber-300 text-xs",children:s.kisaAciklama}):e.jsx("span",{className:"text-xs text-gray-400",children:"-"})}),ee.urun&&e.jsx(n,{className:"bg-blue-50/30",children:e.jsx(c,{variant:"outline",className:"bg-indigo-50 text-indigo-700 border-indigo-300",children:ba(s.urun||"-")})}),ee.gelirModeli&&e.jsx(n,{className:"bg-blue-50/30",children:e.jsx(c,{variant:"outline",className:"bg-green-50 text-green-700 border-green-300",children:s.gelirModeli.ad})}),ee.kartProg&&e.jsx(n,{className:"bg-blue-50/30",children:e.jsx("span",{className:"text-xs text-gray-600",children:"Hesap"})}),ee.kullanim&&e.jsx(n,{className:"bg-blue-50/30",children:e.jsx(c,{variant:((qe=s.ekGelirDetay)==null?void 0:qe.kullanim)==="Yurt Ä°Ã§i"?"default":"secondary",children:((Pe=s.ekGelirDetay)==null?void 0:Pe.kullanim)||"-"})}),ee.kartTipi&&e.jsx(n,{className:"bg-blue-50/30",children:e.jsx(c,{variant:"outline",className:"bg-purple-100 text-purple-700 border-purple-300",children:(Je=s.ekGelirDetay)!=null&&Je.kartTipi?s.ekGelirDetay.kartTipi.split(" (")[0]:"-"})}),ee.islemHacmi&&e.jsx(n,{className:"bg-green-50/50",children:D==="view"?e.jsx("div",{className:"text-right pr-3",children:e.jsxs("span",{className:`text-sm ${k>0?"text-gray-900":"text-gray-400"}`,children:[k.toLocaleString("tr-TR",{minimumFractionDigits:2,maximumFractionDigits:2})," â‚º"]})}):e.jsx(V,{type:"text",inputMode:"decimal",value:K[s.id]?aa(K[s.id]):"",onChange:ue=>os(s.id,ue.target.value),placeholder:"0,00 â‚º",className:"w-40 text-right bg-white",onFocus:ue=>{if(K[s.id]){const _=parseFloat(K[s.id]);ue.target.value=_.toFixed(2).replace(".",",")}},onBlur:ue=>{K[s.id]&&(ue.target.value=aa(K[s.id]))}})}),e.jsx(n,{className:"text-right",children:e.jsxs("span",{className:`text-sm ${k>0?"text-blue-700":"text-gray-400"}`,children:[ne.toLocaleString("tr-TR",{minimumFractionDigits:2,maximumFractionDigits:2})," â‚º"]})}),e.jsx(n,{className:"text-right",children:e.jsxs("span",{className:`text-sm ${k>0?"text-indigo-700":"text-gray-400"}`,children:[ye.toLocaleString("tr-TR",{minimumFractionDigits:2,maximumFractionDigits:2})," â‚º"]})})]},s.id)}),e.jsxs(ie,{className:"bg-gradient-to-r from-purple-100 to-purple-50 border-t-2 border-purple-300",children:[e.jsx(n,{colSpan:Object.values(ee).filter(Boolean).length-1,className:"text-right",children:e.jsx("strong",{className:"text-purple-900",children:"EK GELÄ°R TOPLAM"})}),ee.islemHacmi&&e.jsx(n,{className:"bg-green-100 text-right",children:e.jsxs("strong",{className:"text-green-800",children:[te.ekGelirTotals.totalIslemHacmi.toLocaleString("tr-TR",{minimumFractionDigits:2,maximumFractionDigits:2})," â‚º"]})}),e.jsx(n,{className:"bg-blue-100 text-right",children:e.jsxs("strong",{className:"text-blue-800",children:[te.ekGelirTotals.totalPFTL.toLocaleString("tr-TR",{minimumFractionDigits:2,maximumFractionDigits:2})," â‚º"]})}),e.jsx(n,{className:"bg-indigo-100 text-right",children:D==="view"?e.jsxs("div",{className:"flex flex-col items-end gap-1",children:[e.jsxs("strong",{className:"text-indigo-800",children:[(E?parseFloat(E):te.ekGelirTotals.totalOXTL).toLocaleString("tr-TR",{minimumFractionDigits:2,maximumFractionDigits:2})," â‚º"]}),E&&e.jsx("span",{className:"text-xs text-indigo-600",children:"(Manuel DeÄŸer)"})]}):e.jsx("div",{className:"flex items-center gap-2 justify-end",children:e.jsxs("div",{className:"flex flex-col gap-1 flex-1",children:[e.jsx(V,{type:"text",inputMode:"decimal",value:E?aa(E):"",onChange:s=>{const h=s.target.value;if(h===""){O("");return}const S=va(h).replace(/[^0-9.]/g,"");S&&!isNaN(parseFloat(S))&&O(S)},placeholder:`Otomatik: ${te.ekGelirTotals.totalOXTL.toLocaleString("tr-TR",{minimumFractionDigits:2,maximumFractionDigits:2})} â‚º`,className:"w-44 text-right bg-white text-sm",onFocus:s=>{if(E){const h=parseFloat(E);s.target.value=h.toFixed(2).replace(".",",")}},onBlur:s=>{E&&(s.target.value=aa(E))}}),E&&e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("span",{className:"text-indigo-600",children:["Otomatik: ",te.ekGelirTotals.totalOXTL.toLocaleString("tr-TR",{minimumFractionDigits:2,maximumFractionDigits:2})," â‚º"]}),e.jsx("button",{type:"button",onClick:()=>O(""),className:"text-red-600 hover:text-red-800 underline",children:"Temizle"})]})]})})})]})]})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(se,{className:"bg-gradient-to-br from-yellow-50 to-yellow-100 border-yellow-300",children:e.jsxs(le,{className:"pt-6 text-center",children:[e.jsx("div",{className:"text-sm text-yellow-800 mb-1",children:"Toplam Ä°ÅŸlem Hacmi"}),e.jsxs("div",{className:"text-2xl text-yellow-900",children:[(d?parseFloat(d):te.normalTotals.totalIslemHacmi).toLocaleString("tr-TR",{minimumFractionDigits:2,maximumFractionDigits:2})," â‚º"]}),d&&e.jsx("div",{className:"text-xs text-yellow-700 mt-1",children:"(Manuel GiriÅŸ)"})]})}),e.jsx(se,{className:"bg-gradient-to-br from-green-50 to-green-100 border-green-300",children:e.jsxs(le,{className:"pt-6 text-center",children:[e.jsx("div",{className:"text-sm text-green-800 mb-1",children:"Toplam KazanÃ§"}),e.jsxs("div",{className:"text-2xl text-green-900",children:[te.normalTotals.totalKazanc.toLocaleString("tr-TR",{minimumFractionDigits:2,maximumFractionDigits:2})," â‚º"]})]})}),e.jsx(se,{className:"bg-gradient-to-br from-blue-50 to-blue-100 border-blue-300",children:e.jsxs(le,{className:"pt-6 text-center",children:[e.jsx("div",{className:"text-sm text-blue-800 mb-1",children:"Toplam PF PayÄ±"}),e.jsxs("div",{className:"text-2xl text-blue-900",children:[te.normalTotals.totalPFPay.toLocaleString("tr-TR",{minimumFractionDigits:2,maximumFractionDigits:2})," â‚º"]})]})}),e.jsx(se,{className:"bg-gradient-to-br from-indigo-50 to-indigo-100 border-indigo-300",children:e.jsxs(le,{className:"pt-6 text-center",children:[e.jsx("div",{className:"text-sm text-indigo-800 mb-1",children:"Toplam OXÄ°VO PayÄ±"}),e.jsxs("div",{className:"text-2xl text-indigo-900",children:[(f?parseFloat(f):te.normalTotals.totalOxivoPay).toLocaleString("tr-TR",{minimumFractionDigits:2,maximumFractionDigits:2})," â‚º"]}),f&&e.jsx("div",{className:"text-xs text-indigo-700 mt-1",children:"(Manuel GiriÅŸ)"})]})})]}),Re.length>0&&e.jsx(se,{className:"bg-blue-50 border-blue-200",children:e.jsx(le,{className:"pt-6",children:e.jsxs("div",{className:"flex items-start gap-3 text-sm text-blue-800",children:[e.jsx("span",{className:"text-xl",children:"ðŸ’¡"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{children:e.jsx("strong",{children:"HakediÅŸ Hesaplama MantÄ±ÄŸÄ±:"})}),e.jsxs("ul",{className:"list-disc list-inside space-y-0.5 text-xs",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Gelir OrtaklÄ±ÄŸÄ±:"})," KazanÃ§ = (Ä°ÅŸlem Hacmi Ã— SatÄ±ÅŸ %) - (Ä°ÅŸlem Hacmi Ã— AlÄ±ÅŸ %)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Sabit Komisyon:"})," Maliyet = Ä°ÅŸlem Hacmi Ã— Komisyon %"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Hazne Geliri:"})," KazanÃ§ = (Ä°ÅŸlem SayÄ±sÄ± Ã— Birim Tutar) Ã— OXÄ°VO %"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Ek Gelir:"})," Tutar = Ä°ÅŸlem Hacmi Ã— Birim Tutar, PF/OX paylarÄ± hesaplanÄ±r"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"PaylaÅŸÄ±m:"})," PF/OXÄ°VO paylarÄ± kazanÃ§ Ã¼zerinden hesaplanÄ±r"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Grup:"}),' Sadece "',(ja=L.find(s=>s.id===j))==null?void 0:ja.name,'" grubuna ait aktif TABELA kayÄ±tlarÄ± gÃ¶steriliyor']})]})]})]})})})]})}function hl({banks:w=[],epkList:L=[],okList:oe=[],selectedBankIds:Y=[],selectedEPKIds:M=[],selectedOKIds:D=[],onSelectionChange:A}){console.log("ðŸ¦ BankPFCategorySelector yÃ¼klendi:",{bankaSayÄ±sÄ±:w.length,epkSayÄ±sÄ±:L.length,okSayÄ±sÄ±:oe.length,seÃ§iliBankalar:Y.length,seÃ§iliEPKler:M.length,seÃ§iliÃ–Kler:D.length});const[b,H]=x.useState(Y),[j,v]=x.useState(M),[T,he]=x.useState(D),[r,p]=x.useState(""),[K,N]=x.useState(""),[W,X]=x.useState("");x.useEffect(()=>{H(Y)},[JSON.stringify(Y)]),x.useEffect(()=>{v(M)},[JSON.stringify(M)]),x.useEffect(()=>{he(D)},[JSON.stringify(D)]);const C=w.filter(l=>l.aktif),Z=L.filter(l=>l.aktif),ve=oe.filter(l=>l.aktif),J=C.filter(l=>l.bankaAdi.toLowerCase().includes(r.toLowerCase())||l.kod.toLowerCase().includes(r.toLowerCase())),Te=Z.filter(l=>l.kurumAdi.toLowerCase().includes(K.toLowerCase())||l.kod.toLowerCase().includes(K.toLowerCase())),ge=ve.filter(l=>l.kurumAdi.toLowerCase().includes(W.toLowerCase())||l.kod.toLowerCase().includes(W.toLowerCase())),E=l=>{const d=b.includes(l)?b.filter(z=>z!==l):[...b,l];H(d),A==null||A({banks:d,epks:j,oks:T})},O=l=>{const d=j.includes(l)?j.filter(z=>z!==l):[...j,l];v(d),A==null||A({banks:b,epks:d,oks:T})},f=l=>{const d=T.includes(l)?T.filter(z=>z!==l):[...T,l];he(d),A==null||A({banks:b,epks:j,oks:d})};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"bg-gray-100 border border-gray-300 px-3 py-2 rounded-t",children:e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Bankalar"})}),e.jsxs("div",{className:"relative px-2",children:[e.jsx(La,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400",size:16}),e.jsx(V,{type:"text",placeholder:"Banka ara...",value:r,onChange:l=>p(l.target.value),className:"pl-8 h-8 text-sm"})]}),e.jsx("div",{className:"border border-gray-300 rounded h-80 overflow-y-auto bg-white",children:J.length===0?e.jsx("div",{className:"p-4 text-center text-sm text-gray-500",children:"Aktif banka bulunamadÄ±"}):e.jsx("div",{className:"divide-y divide-gray-200",children:J.map(l=>e.jsxs("div",{className:"flex items-center gap-3 px-3 py-2 hover:bg-gray-50 cursor-pointer",onClick:()=>E(l.id),children:[e.jsx(ae,{checked:b.includes(l.id),onCheckedChange:()=>E(l.id)}),e.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[e.jsx("span",{className:"text-sm text-gray-600 tabular-nums shrink-0",children:l.kod}),e.jsx("span",{className:"text-sm text-gray-900 truncate",title:l.bankaAdi,children:l.bankaAdi})]})]},l.id))})}),e.jsxs("div",{className:"px-2 text-xs text-gray-500",children:[b.length," seÃ§ili"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"bg-gray-100 border border-gray-300 px-3 py-2 rounded-t",children:e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"EPK"})}),e.jsxs("div",{className:"relative px-2",children:[e.jsx(La,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400",size:16}),e.jsx(V,{type:"text",placeholder:"EPK ara...",value:K,onChange:l=>N(l.target.value),className:"pl-8 h-8 text-sm"})]}),e.jsx("div",{className:"border border-gray-300 rounded h-80 overflow-y-auto bg-white",children:Te.length===0?e.jsx("div",{className:"p-4 text-center text-sm text-gray-500",children:"Aktif EPK bulunamadÄ±"}):e.jsx("div",{className:"divide-y divide-gray-200",children:Te.map(l=>e.jsxs("div",{className:"flex items-center gap-3 px-3 py-2 hover:bg-gray-50 cursor-pointer",onClick:()=>O(l.id),children:[e.jsx(ae,{checked:j.includes(l.id),onCheckedChange:()=>O(l.id)}),e.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[e.jsx("span",{className:"text-sm text-gray-600 tabular-nums shrink-0",children:l.kod}),e.jsx("span",{className:"text-sm text-gray-900 truncate",title:l.kurumAdi,children:l.kurumAdi})]})]},l.id))})}),e.jsxs("div",{className:"px-2 text-xs text-gray-500",children:[j.length," seÃ§ili"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"bg-gray-100 border border-gray-300 px-3 py-2 rounded-t",children:e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Ã–K"})}),e.jsxs("div",{className:"relative px-2",children:[e.jsx(La,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400",size:16}),e.jsx(V,{type:"text",placeholder:"Ã–K ara...",value:W,onChange:l=>X(l.target.value),className:"pl-8 h-8 text-sm"})]}),e.jsx("div",{className:"border border-gray-300 rounded h-80 overflow-y-auto bg-white",children:ge.length===0?e.jsx("div",{className:"p-4 text-center text-sm text-gray-500",children:"Aktif Ã–K bulunamadÄ±"}):e.jsx("div",{className:"divide-y divide-gray-200",children:ge.map(l=>e.jsxs("div",{className:"flex items-center gap-3 px-3 py-2 hover:bg-gray-50 cursor-pointer",onClick:()=>f(l.id),children:[e.jsx(ae,{checked:T.includes(l.id),onCheckedChange:()=>f(l.id)}),e.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[e.jsx("span",{className:"text-sm text-gray-600 tabular-nums shrink-0",children:l.kod}),e.jsx("span",{className:"text-sm text-gray-900 truncate",title:l.kurumAdi,children:l.kurumAdi})]})]},l.id))})}),e.jsxs("div",{className:"px-2 text-xs text-gray-500",children:[T.length," seÃ§ili"]})]})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex gap-6",children:[e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Toplam SeÃ§ili:"})," ",e.jsx("span",{className:"font-medium text-gray-900",children:b.length+j.length+T.length})]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Banka:"})," ",e.jsx("span",{className:"font-medium text-blue-600",children:b.length})]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"EPK:"})," ",e.jsx("span",{className:"font-medium text-green-600",children:j.length})]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Ã–K:"})," ",e.jsx("span",{className:"font-medium text-purple-600",children:T.length})]})]})})})]})}function gl({record:w,onSave:L,onCancel:oe,onDelete:Y,isCreating:M=!1,gorevListesi:D=[],banks:A=[],epkList:b=[],okList:H=[],kartProgramlar:j=[],gelirModelleri:v=[],ekGelirler:T=[],hesapKalemleri:he=[]}){const[r,p]=x.useState(w||{id:"",firmaUnvan:"",muhasebeKodu:"",bankaOrPF:"Banka",bankaPFAd:"",odemeKurulusuTipi:"",odemeKurulusuAd:"",vergiDairesi:"",vergiNo:"",adres:"",telefon:"",email:"",iletisimMatrisi:[],dokumanlar:[],isbirlikleri:[],tabelaRecords:[],agreementBanks:[],tabelaGroups:[],linkedBankIds:[],linkedEPKIds:[],linkedOKIds:[],durum:"Aktif"}),[K,N]=x.useState(w),W=x.useRef(null),X=x.useRef(!1),[C,Z]=x.useState(M),[ve,J]=x.useState(!1);x.useEffect(()=>!K||M||!r.id?void 0:(JSON.stringify(r)!==JSON.stringify(K)&&!X.current&&(W.current&&clearTimeout(W.current),W.current=window.setTimeout(()=>{X.current||(X.current=!0,L(r),N(r),console.log("âœ… BankPF otomatik kayÄ±t yapÄ±ldÄ±:",new Date().toLocaleTimeString("tr-TR")),X.current=!1)},1500)),()=>{W.current&&clearTimeout(W.current)}),[r,K,M,L]),x.useEffect(()=>{w&&(p(w),N(w))},[w==null?void 0:w.id]);const Te=l=>{l.preventDefault(),J(!0)},ge=()=>{L(r),Z(!1),J(!1)},E=(l,d)=>{p({...r,[l]:d})},O=()=>{M?oe():(p(w),Z(!1))},f=()=>r.odemeKurulusuTipi==="Ã–K"?jl:r.odemeKurulusuTipi==="EPK"?yl:[];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(y,{variant:"outline",onClick:oe,size:"icon",children:e.jsx(_s,{size:20})}),e.jsx("div",{children:e.jsx("h2",{children:M?"Yeni Banka/PF KaydÄ±":`${r.muhasebeKodu} - ${r.firmaUnvan}`})})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[!M&&!C&&e.jsx(y,{onClick:()=>Z(!0),className:"flex items-center space-x-2",children:e.jsx("span",{children:"GÃ¼ncelleme"})}),!M&&e.jsxs(fs,{children:[e.jsx(Ys,{asChild:!0,children:e.jsxs("button",{className:"flex items-center space-x-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:[e.jsx(ua,{size:18}),e.jsx("span",{children:"Sil"})]})}),e.jsxs(Ts,{children:[e.jsxs(As,{children:[e.jsx(Fs,{children:"KaydÄ± Sil"}),e.jsx(Ks,{children:"Bu kaydÄ± silmek istediÄŸinizden emin misiniz? Bu iÅŸlem geri alÄ±namaz."})]}),e.jsxs(zs,{children:[e.jsx(Ps,{children:"Ä°ptal"}),e.jsx(Ls,{onClick:()=>Y(r.id),className:"bg-red-600 hover:bg-red-700",children:"Sil"})]})]})]})]})]}),!M&&e.jsx(se,{className:"bg-gradient-to-r from-green-50 to-blue-50 border-green-200",children:e.jsx(le,{className:"py-4",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"text-2xl",children:"âœ¨"}),e.jsx("div",{className:"flex-1",children:e.jsxs("p",{className:"text-sm text-green-900",children:[e.jsx("strong",{children:"Otomatik KayÄ±t Aktif:"})," Bu sayfada yaptÄ±ÄŸÄ±nÄ±z tÃ¼m deÄŸiÅŸiklikler otomatik olarak kaydedilir (1.5 saniye sonra)."]})})]})})}),e.jsxs(Us,{defaultValue:"onizleme",className:"space-y-6",children:[e.jsxs(Xs,{children:[e.jsx(xa,{value:"onizleme",children:"ðŸ” Ã–n Ä°zleme"}),e.jsx(xa,{value:"kategoriler",children:"ðŸ¦ Kategoriler"}),e.jsx(xa,{value:"isbirligi",children:"Ä°ÅŸ BirliÄŸi"}),e.jsx(xa,{value:"hakedis",children:"HakediÅŸ"}),e.jsx(xa,{value:"tabela",children:"TABELA"}),e.jsx(xa,{value:"bankalar",children:"Bankalar"}),e.jsx(xa,{value:"bilgiler",children:"Cari Bilgileri"}),e.jsx(xa,{value:"iletisim",children:"Ä°letiÅŸim Matrisi"}),e.jsx(xa,{value:"dokumanlar",children:"DokÃ¼man YÃ¶netimi"}),e.jsx(xa,{value:"uiy",children:"ÃœÄ°Y"})]}),e.jsx(ma,{value:"onizleme",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(se,{children:e.jsx(le,{className:"pt-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl mb-2",children:(r.isbirlikleri||[]).length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Ä°ÅŸbirliÄŸi"}),e.jsx(c,{variant:(r.isbirlikleri||[]).length>0?"default":"secondary",className:"mt-2",children:(r.isbirlikleri||[]).length>0?"Var":"Yok"})]})})}),e.jsx(se,{children:e.jsx(le,{className:"pt-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl mb-2",children:(r.tabelaRecords||[]).length}),e.jsx("div",{className:"text-sm text-gray-600",children:"TABELA"}),e.jsx(c,{variant:(r.tabelaRecords||[]).length>0?"default":"secondary",className:"mt-2",children:(r.tabelaRecords||[]).length>0?"Var":"Yok"})]})})}),e.jsx(se,{children:e.jsx(le,{className:"pt-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl mb-2",children:(r.agreementBanks||[]).length}),e.jsx("div",{className:"text-sm text-gray-600",children:"AnlaÅŸmalÄ± Banka"}),e.jsx(c,{variant:(r.agreementBanks||[]).length>0?"default":"secondary",className:"mt-2",children:(r.agreementBanks||[]).length>0?"Var":"Yok"})]})})}),e.jsx(se,{children:e.jsx(le,{className:"pt-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl mb-2",children:(r.iletisimMatrisi||[]).length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Ä°letiÅŸim"}),e.jsx(c,{variant:(r.iletisimMatrisi||[]).length>0?"default":"secondary",className:"mt-2",children:(r.iletisimMatrisi||[]).length>0?"Var":"Yok"})]})})})]}),e.jsxs(se,{children:[e.jsx(De,{children:e.jsx(Oe,{children:"ðŸ“‹ Temel Bilgiler"})}),e.jsxs(le,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Firma ÃœnvanÄ±"}),e.jsx("p",{className:"text-lg",children:r.firmaUnvan||"-"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Muhasebe Kodu"}),e.jsx("p",{children:r.muhasebeKodu||"-"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Tip"}),e.jsx(c,{children:r.bankaOrPF})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Durum"}),e.jsx(c,{variant:r.durum==="Aktif"?"default":"secondary",children:r.durum})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Vergi Dairesi"}),e.jsx("p",{children:r.vergiDairesi||"-"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Vergi No"}),e.jsx("p",{children:r.vergiNo||"-"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Telefon"}),e.jsx("p",{children:r.telefon||"-"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"E-posta"}),e.jsx("p",{children:r.email||"-"})]})]})]}),r.adres&&e.jsxs("div",{className:"mt-4 pt-4 border-t",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Adres"}),e.jsx("p",{className:"text-sm",children:r.adres})]})]})]}),e.jsxs(se,{children:[e.jsx(De,{children:e.jsx(Oe,{children:"ðŸ¤ Ä°ÅŸbirliÄŸi KartlarÄ±"})}),e.jsx(le,{children:!r.isbirlikleri||r.isbirlikleri.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500 bg-gray-50 rounded-lg",children:e.jsx("p",{children:"HenÃ¼z iÅŸbirliÄŸi kaydÄ± bulunmuyor."})}):e.jsx("div",{className:"space-y-3",children:r.isbirlikleri.map(l=>e.jsx("div",{className:"border border-gray-200 rounded-lg p-4 bg-blue-50/30 hover:bg-blue-50 transition-colors",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"space-y-2 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(c,{variant:"outline",className:"bg-blue-100 text-blue-800 border-blue-300",children:["#",l.siraNo]}),e.jsxs("span",{className:"text-sm",children:[new Date(l.baslangicTarihi).toLocaleDateString("tr-TR"),l.bitisTarihi&&` - ${new Date(l.bitisTarihi).toLocaleDateString("tr-TR")}`]}),e.jsx(c,{variant:l.durum==="Aktif"?"default":"secondary",children:l.durum})]}),(l.gelirModeli||l.hesapKalemiKod)&&e.jsxs("div",{className:"flex gap-4 text-sm text-gray-600",children:[l.gelirModeli&&e.jsxs("span",{children:["ðŸ“Š ",l.gelirModeli]}),l.hesapKalemiKod&&e.jsxs("span",{children:["ðŸ’¼ Kod: ",l.hesapKalemiKod]})]})]})})},l.id))})})]}),e.jsxs(se,{children:[e.jsx(De,{children:e.jsx(Oe,{children:"ðŸ“Š TABELA KayÄ±tlarÄ±"})}),e.jsx(le,{children:!r.tabelaRecords||r.tabelaRecords.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500 bg-gray-50 rounded-lg",children:e.jsx("p",{children:"HenÃ¼z TABELA kaydÄ± bulunmuyor."})}):e.jsx("div",{className:"space-y-3",children:r.tabelaRecords.map(l=>{var d;return e.jsx("div",{className:`border rounded-lg p-4 transition-colors ${l.kapanmaTarihi?"border-gray-300 bg-gray-50/50":"border-orange-200 bg-orange-50/30 hover:bg-orange-50"}`,children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(c,{variant:l.kapanmaTarihi?"secondary":"default",children:l.kapanmaTarihi?"KapalÄ±":"Aktif"}),e.jsx("span",{className:l.kapanmaTarihi?"text-gray-500 line-through":"",children:l.gelirModeli.ad})]}),e.jsx("span",{className:"text-sm text-gray-600",children:new Date(l.olusturmaTarihi).toLocaleDateString("tr-TR")})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600",children:"Kart Tipi"}),e.jsx("p",{children:l.kartTipi})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600",children:"Yurt Ä°Ã§i/DÄ±ÅŸÄ±"}),e.jsx("p",{children:l.yurtIciDisi})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600",children:"Kart Program"}),e.jsx("p",{className:"text-xs",children:(d=l.kartProgramIds)!=null&&d.includes("ALL")?"TÃ¼mÃ¼":`${(l.kartProgramIds||[]).length} program`})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600",children:"PaylaÅŸÄ±m"}),e.jsx("p",{className:"text-xs",children:l.kurulusOrani?`${l.kurulusOrani}% / ${l.oxivoOrani}%`:"-"})]})]}),l.kapanmaTarihi&&e.jsx("div",{className:"pt-2 border-t border-gray-200",children:e.jsxs("p",{className:"text-xs text-red-600",children:["âš ï¸ KapatÄ±ldÄ±: ",new Date(l.kapanmaTarihi).toLocaleDateString("tr-TR")]})})]})},l.id)})})})]}),e.jsxs(se,{children:[e.jsx(De,{children:e.jsx(Oe,{children:"ðŸ¦ AnlaÅŸmalÄ± Bankalar"})}),e.jsx(le,{children:!r.agreementBanks||r.agreementBanks.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500 bg-gray-50 rounded-lg",children:e.jsx("p",{children:"HenÃ¼z anlaÅŸmalÄ± banka kaydÄ± bulunmuyor."})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:r.agreementBanks.map(l=>{const d=A.find(z=>z.id===l);return d?e.jsx("div",{className:"border border-green-200 bg-green-50/30 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{variant:"outline",className:"text-xs bg-green-100 border-green-300",children:d.kod}),e.jsx("span",{className:"text-sm",children:d.bankaAdi})]})},l):null})})})]}),e.jsxs(se,{children:[e.jsx(De,{children:e.jsx(Oe,{children:"ðŸ·ï¸ Banka/PF Kategorileri"})}),e.jsx(le,{children:(()=>{var d,z,u;return(((d=r.linkedBankIds)==null?void 0:d.length)||0)+(((z=r.linkedEPKIds)==null?void 0:z.length)||0)+(((u=r.linkedOKIds)==null?void 0:u.length)||0)===0?e.jsxs("div",{className:"text-center py-8 text-gray-500 bg-gray-50 rounded-lg",children:[e.jsx("p",{children:"HenÃ¼z kategori iliÅŸkilendirmesi yapÄ±lmamÄ±ÅŸ."}),e.jsx("p",{className:"text-xs mt-2",children:'Kategori eklemek iÃ§in "Kategoriler" sekmesini kullanÄ±n.'})]}):e.jsxs("div",{className:"space-y-4",children:[r.linkedBankIds&&r.linkedBankIds.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:["Bankalar (",r.linkedBankIds.length,")"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:r.linkedBankIds.map(xe=>{const m=A.find(F=>F.id===xe);return m?e.jsxs("div",{className:"flex items-center gap-2 text-sm border border-blue-200 bg-blue-50/30 rounded px-2 py-1",children:[e.jsx(c,{variant:"outline",className:"text-xs bg-blue-100 border-blue-300",children:m.kod}),e.jsx("span",{className:"truncate",children:m.bankaAdi})]},xe):null})})]}),r.linkedEPKIds&&r.linkedEPKIds.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:["EPK (",r.linkedEPKIds.length,")"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:r.linkedEPKIds.map(xe=>{const m=b.find(F=>F.id===xe);return m?e.jsxs("div",{className:"flex items-center gap-2 text-sm border border-green-200 bg-green-50/30 rounded px-2 py-1",children:[e.jsx(c,{variant:"outline",className:"text-xs bg-green-100 border-green-300",children:m.kod}),e.jsx("span",{className:"truncate",children:m.kurumAdi})]},xe):null})})]}),r.linkedOKIds&&r.linkedOKIds.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:["Ã–K (",r.linkedOKIds.length,")"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:r.linkedOKIds.map(xe=>{const m=H.find(F=>F.id===xe);return m?e.jsxs("div",{className:"flex items-center gap-2 text-sm border border-purple-200 bg-purple-50/30 rounded px-2 py-1",children:[e.jsx(c,{variant:"outline",className:"text-xs bg-purple-100 border-purple-300",children:m.kod}),e.jsx("span",{className:"truncate",children:m.kurumAdi})]},xe):null})})]})]})})()})]}),e.jsxs(se,{children:[e.jsx(De,{children:e.jsx(Oe,{children:"ðŸ‘¥ Ä°letiÅŸim Matrisi"})}),e.jsx(le,{children:!r.iletisimMatrisi||r.iletisimMatrisi.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500 bg-gray-50 rounded-lg",children:e.jsx("p",{children:"HenÃ¼z iletiÅŸim kaydÄ± bulunmuyor."})}):e.jsx("div",{className:"space-y-3",children:r.iletisimMatrisi.map(l=>e.jsx("div",{className:"border border-purple-200 bg-purple-50/30 rounded-lg p-4",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"space-y-2 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("p",{children:[l.ad," ",l.soyad]}),e.jsx(c,{variant:"outline",className:"text-xs",children:l.gorev})]}),e.jsxs("div",{className:"flex gap-4 text-sm text-gray-600",children:[l.telefon&&e.jsxs("span",{children:["ðŸ“ž ",l.telefon]}),l.email&&e.jsxs("span",{children:["ðŸ“§ ",l.email]})]})]})})},l.id))})})]}),e.jsxs(se,{children:[e.jsx(De,{children:e.jsx(Oe,{children:"ðŸ“ DokÃ¼manlar"})}),e.jsx(le,{children:!r.dokumanlar||r.dokumanlar.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500 bg-gray-50 rounded-lg",children:e.jsx("p",{children:"HenÃ¼z dokÃ¼man bulunmuyor."})}):e.jsx("div",{className:"space-y-2",children:r.dokumanlar.map(l=>e.jsxs("div",{className:"border border-indigo-200 bg-indigo-50/30 rounded-lg p-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(c,{variant:"outline",className:"text-xs bg-indigo-100 border-indigo-300",children:l.kategori}),e.jsx("span",{className:"text-sm",children:l.dosyaAdi})]}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(l.yuklemeTarihi).toLocaleDateString("tr-TR")})]},l.id))})})]})]})}),e.jsx(ma,{value:"kategoriler",children:e.jsxs(se,{children:[e.jsxs(De,{children:[e.jsx(Oe,{children:"Banka/PF Kategori Ä°liÅŸkilendirmesi"}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:'Bu Banka/PF kaydÄ±nÄ±n hangi Banka, EPK ve Ã–K kategorileriyle iliÅŸkili olduÄŸunu seÃ§in. SeÃ§tiÄŸiniz kategoriler, MÃ¼ÅŸteri Cari Kart listesinde "Banka/PF" sÃ¼tununda gÃ¶rÃ¼ntÃ¼lenecektir.'})]}),e.jsxs(le,{children:[console.log("ðŸ“Š Kategoriler sekmesi props:",{banks:A.length,epkList:b.length,okList:H.length}),e.jsx(hl,{banks:A,epkList:b,okList:H,selectedBankIds:r.linkedBankIds||[],selectedEPKIds:r.linkedEPKIds||[],selectedOKIds:r.linkedOKIds||[],onSelectionChange:l=>{if(console.log("âœ… Kategori seÃ§imi deÄŸiÅŸti:",l),p(d=>({...d,linkedBankIds:l.banks,linkedEPKIds:l.epks,linkedOKIds:l.oks})),!M){const d={...r,linkedBankIds:l.banks,linkedEPKIds:l.epks,linkedOKIds:l.oks};L(d),P.success("Kategori seÃ§imleri kaydedildi")}}})]})]})}),e.jsx(ma,{value:"isbirligi",children:e.jsxs("div",{className:"text-center py-20 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300",children:[e.jsx(Rs,{size:64,className:"mx-auto text-gray-300 mb-4"}),e.jsx("h3",{className:"text-gray-500 mb-2",children:"Ä°ÅŸ BirliÄŸi YÃ¶netimi"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Bu alan ÅŸu anda boÅŸ"})]})}),e.jsx(ma,{value:"hakedis",children:e.jsx(ul,{tabelaRecords:r.tabelaRecords||[],tabelaGroups:r.tabelaGroups||[],kurumAdi:r.firmaUnvan,hakedisRecords:r.hakedisRecords||[],onHakedisRecordsChange:l=>{p(z=>({...z,hakedisRecords:l}));const d={...r,hakedisRecords:l};L(d)}})}),e.jsx(ma,{value:"bilgiler",children:e.jsxs("form",{onSubmit:Te,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(se,{children:[e.jsx(De,{children:e.jsx(Oe,{children:"Firma Bilgileri"})}),e.jsxs(le,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"firmaUnvan",children:"Firma ÃœnvanÄ± *"}),e.jsx(V,{id:"firmaUnvan",value:r.firmaUnvan,onChange:l=>E("firmaUnvan",l.target.value),required:!0,placeholder:"Ã–rn: TÃ¼rkiye Ä°ÅŸ BankasÄ± A.Åž.",disabled:!C,className:C?"":"bg-gray-100"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"muhasebeKodu",children:"Muhasebe Kodu *"}),e.jsx(V,{id:"muhasebeKodu",value:r.muhasebeKodu,onChange:l=>E("muhasebeKodu",l.target.value),required:!0,placeholder:"Ã–rn: 320.01.001",disabled:!C,className:C?"":"bg-gray-100"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"vergiDairesi",children:"Vergi Dairesi"}),e.jsx(V,{id:"vergiDairesi",value:r.vergiDairesi,onChange:l=>E("vergiDairesi",l.target.value),placeholder:"Vergi dairesi",disabled:!C,className:C?"":"bg-gray-100"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"vergiNo",children:"Vergi No"}),e.jsx(V,{id:"vergiNo",value:r.vergiNo,onChange:l=>E("vergiNo",l.target.value),placeholder:"1234567890",disabled:!C,className:C?"":"bg-gray-100"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"adres",children:"Adres"}),e.jsx(ms,{id:"adres",value:r.adres,onChange:l=>E("adres",l.target.value),placeholder:"Tam adres",rows:3,disabled:!C,className:C?"":"bg-gray-100"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"telefon",children:"Telefon"}),e.jsx(V,{id:"telefon",value:r.telefon,onChange:l=>E("telefon",l.target.value),placeholder:"0212 123 4567",disabled:!C,className:C?"":"bg-gray-100"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"email",children:"E-posta"}),e.jsx(V,{id:"email",type:"email",value:r.email,onChange:l=>E("email",l.target.value),placeholder:"info@ornek.com",disabled:!C,className:C?"":"bg-gray-100"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"durum",children:"Durum"}),e.jsxs($a,{value:r.durum,onValueChange:l=>E("durum",l),disabled:!C,children:[e.jsx(Va,{id:"durum",className:C?"":"bg-gray-100",children:e.jsx(Ya,{})}),e.jsxs(Ua,{children:[e.jsx(ya,{value:"Aktif",children:"Aktif"}),e.jsx(ya,{value:"Pasif",children:"Pasif"})]})]})]})]})]}),e.jsxs(se,{children:[e.jsx(De,{children:e.jsx(Oe,{children:"Banka / Ã–deme KuruluÅŸu Bilgileri"})}),e.jsxs(le,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"bankaOrPF",children:"Banka / PF *"}),e.jsxs($a,{value:r.bankaOrPF,onValueChange:l=>{E("bankaOrPF",l),l==="Banka"&&(E("odemeKurulusuTipi",""),E("odemeKurulusuAd",""))},disabled:!C,children:[e.jsx(Va,{id:"bankaOrPF",className:C?"":"bg-gray-100",children:e.jsx(Ya,{})}),e.jsxs(Ua,{children:[e.jsx(ya,{value:"Banka",children:"Banka"}),e.jsx(ya,{value:"PF",children:"PF (Ã–deme Platformu)"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"bankaPFAd",children:"Banka / PF AdÄ± *"}),e.jsxs($a,{value:r.bankaPFAd,onValueChange:l=>E("bankaPFAd",l),disabled:!C,children:[e.jsx(Va,{id:"bankaPFAd",className:C?"":"bg-gray-100",children:e.jsx(Ya,{placeholder:"SeÃ§iniz..."})}),e.jsx(Ua,{children:pl.map(l=>e.jsx(ya,{value:l,children:l},l))})]})]}),r.bankaOrPF==="PF"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"odemeKurulusuTipi",children:"Ã–K / EPK SeÃ§imi"}),e.jsxs($a,{value:r.odemeKurulusuTipi,onValueChange:l=>{E("odemeKurulusuTipi",l),E("odemeKurulusuAd","")},disabled:!C,children:[e.jsx(Va,{id:"odemeKurulusuTipi",className:C?"":"bg-gray-100",children:e.jsx(Ya,{placeholder:"SeÃ§iniz..."})}),e.jsxs(Ua,{children:[e.jsx(ya,{value:"Ã–K",children:"Ã–K (Ã–deme KuruluÅŸlarÄ±)"}),e.jsx(ya,{value:"EPK",children:"EPK (Elektronik Para KuruluÅŸlarÄ±)"})]})]})]}),r.odemeKurulusuTipi&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs(U,{htmlFor:"odemeKurulusuAd",children:[r.odemeKurulusuTipi," AdÄ±"]}),e.jsxs($a,{value:r.odemeKurulusuAd,onValueChange:l=>E("odemeKurulusuAd",l),disabled:!C,children:[e.jsx(Va,{id:"odemeKurulusuAd",className:C?"":"bg-gray-100",children:e.jsx(Ya,{placeholder:"SeÃ§iniz..."})}),e.jsx(Ua,{children:f().map(l=>e.jsx(ya,{value:l,children:l},l))})]})]})]}),e.jsx("div",{className:"pt-4 border-t border-gray-200",children:e.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Bilgi:"})," Banka seÃ§ildiÄŸinde sadece banka bilgileri, PF seÃ§ildiÄŸinde ise Ã¶deme kuruluÅŸu bilgileri de girilecektir."]})})})]})]})]}),C&&e.jsxs("div",{className:"flex items-center justify-end space-x-4 pt-6 border-t border-gray-200",children:[e.jsxs(y,{type:"button",variant:"outline",onClick:O,children:[e.jsx(xs,{size:18,className:"mr-2"}),"Ä°ptal"]}),e.jsxs(y,{type:"submit",className:"flex items-center space-x-2",children:[e.jsx(cs,{size:18}),e.jsx("span",{children:M?"Kaydet":"GÃ¼ncelle"})]})]})]})}),e.jsx(ma,{value:"tabela",children:e.jsx(ml,{firmaId:r.id,firmaAdi:r.firmaUnvan,firmaTipi:r.bankaOrPF,odemeKurulusuTipi:r.odemeKurulusuTipi,gelirModelleri:v,ekGelirler:T,banks:A,kartProgramlar:j,tabelaRecords:r.tabelaRecords||[],tabelaGroups:r.tabelaGroups||[],onTabelaRecordsChange:l=>{p(z=>({...z,tabelaRecords:l}));const d={...r,tabelaRecords:l};L(d)},onTabelaGroupsChange:l=>{p(z=>({...z,tabelaGroups:l}));const d={...r,tabelaGroups:l};L(d)}})}),e.jsx(ma,{value:"bankalar",children:e.jsx(ol,{banks:A,epkList:b,okList:H,selectedBankIds:r.agreementBanks||[],selectedEPKIds:r.agreementEPKs||[],selectedOKIds:r.agreementOKs||[],onSelectedBanksChange:l=>{p(z=>({...z,agreementBanks:l}));const d={...r,agreementBanks:l};L(d)},onSelectedEPKsChange:l=>{p(z=>({...z,agreementEPKs:l}));const d={...r,agreementEPKs:l};L(d)},onSelectedOKsChange:l=>{p(z=>({...z,agreementOKs:l}));const d={...r,agreementOKs:l};L(d)},onSave:()=>{L(r),Z(!1)}})}),e.jsx(ma,{value:"iletisim",children:e.jsx(cl,{contacts:r.iletisimMatrisi,onContactsChange:l=>{p(z=>({...z,iletisimMatrisi:l}));const d={...r,iletisimMatrisi:l};L(d),P.success("Ä°letiÅŸim matrisi kaydedildi")},gorevListesi:D})}),e.jsx(ma,{value:"dokumanlar",children:e.jsx(xl,{documents:r.dokumanlar,onDocumentsChange:l=>{p(z=>({...z,dokumanlar:l}));const d={...r,dokumanlar:l};L(d),P.success("DokÃ¼man kaydedildi")}})}),e.jsx(ma,{value:"uiy",children:e.jsx(se,{children:e.jsx(le,{className:"py-12"})})})]}),e.jsx(fs,{open:ve,onOpenChange:J,children:e.jsxs(Ts,{children:[e.jsxs(As,{children:[e.jsx(Fs,{children:"DeÄŸiÅŸiklikleri Kaydet"}),e.jsx(Ks,{children:"YaptÄ±ÄŸÄ±nÄ±z deÄŸiÅŸiklikleri kaydetmek istediÄŸinizden emin misiniz?"})]}),e.jsxs(zs,{children:[e.jsx(Ps,{children:"Ä°ptal"}),e.jsx(Ls,{onClick:ge,children:"Kaydet"})]})]})})]})}const pl=["TÃ¼rkiye Ä°ÅŸ BankasÄ± A.Åž.","Ziraat BankasÄ± A.Åž.","Garanti BBVA","Akbank T.A.Åž.","YapÄ± Kredi BankasÄ±","QNB Finansbank","Halkbank","DenizBank","VakÄ±fbank","Ä°NG Bank","PayFlex","Masterpass","Paycell","BKM Express"],jl=["Intertech Bilgi Ä°ÅŸlem ve Pazarlama Tic. A.Åž.","Fintech Ã–deme Hizmetleri A.Åž.","Moka Ã–deme Hizmetleri A.Åž.","Ä°yzico Ã–deme Hizmetleri A.Åž.","PayTR Ã–deme ve Elektronik Para Hizmetleri A.Åž."],yl=["Papara Elektronik Para ve Ã–deme Hizmetleri A.Åž.","Ininal Elektronik Para ve Ã–deme Hizmetleri A.Åž.","BKM Express Elektronik Para A.Åž.","Tosla Teknoloji A.Åž."],wl=["Genel MÃ¼dÃ¼r","Genel MÃ¼dÃ¼r YardÄ±mcÄ±sÄ±","Finans DirektÃ¶rÃ¼","SatÄ±ÅŸ DirektÃ¶rÃ¼","Pazarlama DirektÃ¶rÃ¼","IT DirektÃ¶rÃ¼","Ä°nsan KaynaklarÄ± MÃ¼dÃ¼rÃ¼","Muhasebe MÃ¼dÃ¼rÃ¼","Uyum MÃ¼dÃ¼rÃ¼","Risk YÃ¶neticisi","Proje YÃ¶neticisi","MÃ¼ÅŸteri Ä°liÅŸkileri MÃ¼dÃ¼rÃ¼","Teknik Destek UzmanÄ±","Ä°ÅŸ GeliÅŸtirme UzmanÄ±"],Sl=[],Cl=as.memo(function({gorevListesi:L=L,gelirModelleri:oe=[],ekGelirler:Y=[],hesapKalemleri:M=[],banks:D=[],epkList:A=[],okList:b=[],kartProgramlar:H=[],bankPFRecords:j=[],onBankPFRecordsChange:v,tabelaRecords:T=[],onTabelaRecordsChange:he,selectedBankPFId:r=null,onClearSelectedBankPFId:p,onDeleteBankPF:K}){const[N,W]=x.useState(null),[X,C]=x.useState(!1);x.useEffect(()=>{if(r){const m=j.find(F=>F.id===r);m&&(W(m),C(!1)),p==null||p()}},[r,j,p]);const[Z,ve]=x.useState(!1),[J,Te]=x.useState(""),[ge,E]=x.useState(""),[O,f]=x.useState({firmaUnvan:"",muhasebeKodu:"",bankaOrPF:"Banka",bankaPFAd:"",odemeKurulusuTipi:"",odemeKurulusuAd:"",vergiDairesi:"",vergiNo:"",adres:"",telefon:"",email:""}),l=m=>{var F,Ee;if(X){const pe=[...j,{...m,id:Date.now().toString()}];console.log("ðŸ†• Yeni kayÄ±t ekleniyor:",pe.length,"kayÄ±t"),console.log("ðŸ“‹ TABELA kayÄ±tlarÄ±:",((F=m.tabelaRecords)==null?void 0:F.length)||0),v==null||v(pe),C(!1),W(null)}else{const pe=j.map(We=>We.id===m.id?m:We);console.log("âœï¸ KayÄ±t gÃ¼ncelleniyor:",m.firmaUnvan),console.log("ðŸ“‹ TABELA kayÄ±tlarÄ±:",((Ee=m.tabelaRecords)==null?void 0:Ee.length)||0),v==null||v(pe),W(m)}},d=m=>{const F=j.find(pe=>pe.id===m),Ee=j.filter(pe=>pe.id!==m);v==null||v(Ee),K==null||K(m),W(null),console.log(`ðŸ—‘ï¸ BankPF kaydÄ± silindi: ${(F==null?void 0:F.firmaUnvan)||m}`),P.success(`Banka/PF kaydÄ± silindi: ${(F==null?void 0:F.firmaUnvan)||"KayÄ±t"}
Ä°liÅŸkili mÃ¼ÅŸteri baÄŸlantÄ±larÄ± temizlendi`,{duration:4e3})},z=()=>{Te(""),E(""),f({firmaUnvan:"",muhasebeKodu:"",bankaOrPF:"Banka",bankaPFAd:"",odemeKurulusuTipi:"",odemeKurulusuAd:"",vergiDairesi:"",vergiNo:"",adres:"",telefon:"",email:""}),ve(!0)},u=m=>{if(E(m),J==="Banka"){const F=D.find(Ee=>Ee.id===m);F&&(f({...O,firmaUnvan:F.bankaAdi,muhasebeKodu:F.kod,bankaOrPF:"Banka",bankaPFAd:F.bankaAdi,odemeKurulusuTipi:"",odemeKurulusuAd:""}),F.aciklama&&P.info(`â„¹ï¸ ${F.aciklama}`))}else if(J==="EPK"){const F=A.find(Ee=>Ee.id===m);F&&(f({...O,firmaUnvan:F.kurumAdi,muhasebeKodu:F.kod,bankaOrPF:"PF",bankaPFAd:"",odemeKurulusuTipi:"EPK",odemeKurulusuAd:F.kurumAdi}),F.aciklama&&P.info(`â„¹ï¸ ${F.aciklama}`))}else if(J==="Ã–K"){const F=b.find(Ee=>Ee.id===m);F&&(f({...O,firmaUnvan:F.kurumAdi,muhasebeKodu:F.kod,bankaOrPF:"PF",bankaPFAd:"",odemeKurulusuTipi:"Ã–K",odemeKurulusuAd:F.kurumAdi}),F.aciklama&&P.info(`â„¹ï¸ ${F.aciklama}`))}},xe=()=>{if(!J){P.error("KuruluÅŸ kategorisi seÃ§melisiniz");return}if(!ge){P.error("KuruluÅŸ seÃ§melisiniz");return}if(!O.firmaUnvan.trim()){P.error("Firma Ã¼nvanÄ± zorunludur");return}if(!O.muhasebeKodu.trim()){P.error("Muhasebe kodu zorunludur");return}const m={...O,id:Date.now().toString(),iletisimMatrisi:[],dokumanlar:[],isbirlikleri:[],tabelaRecords:[],agreementBanks:[],tabelaGroups:[],durum:"Aktif"},F=[...j,m];v==null||v(F),ve(!1),P.success(`${O.firmaUnvan} baÅŸarÄ±yla eklendi`)};return N||X?e.jsx(gl,{record:N,onSave:l,onCancel:()=>{W(null),C(!1)},onDelete:d,isCreating:X,gorevListesi:L,gelirModelleri:oe,ekGelirler:Y,hesapKalemleri:M,banks:D,epkList:A,okList:b,kartProgramlar:H}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Banka / PF - Ã–deme KuruluÅŸlarÄ±"}),e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Banka ve Ã¶deme kuruluÅŸu kayÄ±tlarÄ±nÄ± yÃ¶netin"})]}),e.jsxs(y,{onClick:z,className:"flex items-center gap-2 shadow-md hover:shadow-lg transition-shadow",children:[e.jsx(Xa,{size:18}),e.jsx("span",{children:"Yeni KayÄ±t"})]})]}),e.jsx(nl,{records:j,onSelectRecord:W,banks:D,epkList:A,okList:b}),e.jsx(Da,{open:Z,onOpenChange:ve,children:e.jsxs(Oa,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(wa,{children:[e.jsx(Sa,{children:"Yeni Banka / PF KaydÄ±"}),e.jsx(Ca,{children:"Cari bilgilerini girerek yeni kayÄ±t oluÅŸturun"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx(Pa,{label:"KuruluÅŸ Kategorisi",options:[{value:"Banka",label:"Banka"},{value:"EPK",label:"EPK (Elektronik Para KuruluÅŸu)"},{value:"Ã–K",label:"Ã–K (Ã–deme KuruluÅŸu)"}],value:J,onChange:m=>{const F=m;Te(F),E(""),f({firmaUnvan:"",muhasebeKodu:"",bankaOrPF:F==="Banka"?"Banka":"PF",bankaPFAd:"",odemeKurulusuTipi:F==="Banka"?"":F,odemeKurulusuAd:"",vergiDairesi:"",vergiNo:"",adres:"",telefon:"",email:""})},placeholder:"Kategori seÃ§iniz...",required:!0}),J&&e.jsx(Pa,{label:`${J==="Banka"?"Banka":J} AdÄ±`,options:J==="Banka"?D.filter(m=>m.aktif).length===0?[{value:"none",label:"TanÄ±mlar'da aktif banka bulunamadÄ±",disabled:!0}]:D.filter(m=>m.aktif).map(m=>({value:m.id,label:`${m.kod} - ${m.bankaAdi}`})):J==="EPK"?A.filter(m=>m.aktif).length===0?[{value:"none",label:"TanÄ±mlar'da aktif EPK bulunamadÄ±",disabled:!0}]:A.filter(m=>m.aktif).map(m=>({value:m.id,label:`${m.kod} - ${m.kurumAdi}`})):b.filter(m=>m.aktif).length===0?[{value:"none",label:"TanÄ±mlar'da aktif Ã–K bulunamadÄ±",disabled:!0}]:b.filter(m=>m.aktif).map(m=>({value:m.id,label:`${m.kod} - ${m.kurumAdi}`})),value:ge,onChange:u,placeholder:`${J} seÃ§iniz...`,required:!0}),ge&&(()=>{const m=J==="Banka"?D.find(F=>F.id===ge):J==="EPK"?A.find(F=>F.id===ge):b.find(F=>F.id===ge);return m?e.jsxs("div",{className:"bg-blue-50 border border-blue-200 p-4 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm bg-blue-600 text-white px-2 py-1 rounded",children:J}),e.jsx("h4",{className:"text-blue-900",children:"SeÃ§ili KuruluÅŸ Bilgileri"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Kod:"}),e.jsx("span",{className:"ml-2",children:m.kod})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Ad:"}),e.jsx("span",{className:"ml-2",children:J==="Banka"?m.bankaAdi:m.kurumAdi})]})]}),m.aciklama&&e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"AÃ§Ä±klama:"}),e.jsx("p",{className:"mt-1 text-gray-700",children:m.aciklama})]})]}):null})(),ge&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs(U,{children:["Firma ÃœnvanÄ± ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(V,{value:O.firmaUnvan,onChange:m=>f({...O,firmaUnvan:m.target.value}),placeholder:"Ã–rn: ABC Teknoloji A.Åž.",className:"bg-blue-50"}),e.jsx("p",{className:"text-xs text-blue-600",children:"âœ“ Otomatik dolduruldu - gerekirse dÃ¼zenleyebilirsiniz"})]}),ge&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs(U,{children:["Muhasebe Kodu ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(V,{value:O.muhasebeKodu,onChange:m=>f({...O,muhasebeKodu:m.target.value}),placeholder:"Ã–rn: 120.01.001",className:"bg-blue-50"}),e.jsx("p",{className:"text-xs text-blue-600",children:"âœ“ Otomatik dolduruldu - gerekirse dÃ¼zenleyebilirsiniz"})]}),ge&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{children:"Vergi Dairesi"}),e.jsx(V,{value:O.vergiDairesi,onChange:m=>f({...O,vergiDairesi:m.target.value}),placeholder:"Ã–rn: KadÄ±kÃ¶y Vergi Dairesi"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{children:"Vergi NumarasÄ±"}),e.jsx(V,{value:O.vergiNo,onChange:m=>f({...O,vergiNo:m.target.value}),placeholder:"10 haneli vergi numarasÄ±",maxLength:10})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{children:"Adres"}),e.jsx(V,{value:O.adres,onChange:m=>f({...O,adres:m.target.value}),placeholder:"Tam adres"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{children:"Telefon"}),e.jsx(V,{value:O.telefon,onChange:m=>f({...O,telefon:m.target.value}),placeholder:"Ã–rn: +90 212 123 45 67"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{children:"E-posta"}),e.jsx(V,{type:"email",value:O.email,onChange:m=>f({...O,email:m.target.value}),placeholder:"Ã–rn: info@firma.com"})]})]})]}),e.jsxs(Ea,{children:[e.jsx(y,{variant:"outline",onClick:()=>ve(!1),children:"Ä°ptal"}),e.jsx(y,{onClick:xe,disabled:!ge,children:"Kaydet"})]})]})})]})});export{Cl as BankPFModule,pl as bankaPFListesi,yl as epkListesi,wl as gorevListesi,Sl as mockBankPFData,jl as okListesi};
