import{r as z,j as e,C as S,a as T,b as L,T as H,d as $,t as w,l as B,S as Y,B as E,e as O}from"./index-B0KDE8pz.js";import{c as P,m as R,n as u}from"./domainMatching-DnE2bFev.js";import{C}from"./circle-x-CYTj_F-g.js";function I({customers:n,payterProducts:o}){const[d,g]=z.useState("120.01.007"),[s,l]=z.useState(null),t=()=>{var f,D,k;console.log("ğŸ” Arama yapÄ±lÄ±yor:",d),console.log("ğŸ“Š Toplam mÃ¼ÅŸteri sayÄ±sÄ±:",n.length);const i=d.trim();console.log("ğŸ“ Ä°lk 5 mÃ¼ÅŸteri cari kodu:",n.slice(0,5).map(a=>({kod:a.cariKodu,ad:a.cariAdi})));const r=n.find(a=>{var A,M;const c=((A=a.cariKodu)==null?void 0:A.trim())||"",x=((M=a.cariAdi)==null?void 0:M.trim().toLowerCase())||"",h=i.toLowerCase();return(c.includes(i)||x.includes(h))&&console.log("âœ… EÅŸleÅŸme bulundu:",{kod:c,ad:a.cariAdi}),c.includes(i)||x.includes(h)});if(!r){console.log("âŒ HiÃ§bir mÃ¼ÅŸteri bulunamadÄ±!"),console.log("ğŸ’¡ Ä°pucu: Cari kodu tam olarak ÅŸÃ¶yle arayÄ±n:",n.filter(a=>{var c;return(c=a.cariKodu)==null?void 0:c.includes("120.01")}).map(a=>a.cariKodu)),l({error:`${i} MÃ¼ÅŸteri bulunamadÄ±! Toplam ${n.length} mÃ¼ÅŸteri arasÄ±nda arama yapÄ±ldÄ±. Konsola bakÄ±n.`});return}console.log("âœ… MÃ¼ÅŸteri bulundu:",r.cariKodu,"-",r.cariAdi);const m=r.domain||r.guncelMyPayterDomain,j=r.ignoreMainDomain||!1,K=r.ignoreMainDomainNote||"",b=((D=(f=r.serviceFeeSettings)==null?void 0:f.deviceSubscriptions)==null?void 0:D.filter(a=>a.isActive))||[],y=b.map(a=>a.deviceSerialNumber).filter(Boolean),v=P(m,r.domainHierarchy),p=[],N=[];o.forEach(a=>{const c=y.includes(a.serialNumber),x=a.domain&&m?R(a.domain,m,j,r.domainHierarchy):!1;if(c){const h={serialNumber:a.serialNumber,productDomain:a.domain,normalizedProductDomain:u(a.domain),onlineStatus:a.onlineStatus,domainMatch:x,matchReason:F(a.domain,m,j,r.domainHierarchy,v)};x?p.push(h):N.push(h)}}),l({customer:{cariKodu:r.cariKodu,cariAdi:r.cariAdi,domain:m,normalizedDomain:u(m),ignoreMainDomain:j,ignoreMainDomainNote:K},devices:{count:b.length,serials:y},domains:{mainDomain:m,allDomains:v,hierarchyCount:((k=r.domainHierarchy)==null?void 0:k.length)||0},products:{matched:p,unmatched:N,total:p.length+N.length}})};return e.jsxs(S,{className:"w-full",children:[e.jsx(T,{children:e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(H,{className:"text-orange-600",size:20}),"MÃ¼ÅŸteri Domain EÅŸleÅŸtirme Debug"]})}),e.jsx($,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(w,{placeholder:"Cari Kodu veya MÃ¼ÅŸteri AdÄ± (Ã¶rn: 120.01.007)",value:d,onChange:i=>g(i.target.value),onKeyDown:i=>i.key==="Enter"&&t()}),e.jsxs(B,{onClick:t,children:[e.jsx(Y,{size:16,className:"mr-2"}),"Analiz Et"]})]}),s&&e.jsx("div",{className:"space-y-4",children:s.error?e.jsxs("div",{className:"p-4 bg-red-50 text-red-700 rounded-lg space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{size:20}),e.jsx("strong",{children:"Hata:"})]}),e.jsx("p",{children:s.error}),e.jsxs("p",{className:"text-sm mt-2",children:["ğŸ’¡ ",e.jsx("strong",{children:"Ä°pucu:"})," Tam cari kodu veya mÃ¼ÅŸteri adÄ±nÄ±n bir kÄ±smÄ±nÄ± yazÄ±n. Konsol'u (F12) aÃ§arak arama detaylarÄ±nÄ± gÃ¶rebilirsiniz."]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg space-y-2",children:[e.jsx("h4",{className:"font-semibold text-blue-900",children:"MÃ¼ÅŸteri Bilgileri"}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Cari Kodu:"})," ",s.customer.cariKodu]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Cari AdÄ±:"})," ",s.customer.cariAdi]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Domain:"})," ",s.customer.domain||"YOK"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Normalized Domain:"})," ",s.customer.normalizedDomain||"YOK"]}),e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx("strong",{children:"Ana Domain GÃ¶rmezden Gel:"}),s.customer.ignoreMainDomain?e.jsx(E,{className:"bg-orange-600",children:"AÃ‡IK"}):e.jsx(E,{variant:"secondary",children:"KAPALI"})]}),s.customer.ignoreMainDomainNote&&e.jsxs("p",{className:"text-xs italic text-gray-600",children:["Not: ",s.customer.ignoreMainDomainNote]})]})]}),e.jsxs("div",{className:"p-4 bg-purple-50 rounded-lg space-y-2",children:[e.jsx("h4",{className:"font-semibold text-purple-900",children:"Domain YapÄ±sÄ±"}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Ana Domain:"})," ",s.domains.mainDomain||"YOK"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"HiyerarÅŸideki Domain SayÄ±sÄ±:"})," ",s.domains.hierarchyCount]}),e.jsx("p",{children:e.jsx("strong",{children:"Toplam Domain Listesi:"})}),e.jsx("ul",{className:"list-disc list-inside pl-4",children:s.domains.allDomains.map((i,r)=>e.jsx("li",{className:"text-xs",children:i},r))})]})]}),e.jsxs("div",{className:"p-4 bg-indigo-50 rounded-lg space-y-2",children:[e.jsx("h4",{className:"font-semibold text-indigo-900",children:"Cihaz Bilgileri"}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Aktif Cihaz SayÄ±sÄ±:"})," ",s.devices.count]}),e.jsx("p",{children:e.jsx("strong",{children:"Serial Number Listesi:"})}),e.jsx("ul",{className:"list-disc list-inside pl-4",children:s.devices.serials.map((i,r)=>e.jsx("li",{className:"text-xs",children:i},r))})]})]}),s.products.matched.length>0&&e.jsxs("div",{className:"p-4 bg-green-50 rounded-lg space-y-2",children:[e.jsxs("h4",{className:"font-semibold text-green-900 flex items-center gap-2",children:[e.jsx(O,{size:16}),"EÅŸleÅŸen ÃœrÃ¼nler (",s.products.matched.length,")"]}),e.jsx("div",{className:"space-y-2",children:s.products.matched.map((i,r)=>e.jsxs("div",{className:"p-3 bg-white rounded border border-green-200 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Serial:"})," ",i.serialNumber]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Domain:"})," ",i.productDomain]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Normalized:"})," ",i.normalizedProductDomain]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Online Status:"})," ",i.onlineStatus]}),e.jsxs("p",{className:"text-xs text-green-700 mt-1",children:["âœ… ",i.matchReason]})]},r))})]}),s.products.unmatched.length>0&&e.jsxs("div",{className:"p-4 bg-red-50 rounded-lg space-y-2",children:[e.jsxs("h4",{className:"font-semibold text-red-900 flex items-center gap-2",children:[e.jsx(C,{size:16}),"EÅŸleÅŸmeyen ÃœrÃ¼nler (",s.products.unmatched.length,")"]}),e.jsx("div",{className:"space-y-2",children:s.products.unmatched.map((i,r)=>e.jsxs("div",{className:"p-3 bg-white rounded border border-red-200 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Serial:"})," ",i.serialNumber]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Domain:"})," ",i.productDomain||"YOK"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Normalized:"})," ",i.normalizedProductDomain||"YOK"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Online Status:"})," ",i.onlineStatus]}),e.jsxs("p",{className:"text-xs text-red-700 mt-1",children:["âŒ ",i.matchReason]})]},r))})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Ã–zet"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:s.products.total}),e.jsx("div",{className:"text-xs text-gray-600",children:"Toplam ÃœrÃ¼n"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:s.products.matched.length}),e.jsx("div",{className:"text-xs text-gray-600",children:"EÅŸleÅŸen"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:s.products.unmatched.length}),e.jsx("div",{className:"text-xs text-gray-600",children:"EÅŸleÅŸmeyen"})]})]})]})]})})]})})]})}function F(n,o,d,g,s){const l=u(n),t=u(o);return l?t?d?l===t?`Ana domain gÃ¶rmezden gelme AÃ‡IK, ama Ã¼rÃ¼n domain'i (${l}) ana domain ile TAM eÅŸleÅŸiyor - EÅLEÅMEDÄ°`:l.endsWith("."+t)?`Alt domain formatÄ± tespit edildi (${l}) - EÅLEÅTÄ°`:s.includes(l)?`Domain hiyerarÅŸisinde tanÄ±mlÄ± (${l}) - EÅLEÅTÄ°`:`Ana domain gÃ¶rmezden gelme AÃ‡IK, ancak Ã¼rÃ¼n domain'i (${l}) ne alt domain formatÄ±nda ne de hiyerarÅŸide yok - EÅLEÅMEDÄ°`:l===t?`Tam domain eÅŸleÅŸmesi (${l} = ${t}) - EÅLEÅTÄ°`:`Tam eÅŸleÅŸme yok (${l} â‰  ${t}) - EÅLEÅMEDÄ°`:"MÃ¼ÅŸteri domain bilgisi yok":"ÃœrÃ¼n domain bilgisi yok"}function q({customers:n,payterProducts:o}){return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"border-b pb-4",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Debug & Diagnostic Tools"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"MÃ¼ÅŸteri-Ã¼rÃ¼n eÅŸleÅŸtirme sorunlarÄ±nÄ± analiz etmek iÃ§in araÃ§lar"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-900",children:n.length}),e.jsx("div",{className:"text-sm text-blue-700 mt-1",children:"MÃ¼ÅŸteri YÃ¼klendi"}),n.length===0&&e.jsx("div",{className:"text-xs text-red-600 mt-2",children:"âš ï¸ MÃ¼ÅŸteri verisi yok! Ã–nce MÃ¼ÅŸteriler modÃ¼lÃ¼nden veri import edin."})]}),e.jsxs("div",{className:"p-4 bg-green-50 rounded-lg border border-green-200",children:[e.jsx("div",{className:"text-2xl font-bold text-green-900",children:o.length}),e.jsx("div",{className:"text-sm text-green-700 mt-1",children:"ÃœrÃ¼n YÃ¼klendi"}),o.length===0&&e.jsx("div",{className:"text-xs text-red-600 mt-2",children:"âš ï¸ ÃœrÃ¼n verisi yok! Ã–nce ÃœrÃ¼n modÃ¼lÃ¼nden veri import edin."})]}),e.jsxs("div",{className:"p-4 bg-purple-50 rounded-lg border border-purple-200",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-900",children:n.filter(d=>d.domain||d.guncelMyPayterDomain).length}),e.jsx("div",{className:"text-sm text-purple-700 mt-1",children:"Domain'li MÃ¼ÅŸteri"})]})]}),n.length>0&&e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg border border-gray-200",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"ğŸ’¡ Ã–rnek MÃ¼ÅŸteri KodlarÄ± (Ä°lk 10)"}),e.jsx("div",{className:"grid grid-cols-2 gap-2 text-sm",children:n.slice(0,10).map((d,g)=>{var s;return e.jsxs("div",{className:"p-2 bg-white rounded border border-gray-100",children:[e.jsx("span",{className:"font-mono text-blue-600",children:d.cariKodu})," - ",e.jsx("span",{className:"text-gray-600",children:(s=d.cariAdi)==null?void 0:s.substring(0,30)})]},g)})}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Bu kodlardan birini kopyalayÄ±p aÅŸaÄŸÄ±daki arama kutusuna yapÄ±ÅŸtÄ±rÄ±n."})]}),e.jsx(I,{customers:n,payterProducts:o})]})}export{q as DebugModule};
